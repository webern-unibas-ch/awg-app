import{a as U,b as dt}from"./chunk-MSTPLEVO.js";import{a as cr,b as hr,c as fr,d as pr,e as dr}from"./chunk-ERS22L6F.js";import{f as Ge,s as ir}from"./chunk-73C3IKXQ.js";import{a as or,i as ar,k as ur,m as lr}from"./chunk-SKCALY4A.js";import{c as nr,x as sr}from"./chunk-5HE26ZDB.js";import"./chunk-2WSCCWUB.js";import{A as Ht,D as Vt,G as T,J as Wt,L as F,Oa as ht,Q as ee,R as S,S as Zt,T as v,Ta as ft,U as N,Ua as Jt,V as Xt,Va as Yt,W as Me,X as me,a as jt,d as je,e as Ut,eb as pt,f as Mt,h as ct,hb as er,k as Ue,ka as Kt,l as E,lb as ae,m as zt,mb as tr,nb as rr,ob as ze,t as Gt,u as $t,z as Qt}from"./chunk-TSRZPXKZ.js";var xr=je($e=>{"use strict";$e.byteLength=Zi;$e.toByteArray=Ki;$e.fromByteArray=en;var $=[],M=[],Wi=typeof Uint8Array<"u"?Uint8Array:Array,gt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(ue=0,mr=gt.length;ue<mr;++ue)$[ue]=gt[ue],M[gt.charCodeAt(ue)]=ue;var ue,mr;M[45]=62;M[95]=63;function yr(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function Zi(r){var e=yr(r),t=e[0],i=e[1];return(t+i)*3/4-i}function Xi(r,e,t){return(e+t)*3/4-t}function Ki(r){var e,t=yr(r),i=t[0],n=t[1],s=new Wi(Xi(r,i,n)),o=0,a=n>0?i-4:i,l;for(l=0;l<a;l+=4)e=M[r.charCodeAt(l)]<<18|M[r.charCodeAt(l+1)]<<12|M[r.charCodeAt(l+2)]<<6|M[r.charCodeAt(l+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=M[r.charCodeAt(l)]<<2|M[r.charCodeAt(l+1)]>>4,s[o++]=e&255),n===1&&(e=M[r.charCodeAt(l)]<<10|M[r.charCodeAt(l+1)]<<4|M[r.charCodeAt(l+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function Ji(r){return $[r>>18&63]+$[r>>12&63]+$[r>>6&63]+$[r&63]}function Yi(r,e,t){for(var i,n=[],s=e;s<t;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(Ji(i));return n.join("")}function en(r){for(var e,t=r.length,i=t%3,n=[],s=16383,o=0,a=t-i;o<a;o+=s)n.push(Yi(r,o,o+s>a?a:o+s));return i===1?(e=r[t-1],n.push($[e>>2]+$[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push($[e>>10]+$[e>>4&63]+$[e<<2&63]+"=")),n.join("")}});var br=je(_t=>{_t.read=function(r,e,t,i,n){var s,o,a=n*8-i-1,l=(1<<a)-1,u=l>>1,f=-7,h=t?n-1:0,m=t?-1:1,g=r[e+h];for(h+=m,s=g&(1<<-f)-1,g>>=-f,f+=a;f>0;s=s*256+r[e+h],h+=m,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=i;f>0;o=o*256+r[e+h],h+=m,f-=8);if(s===0)s=1-u;else{if(s===l)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(g?-1:1)*o*Math.pow(2,s-i)};_t.write=function(r,e,t,i,n,s){var o,a,l,u=s*8-n-1,f=(1<<u)-1,h=f>>1,m=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:s-1,_=i?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?e+=m/l:e+=m*Math.pow(2,1-h),e*l>=2&&(o++,l/=2),o+h>=f?(a=0,o=f):o+h>=1?(a=(e*l-1)*Math.pow(2,n),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;r[t+g]=a&255,g+=_,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;r[t+g]=o&255,g+=_,o/=256,u-=8);r[t+g-_]|=p*128}});var Lr=je(we=>{"use strict";var mt=xr(),xe=br(),wr=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;we.Buffer=c;we.SlowBuffer=an;we.INSPECT_MAX_BYTES=50;var Qe=2147483647;we.kMaxLength=Qe;c.TYPED_ARRAY_SUPPORT=tn();!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function tn(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}});Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function W(r){if(r>Qe)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,c.prototype),e}function c(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return wt(r)}return Sr(r,e,t)}c.poolSize=8192;function Sr(r,e,t){if(typeof r=="string")return nn(r,e);if(ArrayBuffer.isView(r))return sn(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(Q(r,ArrayBuffer)||r&&Q(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Q(r,SharedArrayBuffer)||r&&Q(r.buffer,SharedArrayBuffer)))return xt(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return c.from(i,e,t);let n=on(r);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return c.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}c.from=function(r,e,t){return Sr(r,e,t)};Object.setPrototypeOf(c.prototype,Uint8Array.prototype);Object.setPrototypeOf(c,Uint8Array);function Cr(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function rn(r,e,t){return Cr(r),r<=0?W(r):e!==void 0?typeof t=="string"?W(r).fill(e,t):W(r).fill(e):W(r)}c.alloc=function(r,e,t){return rn(r,e,t)};function wt(r){return Cr(r),W(r<0?0:Et(r)|0)}c.allocUnsafe=function(r){return wt(r)};c.allocUnsafeSlow=function(r){return wt(r)};function nn(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=Ir(r,e)|0,i=W(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function yt(r){let e=r.length<0?0:Et(r.length)|0,t=W(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function sn(r){if(Q(r,Uint8Array)){let e=new Uint8Array(r);return xt(e.buffer,e.byteOffset,e.byteLength)}return yt(r)}function xt(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,c.prototype),i}function on(r){if(c.isBuffer(r)){let e=Et(r.length)|0,t=W(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Rt(r.length)?W(0):yt(r);if(r.type==="Buffer"&&Array.isArray(r.data))return yt(r.data)}function Et(r){if(r>=Qe)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Qe.toString(16)+" bytes");return r|0}function an(r){return+r!=r&&(r=0),c.alloc(+r)}c.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==c.prototype};c.compare=function(e,t){if(Q(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),Q(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return c.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=c.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){let o=e[i];if(Q(o,Uint8Array))s+o.length>n.length?(c.isBuffer(o)||(o=c.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(c.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function Ir(r,e){if(c.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||Q(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return bt(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Pr(r).length;default:if(n)return i?-1:bt(r).length;e=(""+e).toLowerCase(),n=!0}}c.byteLength=Ir;function un(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return yn(this,e,t);case"utf8":case"utf-8":return Fr(this,e,t);case"ascii":return _n(this,e,t);case"latin1":case"binary":return mn(this,e,t);case"base64":return dn(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xn(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}c.prototype._isBuffer=!0;function le(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}c.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)le(this,t,t+1);return this};c.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)le(this,t,t+3),le(this,t+1,t+2);return this};c.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)le(this,t,t+7),le(this,t+1,t+6),le(this,t+2,t+5),le(this,t+3,t+4);return this};c.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Fr(this,0,e):un.apply(this,arguments)};c.prototype.toLocaleString=c.prototype.toString;c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:c.compare(this,e)===0};c.prototype.inspect=function(){let e="",t=we.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};wr&&(c.prototype[wr]=c.prototype.inspect);c.prototype.compare=function(e,t,i,n,s){if(Q(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-t,l=Math.min(o,a),u=this.slice(n,s),f=e.slice(t,i);for(let h=0;h<l;++h)if(u[h]!==f[h]){o=u[h],a=f[h];break}return o<a?-1:a<o?1:0};function Tr(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Rt(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=c.from(e,i)),c.isBuffer(e))return e.length===0?-1:Er(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Er(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function Er(r,e,t,i,n){let s=1,o=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function l(f,h){return s===1?f[h]:f.readUInt16BE(h*s)}let u;if(n){let f=-1;for(u=t;u<o;u++)if(l(r,u)===l(e,f===-1?0:u-f)){if(f===-1&&(f=u),u-f+1===a)return f*s}else f!==-1&&(u-=u-f),f=-1}else for(t+a>o&&(t=o-a),u=t;u>=0;u--){let f=!0;for(let h=0;h<a;h++)if(l(r,u+h)!==l(e,h)){f=!1;break}if(f)return u}return-1}c.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};c.prototype.indexOf=function(e,t,i){return Tr(this,e,t,i,!0)};c.prototype.lastIndexOf=function(e,t,i){return Tr(this,e,t,i,!1)};function ln(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(Rt(a))return o;r[t+o]=a}return o}function cn(r,e,t,i){return He(bt(e,r.length-t),r,t,i)}function hn(r,e,t,i){return He(vn(e),r,t,i)}function fn(r,e,t,i){return He(Pr(e),r,t,i)}function pn(r,e,t,i){return He(Rn(e,r.length-t),r,t,i)}c.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return ln(this,e,t,i);case"utf8":case"utf-8":return cn(this,e,t,i);case"ascii":case"latin1":case"binary":return hn(this,e,t,i);case"base64":return fn(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pn(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function dn(r,e,t){return e===0&&t===r.length?mt.fromByteArray(r):mt.fromByteArray(r.slice(e,t))}function Fr(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let s=r[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){let l,u,f,h;switch(a){case 1:s<128&&(o=s);break;case 2:l=r[n+1],(l&192)===128&&(h=(s&31)<<6|l&63,h>127&&(o=h));break;case 3:l=r[n+1],u=r[n+2],(l&192)===128&&(u&192)===128&&(h=(s&15)<<12|(l&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:l=r[n+1],u=r[n+2],f=r[n+3],(l&192)===128&&(u&192)===128&&(f&192)===128&&(h=(s&15)<<18|(l&63)<<12|(u&63)<<6|f&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return gn(i)}var vr=4096;function gn(r){let e=r.length;if(e<=vr)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=vr));return t}function _n(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function mn(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function yn(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let s=e;s<t;++s)n+=Sn[r[s]];return n}function xn(r,e,t){let i=r.slice(e,t),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}c.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n};function A(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||A(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return n};c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||A(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n};c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e=e>>>0,t||A(e,1,this.length),this[e]};c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||A(e,2,this.length),this[e]|this[e+1]<<8};c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||A(e,2,this.length),this[e]<<8|this[e+1]};c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||A(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};c.prototype.readBigUInt64LE=te(function(e){e=e>>>0,be(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Ae(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});c.prototype.readBigUInt64BE=te(function(e){e=e>>>0,be(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Ae(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});c.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||A(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};c.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||A(e,t,this.length);let n=t,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};c.prototype.readInt8=function(e,t){return e=e>>>0,t||A(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};c.prototype.readInt16LE=function(e,t){e=e>>>0,t||A(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};c.prototype.readInt16BE=function(e,t){e=e>>>0,t||A(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};c.prototype.readInt32LE=function(e,t){return e=e>>>0,t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};c.prototype.readInt32BE=function(e,t){return e=e>>>0,t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};c.prototype.readBigInt64LE=te(function(e){e=e>>>0,be(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Ae(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});c.prototype.readBigInt64BE=te(function(e){e=e>>>0,be(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Ae(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});c.prototype.readFloatLE=function(e,t){return e=e>>>0,t||A(e,4,this.length),xe.read(this,e,!0,23,4)};c.prototype.readFloatBE=function(e,t){return e=e>>>0,t||A(e,4,this.length),xe.read(this,e,!1,23,4)};c.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||A(e,8,this.length),xe.read(this,e,!0,52,8)};c.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||A(e,8,this.length),xe.read(this,e,!1,52,8)};function L(r,e,t,i,n,s){if(!c.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;L(this,e,t,i,a,0)}let s=1,o=0;for(this[t]=e&255;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i};c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;L(this,e,t,i,a,0)}let s=i-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i};c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,1,255,0),this[t]=e&255,t+1};c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function Nr(r,e,t,i,n){Br(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,t}function Ar(r,e,t,i,n){Br(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=o,o=o>>8,r[t+2]=o,o=o>>8,r[t+1]=o,o=o>>8,r[t]=o,t+8}c.prototype.writeBigUInt64LE=te(function(e,t=0){return Nr(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});c.prototype.writeBigUInt64BE=te(function(e,t=0){return Ar(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});c.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let l=Math.pow(2,8*i-1);L(this,e,t,i,l-1,-l)}let s=0,o=1,a=0;for(this[t]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[t+s-1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};c.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let l=Math.pow(2,8*i-1);L(this,e,t,i,l-1,-l)}let s=i-1,o=1,a=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[t+s+1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};c.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};c.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};c.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};c.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};c.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};c.prototype.writeBigInt64LE=te(function(e,t=0){return Nr(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});c.prototype.writeBigInt64BE=te(function(e,t=0){return Ar(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function kr(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function qr(r,e,t,i,n){return e=+e,t=t>>>0,n||kr(r,e,t,4,34028234663852886e22,-34028234663852886e22),xe.write(r,e,t,i,23,4),t+4}c.prototype.writeFloatLE=function(e,t,i){return qr(this,e,t,!0,i)};c.prototype.writeFloatBE=function(e,t,i){return qr(this,e,t,!1,i)};function Dr(r,e,t,i,n){return e=+e,t=t>>>0,n||kr(r,e,t,8,17976931348623157e292,-17976931348623157e292),xe.write(r,e,t,i,52,8),t+8}c.prototype.writeDoubleLE=function(e,t,i){return Dr(this,e,t,!0,i)};c.prototype.writeDoubleBE=function(e,t,i){return Dr(this,e,t,!1,i)};c.prototype.copy=function(e,t,i,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};c.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{let o=c.isBuffer(e)?e:c.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var ye={};function vt(r,e,t){ye[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}vt("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);vt("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);vt("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=Rr(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=Rr(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function Rr(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function bn(r,e,t){be(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&Ae(e,r.length-(t+1))}function Br(r,e,t,i,n,s){if(r>t||r<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${t}${o}`,new ye.ERR_OUT_OF_RANGE("value",a,r)}bn(i,n,s)}function be(r,e){if(typeof r!="number")throw new ye.ERR_INVALID_ARG_TYPE(e,"number",r)}function Ae(r,e,t){throw Math.floor(r)!==r?(be(r,t),new ye.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new ye.ERR_BUFFER_OUT_OF_BOUNDS:new ye.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var wn=/[^+/0-9A-Za-z-_]/g;function En(r){if(r=r.split("=")[0],r=r.trim().replace(wn,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function bt(r,e){e=e||1/0;let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function vn(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Rn(r,e){let t,i,n,s=[];for(let o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function Pr(r){return mt.toByteArray(En(r))}function He(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function Q(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function Rt(r){return r!==r}var Sn=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function te(r){return typeof BigInt>"u"?Cn:r}function Cn(){throw new Error("BigInt not supported")}});var Ur=je((Ss,jr)=>{var Or;jr.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:global):r=>(Or||(Or=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var gr=`<!-- Data: Triples, SPARQL query, result -->
@if (graphRDFInputData) {
    <div #fs class="row awg-graph-visualizer" [class.is-fullscreen]="isFullscreen">
        <div [ngClass]="isFullscreen ? 'col-4 col-lg-3 px-0 awg-fullscreen' : 'col-12'">
            <div [ngClass]="{ row: !isFullscreen }">
                <div [ngClass]="{ 'col-12 col-lg-6 py-0 pe-lg-0': !isFullscreen }">
                    <!-- awg-graph-triples-editor -->
                    <awg-triples-editor
                        [triples]="triples"
                        [isFullscreen]="isFullscreen"
                        (errorMessageRequest)="showErrorMessage($event)"
                        (performQueryRequest)="performQuery()"
                        (resetTriplesRequest)="resetTriples()"
                        (updateTriplesRequest)="triples = $event"></awg-triples-editor>
                </div>
                <div [ngClass]="{ 'col-12 col-lg-6 py-0 ps-lg-0': !isFullscreen }">
                    <!-- awg-graph-sparql-editor -->
                    <awg-sparql-editor
                        [queryList]="queryList"
                        [query]="query"
                        [isFullscreen]="isFullscreen"
                        (errorMessageRequest)="showErrorMessage($event)"
                        (performQueryRequest)="performQuery()"
                        (resetQueryRequest)="resetQuery($event)"
                        (updateQueryStringRequest)="query.queryString = $event"></awg-sparql-editor>
                </div>
            </div>
        </div>
        <!-- Results -->
        <div [ngClass]="isFullscreen ? 'col-8 col-lg-9 px-0 awg-fullscreen' : 'col-12'">
            <!-- CONSTRUCT -->
            <!-- awg-graph-construct-result -->
            @if (query.queryType === 'construct') {
                <awg-construct-results
                    #queryConstructResultAcc
                    [queryResult$]="queryResult$"
                    [defaultForceGraphHeight]="isFullscreen ? 1000 : defaultForceGraphHeight"
                    [isFullscreen]="isFullscreen"
                    (clickedNodeRequest)="onGraphNodeClick($event)"></awg-construct-results>
            } @else {
                @if (query.queryType === 'select') {
                    <awg-select-results
                        [queryResult$]="queryResult$"
                        [queryTime]="queryTime"
                        [isFullscreen]="isFullscreen"
                        (clickedTableRequest)="onTableNodeClick($event)"></awg-select-results>
                } @else {
                    <awg-unsupported-type-results
                        [queryType]="query.queryType"
                        [isFullscreen]="isFullscreen"></awg-unsupported-type-results>
                }
            }
            <!-- SELECT -->
            <!-- awg-graph-select-result -->
            <!-- OTHERS -->
            <!-- awg-graph-unsupported-query-type-result -->
        </div>
    </div>
}

<awg-toast aria-live="polite" aria-atomic="true"></awg-toast>
`;var _r=`:host::ng-deep .awg-fullscreen .collapse.show{height:100vh}:host::ng-deep .awg-fullscreen #awg-graph-visualizer-triples.collapse.show{height:45vh}:host::ng-deep .awg-fullscreen #awg-graph-visualizer-query.collapse.show{height:50vh}
`;var zr=Ut(Lr()),Gr=Ut(Ur());var ke="http://www.w3.org/1999/02/22-rdf-syntax-ns#",qe="http://www.w3.org/2001/XMLSchema#",St="http://www.w3.org/2000/10/swap/",j={xsd:{decimal:`${qe}decimal`,boolean:`${qe}boolean`,double:`${qe}double`,integer:`${qe}integer`,string:`${qe}string`},rdf:{type:`${ke}type`,nil:`${ke}nil`,first:`${ke}first`,rest:`${ke}rest`,langString:`${ke}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${St}reify#forSome`,forAll:`${St}reify#forAll`},log:{implies:`${St}log#implies`}};var{xsd:Ve}=j,In=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,Mr={"\\":"\\","'":"'",'"':'"',n:`
`,r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},Tn=/[\x00-\x20<>\\"\{\}\|\^\`]/,Fn={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},Nn=/$0^/,De=class{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(let t in this)!(t in Fn)&&this[t]instanceof RegExp&&(this[t]=Nn)}else this._n3Mode=e.n3!==!1;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let i=this._input,n=i.length;for(;;){let a,l;for(;a=this._newline.exec(i);)this._comments&&(l=this._comment.exec(a[0]))&&s("comment",l[1],"",this._line,a[0].length),i=i.substr(a[0].length,i.length),n=i.length,this._line++;if(!a&&(a=this._whitespace.exec(i))&&(i=i.substr(a[0].length,i.length)),this._endOfFile.test(i))return t&&(this._comments&&(l=this._comment.exec(i))&&s("comment",l[1],"",this._line,i.length),i=null,s("eof","","",this._line,0)),this._input=i;let u=this._line,f=i[0],h="",m="",g="",_=null,p=0,d=!1;switch(f){case"^":if(i.length<3)break;if(i[1]==="^"){if(this._previousMarker="^^",i=i.substr(2),i[0]!=="<"){d=!0;break}}else{this._n3Mode&&(p=1,h="^");break}case"<":if(_=this._unescapedIri.exec(i))h="IRI",m=_[1];else if(_=this._iri.exec(i)){if(m=this._unescape(_[1]),m===null||Tn.test(m))return o(this);h="IRI"}else i.length>1&&i[1]==="<"?(h="<<",p=2):this._n3Mode&&i.length>1&&i[1]==="="&&(h="inverse",p=2,m=">");break;case">":i.length>1&&i[1]===">"&&(h=">>",p=2);break;case"_":((_=this._blank.exec(i))||t&&(_=this._blank.exec(`${i} `)))&&(h="blank",g="_",m=_[1]);break;case'"':if(_=this._simpleQuotedString.exec(i))m=_[1];else if({value:m,matchLength:p}=this._parseLiteral(i),m===null)return o(this);(_!==null||p!==0)&&(h="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(_=this._simpleApostropheString.exec(i))m=_[1];else if({value:m,matchLength:p}=this._parseLiteral(i),m===null)return o(this);(_!==null||p!==0)&&(h="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(_=this._variable.exec(i))&&(h="var",m=_[0]);break;case"@":this._previousMarker==="literal"&&(_=this._langcode.exec(i))?(h="langcode",m=_[1]):(_=this._keyword.exec(i))&&(h=_[0]);break;case".":if(i.length===1?t:i[1]<"0"||i[1]>"9"){h=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(_=this._number.exec(i)||t&&(_=this._number.exec(`${i} `)))&&(h="literal",m=_[0],g=typeof _[1]=="string"?Ve.double:typeof _[2]=="string"?Ve.decimal:Ve.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(_=this._sparqlKeyword.exec(i))?h=_[0].toUpperCase():d=!0;break;case"f":case"t":(_=this._boolean.exec(i))?(h="literal",m=_[0],g=Ve.boolean):d=!0;break;case"a":(_=this._shortPredicates.exec(i))?(h="abbreviation",m="a"):d=!0;break;case"=":this._n3Mode&&i.length>1&&(h="abbreviation",i[1]!==">"?(p=1,m="="):(p=2,m=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(p=1,h=f);break;case"{":!this._lineMode&&i.length>=2&&(i[1]==="|"?(h="{|",p=2):(h=f,p=1));break;case"|":i.length>=2&&i[1]==="}"&&(h="|}",p=2);break;default:d=!0}if(d&&((this._previousMarker==="@prefix"||this._previousMarker==="PREFIX")&&(_=this._prefix.exec(i))?(h="prefix",m=_[1]||""):((_=this._prefixed.exec(i))||t&&(_=this._prefixed.exec(`${i} `)))&&(h="prefixed",g=_[1]||"",m=this._unescape(_[2]))),this._previousMarker==="^^")switch(h){case"prefixed":h="type";break;case"IRI":h="typeIRI";break;default:h=""}if(!h)return t||!/^'''|^"""/.test(i)&&/\n|\r/.test(i)?o(this):this._input=i;let y=p||_[0].length,x=s(h,m,g,u,y);this.previousToken=x,this._previousMarker=h,i=i.substr(y,i.length)}function s(a,l,u,f,h){let m=i?n-i.length:n,g=m+h,_={type:a,value:l,prefix:u,line:f,start:m,end:g};return e(null,_),_}function o(a){e(a._syntaxError(/^\S*/.exec(i)[0]))}}_unescape(e){let t=!1,i=e.replace(In,(n,s,o,a)=>{if(typeof s=="string")return String.fromCharCode(Number.parseInt(s,16));if(typeof o=="string"){let l=Number.parseInt(o,16);return l<=65535?String.fromCharCode(Number.parseInt(o,16)):String.fromCharCode(55296+((l-=65536)>>10),56320+(l&1023))}return a in Mr?Mr[a]:(t=!0,"")});return t?null:i}_parseLiteral(e){if(e.length>=3){let t=e.match(/^(?:"""|"|'''|'|)/)[0],i=t.length,n=Math.max(this._literalClosingPos,i);for(;(n=e.indexOf(t,n))>0;){let s=0;for(;e[n-s-1]==="\\";)s++;if(s%2===0){let o=e.substring(i,n),a=o.split(/\r\n|\r|\n/).length-1,l=n+i;if(i===1&&a!==0||i===3&&this._lineMode)break;return this._line+=a,{value:this._unescape(o),matchLength:l}}n++}this._literalClosingPos=e.length-i+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;let t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\uFEFF")?e.substr(1):e}tokenize(e,t){if(this._line=1,typeof e=="string")if(this._input=this._readStartingBom(e),typeof t=="function")(0,Gr.default)(()=>this._tokenizeToEnd(t,!0));else{let i=[],n;if(this._tokenizeToEnd((s,o)=>s?n=s:i.push(o),!0),n)throw n;return i}else this._pendingBuffer=null,typeof e.setEncoding=="function"&&e.setEncoding("utf8"),e.on("data",i=>{this._input!==null&&i.length!==0&&(this._pendingBuffer&&(i=zr.Buffer.concat([this._pendingBuffer,i]),this._pendingBuffer=null),i[i.length-1]&128?this._pendingBuffer=i:(typeof this._input>"u"?this._input=this._readStartingBom(typeof i=="string"?i:i.toString()):this._input+=i,this._tokenizeToEnd(t,!1)))}),e.on("end",()=>{typeof this._input=="string"&&this._tokenizeToEnd(t,!0)}),e.on("error",t)}};var{rdf:An,xsd:Ee}=j,Ze,kn=0;var qn={namedNode:Dn,blankNode:Bn,variable:Ln,literal:Pn,defaultGraph:On,quad:$r,triple:$r},Qr=qn,re=class r{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof r?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}},We=class extends re{get termType(){return"NamedNode"}},Be=class r extends re{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){let e=this.id,t=e.lastIndexOf('"')+1;return t<e.length&&e[t++]==="@"?e.substr(t).toLowerCase():""}get datatype(){return new We(this.datatypeString)}get datatypeString(){let e=this.id,t=e.lastIndexOf('"')+1,i=t<e.length?e[t]:"";return i==="^"?e.substr(t+2):i!=="@"?Ee.string:An.langString}equals(e){return e instanceof r?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}},Ct=class extends re{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}},It=class extends re{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}},Tt=class extends re{constructor(){return super(""),Ze||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}};Ze=new Tt;var Ft=class extends re{constructor(e,t,i,n){super(""),this._subject=e,this._predicate=t,this._object=i,this._graph=n||Ze}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}};function Dn(r){return new We(r)}function Bn(r){return new Ct(r||`n3-${kn++}`)}function Pn(r,e){if(typeof e=="string")return new Be(`"${r}"@${e.toLowerCase()}`);let t=e?e.value:"";return t===""&&(typeof r=="boolean"?t=Ee.boolean:typeof r=="number"&&(Number.isFinite(r)?t=Number.isInteger(r)?Ee.integer:Ee.double:(t=Ee.double,Number.isNaN(r)||(r=r>0?"INF":"-INF")))),t===""||t===Ee.string?new Be(`"${r}"`):new Be(`"${r}"^^${t}`)}function Ln(r){return new It(r)}function On(){return Ze}function $r(r,e,t,i){return new Ft(r,e,t,i)}var Hr=0,ie=class{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&Vr(this,e.factory);let t=typeof e.format=="string"?e.format.match(/\w*$/)[0].toLowerCase():"",i=/turtle/.test(t),n=/trig/.test(t),s=/triple/.test(t),o=/quad/.test(t),a=this._n3Mode=/n3/.test(t),l=s||o;(this._supportsNamedGraphs=!(i||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(i||n||s||a),this._supportsRDFStar=t===""||/star|\*$/.test(t),l&&(this._resolveRelativeIRI=u=>null),this._blankNodePrefix=typeof e.blankNodePrefix!="string"?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new De({lineMode:l,n3:a}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){Hr=0}_setBase(e){if(!e)this._base="",this._basePath="";else{let t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}}_saveContext(e,t,i,n,s){let o=this._n3Mode;this._contextStack.push({type:e,subject:i,predicate:n,object:s,graph:t,inverse:o?this._inversePredicate:!1,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){let i=this._contextStack.pop();if(!i||i.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=i.subject,this._predicate=i.predicate,this._object=i.object,this._graph=i.graph,this._n3Mode&&(this._inversePredicate=i.inverse,this._prefixes._=i.blankPrefix,this._quantified=i.quantified)}_readInTopContext(e){switch(e.type){case"eof":return this._graph!==null?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let i;switch(e.type){case"IRI":case"typeIRI":let n=this._resolveIRI(e.value);if(n===null)return this._error("Invalid IRI",e);i=this._namedNode(n);break;case"type":case"prefixed":let s=this._prefixes[e.prefix];if(s===void 0)return this._error(`Undefined prefix "${e.prefix}:"`,e);i=this._namedNode(s+e.value);break;case"blank":i=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":i=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&i.id in this._quantified&&(i=this._quantified[i.id]),i}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(e.prefix.length===0)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if((this._subject=this._readEntity(e))===void 0)return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){let t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return this._predicate===null?this._error(`Unexpected ${t}`,e):(this._subject=null,t==="]"?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._predicate!==null?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if((this._predicate=this._readEntity(e))===void 0)return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(e.prefix.length===0)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if((this._object=this._readEntity(e))===void 0)return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return e.type==="{"?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return e.type!=="{"?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return e.type==="]"?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if(e.type!=="]")return this._readBlankNodePunctuation(e);this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph);let t=this._predicate===null;return this._restoreContext("blank",e),this._object!==null?this._getContextEndReader():this._predicate!==null?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,i=null,n=this._readListItem,s=this._subject,o=this._contextStack,a=o[o.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,i=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),n=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,i=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),o.length!==0&&o[o.length-1].type==="list"&&this._emit(this._subject,this._predicate,this._object,this._graph),this._predicate===null){if(n=this._readPredicate,this._subject===this.RDF_NIL)return n}else if(n=this._getContextEndReader(),this._object===this.RDF_NIL)return n;i=this.RDF_NIL;break;case"literal":e.prefix.length===0?(this._literalValue=e.value,n=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),n=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if((t=this._readEntity(e))===void 0)return}if(i===null&&(this._subject=i=this._blankNode()),s===null?a.predicate===null?a.subject=i:a.object=i:this._emit(s,this.RDF_REST,i,this._graph),t!==null){if(this._n3Mode&&(e.type==="IRI"||e.type==="prefixed"))return this._saveContext("item",this._graph,i,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(i,this.RDF_FIRST,t,this._graph)}return n}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":let i=this._readEntity(e);if(i===void 0)return;t=this._literal(this._literalValue,i),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null;break}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){let i=this._completeLiteral(e);if(i)return this._object=i.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),i.token===null?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(i.token))}_readFormulaTail(e){return e.type!=="}"?this._readPunctuation(e):(this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),this._object===null?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,i=this._graph,n=this._subject,s=this._inversePredicate;switch(e.type){case"}":if(this._graph===null)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,s&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF* syntax",e);let o=this._predicate,a=this._object;this._subject=this._quad(n,o,a,this.DEFAULTGRAPH),t=this._readPredicate;break;case"|}":if(this._subject.termType!=="Quad")return this._error("Unexpected asserted triple closing",e);this._subject=null,t=this._readPunctuation;break;default:if(this._supportsQuads&&this._graph===null&&(i=this._readEntity(e))!==void 0){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(n!==null){let o=this._predicate,a=this._object;s?this._emit(a,o,n,i):this._emit(n,o,a,i)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return e.type!=="."?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return e.type!=="prefix"?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if(e.type!=="IRI")return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);let t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){let t=e.type==="IRI"&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return e.type!=="]"?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):e.type!=="."?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if((t=this._readEntity(e,!0))!==void 0)break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(this._subject===null?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return e.type===","?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:let t=this._contextStack,i=t.length&&t[t.length-1];if(i&&i.type==="item"){let n=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,n,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,i,n=this._blankNode();if((i=this._readEntity(e))!==void 0)return this._predicate===null?(t=this._subject,this._subject=n):(t=this._object,this._object=n),this._emit(t,i,n,this._graph),this._readPath}_readBackwardPath(e){let t=this._blankNode(),i,n;if((i=this._readEntity(e))!==void 0)return this._predicate===null?(n=this._subject,this._subject=t):(n=this._object,this._object=t),this._emit(t,i,n,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return e.type!==">>"?this._supportsQuads&&this._graph===null&&(this._graph=this._readEntity(e))!==void 0?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(e.type!==">>")return this._error(`Expected >> but got ${e.type}`,e);let t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),this._subject===null?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){let e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,i,n){this._callback(null,this._quad(e,t,i,n||this.DEFAULTGRAPH))}_error(e,t){let i=new Error(`${e} on line ${t.line}.`);i.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(i),this._callback=Nt}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return(e[1]==="/"?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;let t=e.length,i="",n=-1,s=-1,o=0,a="/";for(;n<t;){switch(a){case":":if(s<0&&e[++n]==="/"&&e[++n]==="/")for(;(s=n+1)<t&&e[s]!=="/";)n=s;break;case"?":case"#":n=t;break;case"/":if(e[n+1]===".")switch(a=e[++n+1],a){case"/":i+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return i+e.substring(o,n)+e.substr(n+1);case".":if(a=e[++n+1],a===void 0||a==="/"||a==="?"||a==="#"){if(i+=e.substring(o,n-2),(o=i.lastIndexOf("/"))>=s&&(i=i.substr(0,o)),a!=="/")return`${i}/${e.substr(n+1)}`;o=n+1}}}a=e[++n]}return i+e.substring(o)}parse(e,t,i){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${Hr++}_`,this._prefixCallback=i||Nt,this._inversePredicate=!1,this._quantified=Object.create(null),!t){let n=[],s;if(this._callback=(o,a)=>{o?s=o:a&&n.push(a)},this._lexer.tokenize(e).every(o=>this._readCallback=this._readCallback(o)),s)throw s;return n}this._callback=t,this._lexer.tokenize(e,(n,s)=>{n!==null?(this._callback(n),this._callback=Nt):this._readCallback&&(this._readCallback=this._readCallback(s))})}};function Nt(){}function Vr(r,e){let t=e.namedNode;r._namedNode=t,r._blankNode=e.blankNode,r._literal=e.literal,r._variable=e.variable,r._quad=e.quad,r.DEFAULTGRAPH=e.defaultGraph(),r.RDF_FIRST=t(j.rdf.first),r.RDF_REST=t(j.rdf.rest),r.RDF_NIL=t(j.rdf.nil),r.N3_FORALL=t(j.r.forAll),r.N3_FORSOME=t(j.r.forSome),r.ABBREVIATIONS={a:t(j.rdf.type),"=":t(j.owl.sameAs),">":t(j.log.implies)},r.QUANTIFIERS_GRAPH=t("urn:n3:quantifiers")}Vr(ie.prototype,Qr);function At(r,e){var t,i=1;r==null&&(r=0),e==null&&(e=0);function n(){var s,o=t.length,a,l=0,u=0;for(s=0;s<o;++s)a=t[s],l+=a.x,u+=a.y;for(l=(l/o-r)*i,u=(u/o-e)*i,s=0;s<o;++s)a=t[s],a.x-=l,a.y-=u}return n.initialize=function(s){t=s},n.x=function(s){return arguments.length?(r=+s,n):r},n.y=function(s){return arguments.length?(e=+s,n):e},n.strength=function(s){return arguments.length?(i=+s,n):i},n}function Wr(r){let e=+this._x.call(null,r),t=+this._y.call(null,r);return Zr(this.cover(e,t),e,t,r)}function Zr(r,e,t,i){if(isNaN(e)||isNaN(t))return r;var n,s=r._root,o={data:i},a=r._x0,l=r._y0,u=r._x1,f=r._y1,h,m,g,_,p,d,y,x;if(!s)return r._root=o,r;for(;s.length;)if((p=e>=(h=(a+u)/2))?a=h:u=h,(d=t>=(m=(l+f)/2))?l=m:f=m,n=s,!(s=s[y=d<<1|p]))return n[y]=o,r;if(g=+r._x.call(null,s.data),_=+r._y.call(null,s.data),e===g&&t===_)return o.next=s,n?n[y]=o:r._root=o,r;do n=n?n[y]=new Array(4):r._root=new Array(4),(p=e>=(h=(a+u)/2))?a=h:u=h,(d=t>=(m=(l+f)/2))?l=m:f=m;while((y=d<<1|p)===(x=(_>=m)<<1|g>=h));return n[x]=s,n[y]=o,r}function Xr(r){var e,t,i=r.length,n,s,o=new Array(i),a=new Array(i),l=1/0,u=1/0,f=-1/0,h=-1/0;for(t=0;t<i;++t)isNaN(n=+this._x.call(null,e=r[t]))||isNaN(s=+this._y.call(null,e))||(o[t]=n,a[t]=s,n<l&&(l=n),n>f&&(f=n),s<u&&(u=s),s>h&&(h=s));if(l>f||u>h)return this;for(this.cover(l,u).cover(f,h),t=0;t<i;++t)Zr(this,o[t],a[t],r[t]);return this}function Kr(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,i=this._y0,n=this._x1,s=this._y1;if(isNaN(t))n=(t=Math.floor(r))+1,s=(i=Math.floor(e))+1;else{for(var o=n-t||1,a=this._root,l,u;t>r||r>=n||i>e||e>=s;)switch(u=(e<i)<<1|r<t,l=new Array(4),l[u]=a,a=l,o*=2,u){case 0:n=t+o,s=i+o;break;case 1:t=n-o,s=i+o;break;case 2:n=t+o,i=s-o;break;case 3:t=n-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=t,this._y0=i,this._x1=n,this._y1=s,this}function Jr(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function Yr(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function k(r,e,t,i,n){this.node=r,this.x0=e,this.y0=t,this.x1=i,this.y1=n}function ei(r,e,t){var i,n=this._x0,s=this._y0,o,a,l,u,f=this._x1,h=this._y1,m=[],g=this._root,_,p;for(g&&m.push(new k(g,n,s,f,h)),t==null?t=1/0:(n=r-t,s=e-t,f=r+t,h=e+t,t*=t);_=m.pop();)if(!(!(g=_.node)||(o=_.x0)>f||(a=_.y0)>h||(l=_.x1)<n||(u=_.y1)<s))if(g.length){var d=(o+l)/2,y=(a+u)/2;m.push(new k(g[3],d,y,l,u),new k(g[2],o,y,d,u),new k(g[1],d,a,l,y),new k(g[0],o,a,d,y)),(p=(e>=y)<<1|r>=d)&&(_=m[m.length-1],m[m.length-1]=m[m.length-1-p],m[m.length-1-p]=_)}else{var x=r-+this._x.call(null,g.data),w=e-+this._y.call(null,g.data),b=x*x+w*w;if(b<t){var R=Math.sqrt(t=b);n=r-R,s=e-R,f=r+R,h=e+R,i=g.data}}return i}function ti(r){if(isNaN(f=+this._x.call(null,r))||isNaN(h=+this._y.call(null,r)))return this;var e,t=this._root,i,n,s,o=this._x0,a=this._y0,l=this._x1,u=this._y1,f,h,m,g,_,p,d,y;if(!t)return this;if(t.length)for(;;){if((_=f>=(m=(o+l)/2))?o=m:l=m,(p=h>=(g=(a+u)/2))?a=g:u=g,e=t,!(t=t[d=p<<1|_]))return this;if(!t.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(i=e,y=d)}for(;t.data!==r;)if(n=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,n?(s?n.next=s:delete n.next,this):e?(s?e[d]=s:delete e[d],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(i?i[y]=t:this._root=t),this):(this._root=s,this)}function ri(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function ii(){return this._root}function ni(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function si(r){var e=[],t,i=this._root,n,s,o,a,l;for(i&&e.push(new k(i,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(i=t.node,s=t.x0,o=t.y0,a=t.x1,l=t.y1)&&i.length){var u=(s+a)/2,f=(o+l)/2;(n=i[3])&&e.push(new k(n,u,f,a,l)),(n=i[2])&&e.push(new k(n,s,f,u,l)),(n=i[1])&&e.push(new k(n,u,o,a,f)),(n=i[0])&&e.push(new k(n,s,o,u,f))}return this}function oi(r){var e=[],t=[],i;for(this._root&&e.push(new k(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var n=i.node;if(n.length){var s,o=i.x0,a=i.y0,l=i.x1,u=i.y1,f=(o+l)/2,h=(a+u)/2;(s=n[0])&&e.push(new k(s,o,a,f,h)),(s=n[1])&&e.push(new k(s,f,a,l,h)),(s=n[2])&&e.push(new k(s,o,h,f,u)),(s=n[3])&&e.push(new k(s,f,h,l,u))}t.push(i)}for(;i=t.pop();)r(i.node,i.x0,i.y0,i.x1,i.y1);return this}function ai(r){return r[0]}function ui(r){return arguments.length?(this._x=r,this):this._x}function li(r){return r[1]}function ci(r){return arguments.length?(this._y=r,this):this._y}function ce(r,e,t){var i=new kt(e??ai,t??li,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function kt(r,e,t,i,n,s){this._x=r,this._y=e,this._x0=t,this._y0=i,this._x1=n,this._y1=s,this._root=void 0}function hi(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var P=ce.prototype=kt.prototype;P.copy=function(){var r=new kt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,i;if(!e)return r;if(!e.length)return r._root=hi(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var n=0;n<4;++n)(i=e.source[n])&&(i.length?t.push({source:i,target:e.target[n]=new Array(4)}):e.target[n]=hi(i));return r};P.add=Wr;P.addAll=Xr;P.cover=Kr;P.data=Jr;P.extent=Yr;P.find=ei;P.remove=ti;P.removeAll=ri;P.root=ii;P.size=ni;P.visit=si;P.visitAfter=oi;P.x=ui;P.y=ci;function H(r){return function(){return r}}function G(r){return(r()-.5)*1e-6}function Un(r){return r.x+r.vx}function Mn(r){return r.y+r.vy}function qt(r){var e,t,i,n=1,s=1;typeof r!="function"&&(r=H(r==null?1:+r));function o(){for(var u,f=e.length,h,m,g,_,p,d,y=0;y<s;++y)for(h=ce(e,Un,Mn).visitAfter(a),u=0;u<f;++u)m=e[u],p=t[m.index],d=p*p,g=m.x+m.vx,_=m.y+m.vy,h.visit(x);function x(w,b,R,B,O){var C=w.data,z=w.r,I=p+z;if(C){if(C.index>m.index){var J=g-C.x-C.vx,Y=_-C.y-C.vy,V=J*J+Y*Y;V<I*I&&(J===0&&(J=G(i),V+=J*J),Y===0&&(Y=G(i),V+=Y*Y),V=(I-(V=Math.sqrt(V)))/V*n,m.vx+=(J*=V)*(I=(z*=z)/(d+z)),m.vy+=(Y*=V)*I,C.vx-=J*(I=1-I),C.vy-=Y*I)}return}return b>g+I||B<g-I||R>_+I||O<_-I}}function a(u){if(u.data)return u.r=t[u.data.index];for(var f=u.r=0;f<4;++f)u[f]&&u[f].r>u.r&&(u.r=u[f].r)}function l(){if(e){var u,f=e.length,h;for(t=new Array(f),u=0;u<f;++u)h=e[u],t[h.index]=+r(h,u,e)}}return o.initialize=function(u,f){e=u,i=f,l()},o.iterations=function(u){return arguments.length?(s=+u,o):s},o.strength=function(u){return arguments.length?(n=+u,o):n},o.radius=function(u){return arguments.length?(r=typeof u=="function"?u:H(+u),l(),o):r},o}function zn(r){return r.index}function fi(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function Dt(r){var e=zn,t=h,i,n=H(30),s,o,a,l,u,f=1;r==null&&(r=[]);function h(d){return 1/Math.min(a[d.source.index],a[d.target.index])}function m(d){for(var y=0,x=r.length;y<f;++y)for(var w=0,b,R,B,O,C,z,I;w<x;++w)b=r[w],R=b.source,B=b.target,O=B.x+B.vx-R.x-R.vx||G(u),C=B.y+B.vy-R.y-R.vy||G(u),z=Math.sqrt(O*O+C*C),z=(z-s[w])/z*d*i[w],O*=z,C*=z,B.vx-=O*(I=l[w]),B.vy-=C*I,R.vx+=O*(I=1-I),R.vy+=C*I}function g(){if(o){var d,y=o.length,x=r.length,w=new Map(o.map((R,B)=>[e(R,B,o),R])),b;for(d=0,a=new Array(y);d<x;++d)b=r[d],b.index=d,typeof b.source!="object"&&(b.source=fi(w,b.source)),typeof b.target!="object"&&(b.target=fi(w,b.target)),a[b.source.index]=(a[b.source.index]||0)+1,a[b.target.index]=(a[b.target.index]||0)+1;for(d=0,l=new Array(x);d<x;++d)b=r[d],l[d]=a[b.source.index]/(a[b.source.index]+a[b.target.index]);i=new Array(x),_(),s=new Array(x),p()}}function _(){if(o)for(var d=0,y=r.length;d<y;++d)i[d]=+t(r[d],d,r)}function p(){if(o)for(var d=0,y=r.length;d<y;++d)s[d]=+n(r[d],d,r)}return m.initialize=function(d,y){o=d,u=y,g()},m.links=function(d){return arguments.length?(r=d,g(),m):r},m.id=function(d){return arguments.length?(e=d,m):e},m.iterations=function(d){return arguments.length?(f=+d,m):f},m.strength=function(d){return arguments.length?(t=typeof d=="function"?d:H(+d),_(),m):t},m.distance=function(d){return arguments.length?(n=typeof d=="function"?d:H(+d),p(),m):n},m}function pi(){let r=1;return()=>(r=(1664525*r+1013904223)%4294967296)/4294967296}function di(r){return r.x}function gi(r){return r.y}var Gn=10,$n=Math.PI*(3-Math.sqrt(5));function Bt(r){var e,t=1,i=.001,n=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=pr(h),u=hr("tick","end"),f=pi();r==null&&(r=[]);function h(){m(),u.call("tick",e),t<i&&(l.stop(),u.call("end",e))}function m(p){var d,y=r.length,x;p===void 0&&(p=1);for(var w=0;w<p;++w)for(t+=(s-t)*n,a.forEach(function(b){b(t)}),d=0;d<y;++d)x=r[d],x.fx==null?x.x+=x.vx*=o:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=o:(x.y=x.fy,x.vy=0);return e}function g(){for(var p=0,d=r.length,y;p<d;++p){if(y=r[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var x=Gn*Math.sqrt(.5+p),w=p*$n;y.x=x*Math.cos(w),y.y=x*Math.sin(w)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function _(p){return p.initialize&&p.initialize(r,f),p}return g(),e={tick:m,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(p){return arguments.length?(r=p,g(),a.forEach(_),e):r},alpha:function(p){return arguments.length?(t=+p,e):t},alphaMin:function(p){return arguments.length?(i=+p,e):i},alphaDecay:function(p){return arguments.length?(n=+p,e):+n},alphaTarget:function(p){return arguments.length?(s=+p,e):s},velocityDecay:function(p){return arguments.length?(o=1-p,e):1-o},randomSource:function(p){return arguments.length?(f=p,a.forEach(_),e):f},force:function(p,d){return arguments.length>1?(d==null?a.delete(p):a.set(p,_(d)),e):a.get(p)},find:function(p,d,y){var x=0,w=r.length,b,R,B,O,C;for(y==null?y=1/0:y*=y,x=0;x<w;++x)O=r[x],b=p-O.x,R=d-O.y,B=b*b+R*R,B<y&&(C=O,y=B);return C},on:function(p,d){return arguments.length>1?(u.on(p,d),e):u.on(p)}}}function Pt(){var r,e,t,i,n=H(-30),s,o=1,a=1/0,l=.81;function u(g){var _,p=r.length,d=ce(r,di,gi).visitAfter(h);for(i=g,_=0;_<p;++_)e=r[_],d.visit(m)}function f(){if(r){var g,_=r.length,p;for(s=new Array(_),g=0;g<_;++g)p=r[g],s[p.index]=+n(p,g,r)}}function h(g){var _=0,p,d,y=0,x,w,b;if(g.length){for(x=w=b=0;b<4;++b)(p=g[b])&&(d=Math.abs(p.value))&&(_+=p.value,y+=d,x+=d*p.x,w+=d*p.y);g.x=x/y,g.y=w/y}else{p=g,p.x=p.data.x,p.y=p.data.y;do _+=s[p.data.index];while(p=p.next)}g.value=_}function m(g,_,p,d){if(!g.value)return!0;var y=g.x-e.x,x=g.y-e.y,w=d-_,b=y*y+x*x;if(w*w/l<b)return b<a&&(y===0&&(y=G(t),b+=y*y),x===0&&(x=G(t),b+=x*x),b<o&&(b=Math.sqrt(o*b)),e.vx+=y*g.value*i/b,e.vy+=x*g.value*i/b),!0;if(g.length||b>=a)return;(g.data!==e||g.next)&&(y===0&&(y=G(t),b+=y*y),x===0&&(x=G(t),b+=x*x),b<o&&(b=Math.sqrt(o*b)));do g.data!==e&&(w=s[g.data.index]*i/b,e.vx+=y*w,e.vy+=x*w);while(g=g.next)}return u.initialize=function(g,_){r=g,t=_,f()},u.strength=function(g){return arguments.length?(n=typeof g=="function"?g:H(+g),f(),u):n},u.distanceMin=function(g){return arguments.length?(o=g*g,u):Math.sqrt(o)},u.distanceMax=function(g){return arguments.length?(a=g*g,u):Math.sqrt(a)},u.theta=function(g){return arguments.length?(l=g*g,u):Math.sqrt(l)},u}var jo={LINK_DISTANCE:1/50,COLLISION_STRENGTH:1,CHARGE_STRENGTH:-1};var Pe=class{constructor(){this.nodes=[],this.links=[],this.nodeTriples=[]}};var ve=class{constructor(e,t){let i="";this.source=e,this.target=t,this.predicate=i,this.weight=1}};var Le=class{constructor(e,t,i){this.nodeSubject=e,this.nodePredicate=t,this.nodeObject=i}};var Z;(function(r){r.link="link",r.node="node"})(Z||(Z={}));var he=class{constructor(e,t){this.id=e,this.label=e,this.weight=1,this.type=t,this.owlClass=!1,this.instance=!1}};var ne;(function(r){r.TURTLE="TURTLE",r.SPARQL="SPARQL"})(ne||(ne={}));var D;(function(r){r.SHORT="short",r.LONG="long"})(D||(D={}));var q=class{constructor(e,t){this.prefixName=e,this.prefixIri=t}};var Lt=[new q("awg","https://edition.anton-webern.ch/webern-onto#"),new q("dbo","http://dbpedia.org/ontology/"),new q("dbp","http://dbpedia.org/property/"),new q("dbpedia","http://dbpedia.org/resource/"),new q("dc","http://purl.org/dc/elements/1.1/"),new q("dcterms","http://purl.org/dc/terms/"),new q("foaf","http://xmlns.com/foaf/0.1/"),new q("mo","http://purl.org/ontology/mo/"),new q("owl","http://www.w3.org/2002/07/owl#"),new q("prov","http://www.w3.org/ns/prov#"),new q("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),new q("rdfs","http://www.w3.org/2000/01/rdf-schema#"),new q("skos","http://www.w3.org/2004/02/skos/core#"),new q("xsd","http://www.w3.org/2001/XMLSchema#")];var X=class{constructor(){this.defaultPrefixes=Lt}transform(e,t){let i;switch(t){case D.SHORT:{this.defaultPrefixes.forEach(n=>{e.indexOf(n.prefixIri)!==-1&&(i=e.replace(n.prefixIri,n.prefixName+":"))});break}case D.LONG:{this.defaultPrefixes.forEach(n=>{e.indexOf(n.prefixName)!==-1&&(i=e.replace(n.prefixName+":",n.prefixIri))});break}default:{let n=t;throw new Error(`The prefixForm must be ${D.SHORT} or ${D.LONG}, but was: ${n}.`)}}return i||e}};X=E([Zt({name:"prefix",pure:!1})],X);var Re,se=(Re=class{constructor(e){this.prefixPipe=e}parseTripleString(e){let t=new ie,i=[];return new Promise((n,s)=>{t.parse(e,(o,a,l)=>{a?i.push(a):n({triples:i,namespaces:l}),o&&s(o)})})}limitTriples(e,t){return e?e.length>t?e.slice(0,t):e:[]}abbreviateTriples(e,t,i){return i||(i="text/turtle"),e.map(n=>{let s=n.subject.nominalValue,o=n.predicate.nominalValue,a=n.object.nominalValue;return i==="text/turtle"&&(this._abbreviate(s,t)!=null&&(s=this._abbreviate(s,t)),this._abbreviate(o,t)!=null&&(o=this._abbreviate(o,t)),this._abbreviate(a,t)!=null&&(a=this._abbreviate(a,t))),{subject:s,predicate:o,object:a}})}checkNamespacesInQuery(e,t){if(!e||!t)return;let i=this._extractNamespacesFromString(ne.TURTLE,t),n=this._extractNamespacesFromString(ne.SPARQL,e),s=this._extractQNamesFromSPARQLWhereClause(e),o=Object.keys(i),a=Object.keys(n),l="";return o.forEach(u=>{a.indexOf(u)===-1&&(l+=`PREFIX ${u} ${i[u]}
`)}),s.length>0&&s.forEach(u=>{if(a.indexOf(u)===-1){console.warn(`Prefix '${u}' not declared in SPARQL and/or Turtle header. Searching in default namespaces...`);let f=this.prefixPipe.transform(u,D.LONG);if(f!==u){let h=`PREFIX ${u} <${f}>
`;l+=h,console.warn(`Added '${h}' to SPARQL prefixes from list of default namespaces.`)}else console.warn(`'${u}' is unknown. Please provide a declaration.`)}}),l!==""&&(e=l+e),e}doQuery(e,t,i,n){return n||(n="text/turtle"),this._createStore().then(s=>(this._store=s,this._loadTriplesInStore(s,i,n))).then(s=>this._executeQuery(this._store,t)).then(s=>{if(e==="select"){let o=s;return this._prepareSelectResponse(o).data}if(e==="construct"){let o=s;return this._getNamespaces(i).then(a=>this.abbreviateTriples(o.triples,a,n))}})}getQuerytype(e){let t=[{queryType:"select",index:-1},{queryType:"construct",index:-1},{queryType:"ask",index:-1},{queryType:"count",index:-1},{queryType:"describe",index:-1},{queryType:"insert",index:-1},{queryType:"delete",index:-1}],i=!1,n=1/0;if(t=t.map(a=>(a.index=e.toLowerCase().indexOf(a.queryType),a.index!==-1&&(i=!0,a.index<n&&(n=a.index)),a)),!i)return null;let o=t.find(a=>a.index===n).queryType;return(o==="insert"||o==="delete")&&(o="update"),o}_abbreviate(e,t){let i=e;return e.indexOf("http")!==-1&&Object.entries(t).forEach(([n,s])=>{e.indexOf(s)!==-1&&(i=e.replace(s,n+":"))}),i}_createStore(){return new Promise((e,t)=>{rdfstore.create((i,n)=>{i&&t(i),e(n)})})}_executeQuery(e,t){return new Promise((i,n)=>{e.execute(t,(s,o)=>{s&&(console.error("_executeQuery# got ERROR",s),n(s)),i(o)})})}_extractNamespacesFromString(e,t){let i=t.toLowerCase().replace(/\s/g," ").split(" ").filter(a=>a!==""),n;switch(e){case ne.TURTLE:{n="@prefix".toLowerCase();break}case ne.SPARQL:{n="PREFIX".toLowerCase();break}default:{let a=e;throw new Error(`The type must be TURTLE or SPARQL, but was: ${a}.`)}}let s=i.reduce((a,l,u)=>(l===n&&a.push(u),a),[]),o={};return s.forEach(a=>{let l=i[a+1],u=i[a+2];u.at(-1)==="."&&(u=u.slice(0,-1)),o[l]=u}),o}_extractQNamesFromSPARQLWhereClause(e){let t,i=e.toLowerCase(),n=0,s=[],o=/\b[a-zA-Z]{2,15}:/g,a="WHERE {".toLowerCase();for(i.includes(a)&&(n=i.indexOf(a)+a.length),i=i.slice(n);(t=o.exec(i))!==null;)t.index===o.lastIndex&&o.lastIndex++,t.forEach(l=>{s.indexOf(l)===-1&&s.push(l)});return s}_getNamespaces(e){let t=new ie;return new Promise((i,n)=>{t.parse(e,(s,o,a)=>{o||i(a),s&&n(s)})})}_loadTriplesInStore(e,t,i){return i||(i="text/turtle"),new Promise((n,s)=>{e.load(i,t,(o,a)=>{o&&(console.error("_loadTriplesInStore# got error",o),s(o)),n(a)})})}_mapKeys(e,t){let i=Object.keys(e).map(n=>({[t[n]||n]:e[n]}));return Object.assign({},...i)}_prepareSelectResponse(e){if(!e)return{status:404,data:void 0};if(e[0]==null)return{status:400,data:"Query returned no results"};let t=Object.keys(e[0]),i=e,n={token:"type",type:"datatype",lang:"xml:lang"};for(let o in i)if(i.hasOwnProperty(o)){for(let a in t)if(t.hasOwnProperty(a)&&(i[o][t[a]]=this._mapKeys(i[o][t[a]],n),i[o][t[a]].label="",i[o][t[a]].value)){i[o][t[a]].label=this.prefixPipe.transform(i[o][t[a]].value,D.SHORT);let l="http://www.w3.org/2001/XMLSchema#integer",u="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",f=i[o][t[a]].type,h=i[o][t[a]].datatype||"";f==="literal"&&(h===l||h===u)&&(i[o][t[a]].label=+i[o][t[a]].value)}}return{status:200,data:{head:{vars:t},body:{bindings:i}}}}},Re.ctorParameters=()=>[{type:X}],Re);se=E([Wt()],se);var fe,pe=(fe=class{constructor(e,t){this.graphVisualizerService=e,this.toastService=t,this.defaultForceGraphHeight=500}ngOnInit(){this.resetTriples(),this.resetQuery()}resetTriples(){this.graphRDFInputData.triples&&(this.triples=this.graphRDFInputData.triples)}resetQuery(e){if(!this.graphRDFInputData.queryList)return;this.queryList=JSON.parse(JSON.stringify(this.graphRDFInputData.queryList));let t=e?this.queryList.find(i=>e.queryLabel===i.queryLabel&&e.queryType===i.queryType)||e:this.queryList[0];this.query=jt({},t),this.performQuery()}performQuery(){if(this.query.queryString=this.graphVisualizerService.checkNamespacesInQuery(this.query.queryString,this.triples),this.query.queryType=this.graphVisualizerService.getQuerytype(this.query.queryString),this.query.queryType==="construct"||this.query.queryType==="select"){let e=this._queryLocalStore(this.query.queryType,this.query.queryString,this.triples);this.queryResult$=zt(e)}else this.queryResult$=Ue}onGraphNodeClick(e){e&&console.info("GraphVisualizerComponent# graphClick on node",e)}onTableNodeClick(e){e&&console.info("GraphVisualizerComponent# tableClick on URI",e)}showErrorMessage(e){if(!e?.message)return;let t=new tr(e.message,{header:e.name,classname:"bg-danger text-light",delay:e.duration});this.toastService.add(t),console.error(e.name,":",e.message)}_queryLocalStore(e,t,i){return Mt(this,null,function*(){let n=Date.now(),s;try{s=yield this.graphVisualizerService.doQuery(e,t,i),this.queryTime=Date.now()-n}catch(o){console.error("#queryLocalstore got error:",o),o.message&&o.name&&(o.message.indexOf("undefined")!==-1&&this.showErrorMessage(new ae(o.name,"The query did not return any results.",5e3)),this.showErrorMessage(new ae(o.name,o.message,5e3))),this.queryTime=Date.now()-n,s=[]}return s})}},fe.ctorParameters=()=>[{type:se},{type:rr}],fe.propDecorators={fs:[{type:ee,args:["fs"]}],graphRDFInputData:[{type:v}],isFullscreen:[{type:v}]},fe);pe=E([S({selector:"awg-graph-visualizer",template:gr,changeDetection:T.Default,styles:[_r]})],pe);var _i=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-construct-results"
        [collapsed]="false"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader>
            <button ngbAccordionButton class="p-3">Resultat</button>
        </div>
        <div ngbAccordionCollapse>
            <div ngbAccordionBody>
                <ng-template>
                    @if (queryResult$ | async; as queryResult) {
                        @if (isQueryResultNotEmpty(queryResult)) {
                            <!-- Force graph visualization -->
                            <awg-force-graph
                                class="full-width"
                                [currentQueryResultTriples]="queryResult"
                                [height]="defaultForceGraphHeight"
                                (clickedNodeRequest)="onGraphNodeClick($event)">
                            </awg-force-graph>
                        } @else {
                            <awg-sparql-no-results></awg-sparql-no-results>
                        }
                    } @else {
                        <awg-twelve-tone-spinner></awg-twelve-tone-spinner>
                    }
                </ng-template>
            </div>
        </div>
    </div>
</div>
`;var mi="";var Se,Xe=(Se=class{constructor(){this.clickedNodeRequest=new F}isQueryResultNotEmpty(e){return e.length===0?!1:e.every(t=>{let{subject:i,predicate:n,object:s}=t;return!!i&&!!n&&!!s})}isAccordionItemDisabled(){return this.isFullscreen}onGraphNodeClick(e){e&&this.clickedNodeRequest.emit(e)}},Se.propDecorators={queryResult$:[{type:v}],defaultForceGraphHeight:[{type:v}],isFullscreen:[{type:v}],clickedNodeRequest:[{type:N}]},Se);Xe=E([S({selector:"awg-construct-results",template:_i,changeDetection:T.OnPush,styles:[mi]})],Xe);var yi=`<div
    #graphContainer
    id="awg-force-graph-container"
    class="awg-force-graph-panel-container"
    [ngStyle]="{ 'height.px': height }">
    <div class="awg-force-graph-icon-bar">
        <!-- Slider -->
        <div class="input-group input-group-sm awg-force-graph-zoom-slider-container float-start mb-3">
            <span #sliderInputLabel class="input-group-text" id="slider-label">{{ sliderConfig.value }}x</span>
            <input
                type="range"
                #sliderInput
                class="awg-force-graph-zoom-slider"
                id="awg-force-graph-zoom-slider"
                name="zoomSlider"
                aria-label="Zoom slider"
                aria-describedby="slider-label"
                [min]="sliderConfig.min"
                [max]="sliderConfig.max"
                [step]="sliderConfig.stepSize"
                [(ngModel)]="sliderConfig.value"
                (ngModelChange)="onZoomChange($event)" />
            <button class="btn btn-sm btn-outline-info" type="submit" title="Reset" (click)="onReCenter()">
                <fa-icon [icon]="faCompressArrowsAlt"></fa-icon>
            </button>
        </div>

        <!-- Limit -->
        @if (currentQueryResultTriples) {
            <div class="btn-group awg-force-graph-node-limit-container float-end my-auto">
                <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">
                    @if (limit < currentQueryResultTriples.length) {
                        <span>{{ limit }} von </span>
                    }
                    {{ currentQueryResultTriples.length }} Triples
                </button>
                <div
                    class="btn-group"
                    ngbDropdown
                    container="body"
                    role="group"
                    aria-label="Button group with nested dropdown for node limit">
                    <button
                        class="btn btn-sm btn-info dropdown-toggle"
                        ngbDropdownToggle
                        [disabled]="currentQueryResultTriples.length === 0"></button>
                    <div class="dropdown-menu" ngbDropdownMenu>
                        @for (limitValue of limitValues; track limitValue) {
                            @if (currentQueryResultTriples.length > limitValue) {
                                <button class="dropdown-item" (click)="onLimitValueChange(limitValue)">
                                    <span>{{ limitValue }}</span>
                                </button>
                            }
                        }
                        <button class="dropdown-item" (click)="onLimitValueChange(currentQueryResultTriples.length)">
                            <span>Kein Limit</span>
                        </button>
                    </div>
                </div>
            </div>
        }

        <!-- <span *ngIf="message" class="message">{{message}}</span> -->
    </div>
</div>
`;var xi=`#awg-force-graph-container{position:relative;width:100%}#awg-force-graph-container>.awg-force-graph-icon-bar{position:relative;width:100%}.awg-force-graph-panel-container{position:inherit;height:100%}.input-group.awg-force-graph-zoom-slider-container{flex-wrap:nowrap;width:auto}.input-group.awg-force-graph-zoom-slider-container>:not(:first-child){margin-left:0!important}#slider-label.input-group-text{min-width:50px;color:#149b9e}input[type=range].awg-force-graph-zoom-slider{width:100%;background-color:transparent;-webkit-appearance:none}input[type=range].awg-force-graph-zoom-slider:focus{outline:none}input[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-lower{background:#ddddddc7}input[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-upper{background:#e5e5e5}input[type=range].awg-force-graph-zoom-slider:focus::-webkit-slider-runnable-track{background:#e5e5e5}input[type=range].awg-force-graph-zoom-slider::-webkit-slider-runnable-track{background:#ddddddc7;border:.2px solid #dddddd;border-radius:1.3px;width:100%;height:31px;cursor:pointer}input[type=range].awg-force-graph-zoom-slider::-webkit-slider-thumb{width:15px;height:29px;background:#149b9e;border:1.8px solid #149b9e;border-radius:10px;cursor:pointer;-webkit-appearance:none}input[type=range].awg-force-graph-zoom-slider::-moz-range-track{background:#ddddddc7;border:.2px solid #dddddd;border-radius:1.3px;width:100%;height:29px;cursor:pointer;-moz-margin-start:fill;margin-right:fill}input[type=range].awg-force-graph-zoom-slider::-moz-range-thumb{width:15px;height:27px;background:#149b9e;border:1.8px solid #149b9e;border-radius:10px;cursor:pointer}input[type=range].awg-force-graph-zoom-slider::-ms-track{background:transparent;border-color:transparent;border-width:7.4px 0;color:transparent;width:100%;height:31px;cursor:pointer}input[type=range].awg-force-graph-zoom-slider::-ms-fill-lower{background:#ddddddc7;border:.2px solid #dddddd;border-radius:2.6px}input[type=range].awg-force-graph-zoom-slider::-ms-fill-upper{background:#ddddddc7;border:.2px solid #dddddd;border-radius:2.6px}input[type=range].awg-force-graph-zoom-slider::-ms-thumb{width:15px;height:29px;background:#149b9e;border:1.8px solid #149b9e;border-radius:10px;cursor:pointer;margin-top:0}:host ::ng-deep .node{stroke:#fff;fill:#ddd;stroke-width:1.5px}:host ::ng-deep .blank{stroke:#fff;fill:#000!important;stroke-width:1.5px}:host ::ng-deep .blank.instance{stroke:#fff;fill:#000;stroke-width:1.5px}:host ::ng-deep .class{stroke:#fff;fill:#9e0000;stroke-width:1.5px}:host ::ng-deep .instance{stroke:#fff;fill:#20b2aa;stroke-width:1.5px}:host ::ng-deep .instance-space{stroke:#fff;fill:#00bfff;stroke-width:1.5px}:host ::ng-deep .instance-spaceType{stroke:#fff;fill:#00008b;stroke-width:1.5px}:host ::ng-deep .link{fill:none;stroke:#999;stroke-opacity:.6;stroke-width:1px}:host ::ng-deep marker{stroke:#999;fill:#7cf00a00}:host ::ng-deep .node-text{font:15px Roboto,sans-serif;fill:#000}:host ::ng-deep .link-text{font:13px Roboto,sans-serif;fill:gray}
`;var Ke={LINK_DISTANCE:10,COLLISION_STRENGTH:1,COLLISION_RADIUS:30,CHARGE_STRENGTH:-10},de,Je=(de=class{constructor(e,t){this.graphVisualizerService=e,this.prefixPipe=t,this.clickedNodeRequest=new F,this.faCompressArrowsAlt=Yt,this.limitValues=[5,10,25,50,100,250,500,1e3],this.limit=50,this.sliderConfig=new cr(1,.1,3,.01,1),this._resize$=new ct,this._destroyed$=new ct}onResize(){!this._graphContainer||!this.currentQueryResultTriples||(this._divWidth=this._getContainerDimensions(this._graphContainer).width,this._divHeight=this._getContainerDimensions(this._graphContainer).height,this._resize$.next(!0))}ngOnInit(){this._resize$.pipe($t(150),Ht(this._destroyed$)).subscribe(e=>{this._redraw()}),this._redraw()}ngOnChanges(e){let{queryResultTriples:t}=e;t?.currentValue&&!t.isFirstChange()&&(this.currentQueryResultTriples=t.currentValue,this._redraw())}onLimitValueChange(e){this.limit=e,this._redraw()}onReCenter(){!this._svg||!(this._divWidth&&this._divHeight)||(this.onZoomChange(this.sliderConfig.initial),this._zoomBehaviour.translateTo(this._svg,this._divWidth/2,this._divHeight/2))}onZoomChange(e){this.sliderConfig.value=e,this._reScaleZoom()}log(e,t){let i=t&&JSON.parse(JSON.stringify(t));console.info(e,i)}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}_redraw(){this.currentQueryResultTriples&&(this._cleanSVG(),this._createSVG(),this._attachData(),this._reScaleZoom())}_cleanSVG(){ur("svg.force-graph > *").remove()}_createSVG(){if(!this._graphContainer)return;let e,t;this._divWidth?e=this._divWidth:this._getContainerDimensions(this._graphContainer).width?e=this._getContainerDimensions(this._graphContainer).width:e=400,this._divHeight?t=this._divHeight:this._getContainerDimensions(this._graphContainer).height?t=this._getContainerDimensions(this._graphContainer).height:t=500,this._divWidth=e,this._divHeight=t-45,this._svg||(this._svg=ar(this._graphContainer.nativeElement).append("svg").attr("class","force-graph")),this._svg.attr("width",this._divWidth).attr("height",this._divHeight),this._zoomGroup=this._svg.append("g").attr("class","zoom-container")}_attachData(){let e=this.graphVisualizerService.limitTriples(this.currentQueryResultTriples,this.limit);typeof e=="string"?this.graphVisualizerService.parseTripleString(e).then(t=>{let i=this.graphVisualizerService.abbreviateTriples(t.triples,t.namespaces);this._simulationData=this._triplesToD3GraphData(i),this._setupForceSimulation(),this._updateSVG()}):(this._simulationData=this._triplesToD3GraphData(e),this._setupForceSimulation(),this._updateSVG())}_setupForceSimulation(){this._forceSimulation=Bt();let e=Pt().strength(s=>this._nodeRadius(s)*Ke.CHARGE_STRENGTH),t=At(this._divWidth/2,this._divHeight/2),i=qt().strength(Ke.COLLISION_STRENGTH).radius(Ke.COLLISION_RADIUS).iterations(2),n=Dt().links(this._simulationData.links).id(s=>s.predicate).distance(Ke.LINK_DISTANCE);this._forceSimulation.force("charge_force",e).force("center_force",t).force("collide_force",i),this._forceSimulation.nodes(this._simulationData.nodes),this._forceSimulation.force("links",n),this._forceSimulation.alpha(1).restart()}_updateSVG(){if(!this._svg)return;this._zoomGroup.append("svg:defs").selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",30).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:polyline").attr("points","0,-5 10,0 0,5");let e=this._zoomGroup.append("g").attr("class","links").selectAll(".link").data(this._simulationData.nodeTriples).enter().append("path").attr("marker-end","url(#end)").attr("class","link"),t=this._zoomGroup.append("g").attr("class","link-texts").selectAll(".link-text").data(this._simulationData.nodeTriples).enter().append("text").attr("class","link-text").text(s=>s.nodePredicate.label),i=this._zoomGroup.append("g").attr("class","node-texts").selectAll(".node-text").data(this._filterNodesByType(this._simulationData.nodes,Z.node)).enter().append("text").attr("class","node-text").text(s=>s.label),n=this._zoomGroup.append("g").attr("class","nodes").selectAll(".node").data(this._filterNodesByType(this._simulationData.nodes,Z.node)).enter().append("circle").attr("class",s=>s.owlClass?"class":s.label.indexOf("_:")!==-1?"blank":s.instance||s.label.indexOf("inst:")!==-1?"instance":"node").attr("id",s=>s.label).attr("r",s=>s.label.indexOf("_:")!==-1?8:s.instance||s.label.indexOf("inst:")!==-1?11:s.owlClass||s.label.indexOf("inst:")!==-1?10:9).on("click",(s,o)=>{this._clickedOnNode(s,o)});this._forceSimulation.on("tick",()=>{this._updateNodePositions(n),this._updateNodeTextPositions(i),this._updateLinkPositions(e),this._updateLinkTextPositions(t)}),this._dragHandler(n,this._forceSimulation),this._zoomHandler(this._zoomGroup,this._svg)}_reScaleZoom(){!this._svg||!this.sliderConfig.value||this._zoomBehaviour.scaleTo(this._svg,this.sliderConfig.value)}_checkForRdfType(e){return e.label==="a"||e.label==="rdf:type"||e.label===this.prefixPipe.transform("rdf:type",D.LONG)}_clickedOnNode(e,t){e.defaultPrevented||this.clickedNodeRequest.emit(t)}_dragHandler(e,t){let i=(a,l)=>{a.sourceEvent.stopPropagation(),a.active||t.alphaTarget(.3).restart(),l.fx=l.x,l.fy=l.y},n=(a,l)=>{l.fx=a.x,l.fy=a.y},s=(a,l)=>{a.active||t.alphaTarget(0),l.fx=null,l.fy=null},o=fr().on("start",i).on("drag",n).on("end",s);e.call(o)}_zoomHandler(e,t){let i=n=>{let s=n.transform,o=this._roundToNearestScaleStep(s.k);e.attr("transform",s),this._sliderInput.nativeElement.value=o,this._sliderInputLabel.nativeElement.innerText=o+"x",this.sliderConfig.value=o};this._zoomBehaviour=dr().scaleExtent([this.sliderConfig.min,this.sliderConfig.max]).on("zoom",i),t.call(this._zoomBehaviour)}_filterNodesById(e,t){return e.filter(i=>i.id===t)[0]}_filterNodesByType(e,t){return e.filter(i=>i.type===t)}_getContainerDimensions(e){return e?.nativeElement?{width:e.nativeElement.clientWidth,height:e.nativeElement.clientHeight}:null}_nodeRadius(e){if(!e)return null;let t=8;return e.label.indexOf("_:")!==-1?t=t-1:e.instance||e.label.indexOf("inst:")!==-1?t=t+2:(e.owlClass||e.label.indexOf("inst:")!==-1)&&(t=t+1),t}_roundToNearestScaleStep(e){let t=this.sliderConfig.stepSize;return((s,o)=>+(Math.round(+(s+"e"+o))+"e-"+o))(e,(s=>Math.floor(s)===s?0:s.toString().split(".")[1].length||0)(t))}_triplesToD3GraphData(e){if(!e)return;let t=new Pe;return e.forEach(i=>{let n=this.prefixPipe.transform(i.subject,D.SHORT),s=this.prefixPipe.transform(i.predicate,D.SHORT),o=this.prefixPipe.transform(i.object,D.SHORT);isNaN(o)||(o=Number(o)%1===0?String(Number(o)):String(Number(o).toFixed(2)));let a=new he(s,Z.link);t.nodes.push(a);let l=this._filterNodesById(t.nodes,n);l==null&&(l=new he(n,Z.node),t.nodes.push(l));let u=this._filterNodesById(t.nodes,o);u==null&&(u=new he(o,Z.node),t.nodes.push(u)),l.instance===!1&&(l.instance=this._checkForRdfType(a)),u.owlClass===!1&&(u.owlClass=this._checkForRdfType(a)),t.links.push(new ve(l,a)),t.links.push(new ve(a,u)),t.nodeTriples.push(new Le(l,a,u))}),t}_updateNodePositions(e){e.attr("cx",t=>t.x).attr("cy",t=>t.y)}_updateNodeTextPositions(e){e.attr("x",t=>t.x+12).attr("y",t=>t.y+3)}_updateLinkPositions(e){e.attr("d",t=>{let i=t.nodeSubject.x,n=t.nodeSubject.y,s=t.nodeObject.x,o=t.nodeObject.y,a=0,l=a,u=a,f=0,h=0,m=1;return i===s&&n===o&&(f=-45,h=1,l=30,u=20,s=s+1,o=o+1),"M"+i+","+n+"A"+l+","+u+" "+f+","+h+","+m+" "+s+","+o})}_updateLinkTextPositions(e){e.attr("x",t=>t.nodeSubject.x===t.nodeObject.x&&t.nodeSubject.y===t.nodeObject.y?20+(t.nodeSubject.x+t.nodePredicate.x+t.nodeObject.x)/3:10+(t.nodeSubject.x+t.nodePredicate.x+t.nodeObject.x)/3).attr("y",t=>t.nodeSubject.x===t.nodeObject.x&&t.nodeSubject.y===t.nodeObject.y?-40+(t.nodeSubject.y+t.nodePredicate.y+t.nodeObject.y)/3:4+(t.nodeSubject.y+t.nodePredicate.y+t.nodeObject.y)/3)}},de.ctorParameters=()=>[{type:se},{type:X}],de.propDecorators={currentQueryResultTriples:[{type:v}],height:[{type:v}],clickedNodeRequest:[{type:N}],_graphContainer:[{type:ee,args:["graphContainer",{static:!0}]}],_sliderInput:[{type:ee,args:["sliderInput",{static:!0}]}],_sliderInputLabel:[{type:ee,args:["sliderInputLabel",{static:!0}]}],onResize:[{type:Me,args:["window:resize"]}]},de);Je=E([S({selector:"awg-force-graph",template:yi,styles:[xi]})],Je);var bi=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-select-results"
        [collapsed]="false"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader>
            <button ngbAccordionButton class="p-3">Resultat</button>
        </div>
        <div ngbAccordionCollapse>
            <div ngbAccordionBody>
                <ng-template>
                    @if (queryResult$ | async; as queryResult) {
                        @if (isQueryResultNotEmpty(queryResult)) {
                            <!-- SPARQL table visualization -->
                            <awg-sparql-table
                                [queryResult]="queryResult"
                                [queryTime]="queryTime"
                                (clickedTableRequest)="onTableNodeClick($event)">
                            </awg-sparql-table>
                        } @else {
                            <awg-sparql-no-results></awg-sparql-no-results>
                        }
                    } @else {
                        <awg-twelve-tone-spinner></awg-twelve-tone-spinner>
                    }
                </ng-template>
            </div>
        </div>
    </div>
</div>
`;var wi="";var ge,Ye=(ge=class{constructor(e){this.utils=e,this.clickedTableRequest=new F}isAccordionItemDisabled(){return this.isFullscreen}isQueryResultNotEmpty(e){let{head:t,body:i}=e;return this.utils.isNotEmptyArray(t?.vars)&&this.utils.isNotEmptyArray(i?.bindings)}onTableNodeClick(e){e&&this.clickedTableRequest.emit(e)}},ge.ctorParameters=()=>[{type:Ge}],ge.propDecorators={queryResult$:[{type:v}],queryTime:[{type:v}],isFullscreen:[{type:v}],clickedTableRequest:[{type:N}]},ge);Ye=E([S({selector:"awg-select-results",template:bi,changeDetection:T.OnPush,styles:[wi]})],Ye);var Ei=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-sparql-query"
        [collapsed]="isAccordionItemCollapsed()"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader class="accordion-button custom-header justify-content-between">
            <button ngbAccordionToggle class="btn btn-link m-0 p-0">SPARQL</button>
            <!-- View Handle -->
            @if (!isFullscreen) {
                <awg-view-handle-button-group
                    [viewHandles]="viewHandles"
                    [selectedViewType]="selectedViewType"
                    (viewChangeRequest)="onViewChange($event)"></awg-view-handle-button-group>
            }

            <!-- Example Query Handle -->
            @if (isExampleQueriesEnabled()) {
                <div class="p-0 btn-group awg-example-query-btn-group" style="padding: -3rem">
                    <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">
                        Beispielabfragen
                    </button>
                    <div
                        class="btn-group"
                        ngbDropdown
                        container="body"
                        placement="bottom-right"
                        role="group"
                        aria-label="Button group with nested dropdown for sample queries">
                        <button class="btn btn-sm btn-info" ngbDropdownToggle></button>
                        <div ngbDropdownMenu>
                            <h6 class="dropdown-header">Graph-Ansicht (CONSTRUCT)</h6>
                            @for (q of queryList; track q) {
                                @if (q.queryType === 'construct') {
                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">
                                        <span>{{ q.queryLabel }}</span>
                                    </a>
                                }
                            }
                            <div class="dropdown-divider"></div>
                            <h6 class="dropdown-header">Tabellen-Ansicht (SELECT)</h6>
                            @for (q of queryList; track q) {
                                @if (q.queryType === 'select') {
                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">
                                        <span>{{ q.queryLabel }}</span>
                                    </a>
                                }
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
        <div ngbAccordionCollapse [style.height]="isFullscreen ? '50vh' : 'auto'">
            <div ngbAccordionBody>
                <ng-template>
                    <!-- CodeMirror editor instance -->
                    <awg-codemirror
                        ngDefaultControl
                        [mode]="cmSparqlMode"
                        [(content)]="query.queryString"
                        (contentChange)="onEditorInputChange($event)"></awg-codemirror>

                    <!-- Handle buttons -->
                    <div fxLayout="row" class="mt-2 awg-graph-visualizer-sparql-query-handle-buttons">
                        <button class="btn btn-outline-info" (click)="performQuery()">Query</button>
                        <button class="btn btn-warning" (click)="resetQuery(query)">Reset</button>
                        <button class="btn btn-danger" (click)="onEditorInputChange('')">Clear</button>
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>
`;var vi=`.custom-header:after{content:none}.custom-header.accordion-button{padding:.8rem!important}.custom-header.accordion-button>#awg-graph-visualizer-sparql-query-toggle{text-decoration:none}
`;var K;function Ci(r){return new RegExp("^(?:"+r.join("|")+")$","i")}var es=Ci(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","iri","uri","bnode","count","sum","min","max","avg","sample","group_concat","rand","abs","ceil","floor","round","concat","substr","strlen","replace","ucase","lcase","encode_for_uri","contains","strstarts","strends","strbefore","strafter","year","month","day","hours","minutes","seconds","timezone","tz","now","uuid","struuid","md5","sha1","sha256","sha384","sha512","coalesce","if","strlang","strdt","isnumeric","regex","exists","isblank","isliteral","a","bind"]),ts=Ci(["base","prefix","select","distinct","reduced","construct","describe","ask","from","named","where","order","limit","offset","filter","optional","graph","by","asc","desc","as","having","undef","values","group","minus","in","not","service","silent","using","insert","delete","union","true","false","with","data","copy","to","move","add","create","drop","clear","load","into"]),rs=/[*+\-<>=&|\^\/!\?]/,Ri="[A-Za-z_\\-0-9]",is=new RegExp("[A-Za-z]"),ns=new RegExp("(("+Ri+"|\\.)*("+Ri+"))?:");function Ii(r,e){var t=r.next();if(K=null,t=="$"||t=="?")return t=="?"&&r.match(/\s/,!1)?"operator":(r.match(/^[A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][A-Za-z0-9_\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]*/),"variableName.local");if(t=="<"&&!r.match(/^[\s\u00a0=]/,!1))return r.match(/^[^\s\u00a0>]*>?/),"atom";if(t=='"'||t=="'")return e.tokenize=ss(t),e.tokenize(r,e);if(/[{}\(\),\.;\[\]]/.test(t))return K=t,"bracket";if(t=="#")return r.skipToEnd(),"comment";if(rs.test(t))return"operator";if(t==":")return Si(r),"atom";if(t=="@")return r.eatWhile(/[a-z\d\-]/i),"meta";if(is.test(t)&&r.match(ns))return Si(r),"atom";r.eatWhile(/[_\w\d]/);var i=r.current();return es.test(i)?"builtin":ts.test(i)?"keyword":"variable"}function Si(r){r.match(/(\.(?=[\w_\-\\%])|[:\w_-]|\\[-\\_~.!$&'()*+,;=/?#@%]|%[a-f\d][a-f\d])+/i)}function ss(r){return function(e,t){for(var i=!1,n;(n=e.next())!=null;){if(n==r&&!i){t.tokenize=Ii;break}i=!i&&n=="\\"}return"string"}}function et(r,e,t){r.context={prev:r.context,indent:r.indent,col:t,type:e}}function tt(r){r.indent=r.context.indent,r.context=r.context.prev}var Ti={name:"sparql",startState:function(){return{tokenize:Ii,context:null,indent:0,col:0}},token:function(r,e){if(r.sol()&&(e.context&&e.context.align==null&&(e.context.align=!1),e.indent=r.indentation()),r.eatSpace())return null;var t=e.tokenize(r,e);if(t!="comment"&&e.context&&e.context.align==null&&e.context.type!="pattern"&&(e.context.align=!0),K=="(")et(e,")",r.column());else if(K=="[")et(e,"]",r.column());else if(K=="{")et(e,"}",r.column());else if(/[\]\}\)]/.test(K)){for(;e.context&&e.context.type=="pattern";)tt(e);e.context&&K==e.context.type&&(tt(e),K=="}"&&e.context&&e.context.type=="pattern"&&tt(e))}else K=="."&&e.context&&e.context.type=="pattern"?tt(e):/atom|string|variable/.test(t)&&e.context&&(/[\}\]]/.test(e.context.type)?et(e,"pattern",r.column()):e.context.type=="pattern"&&!e.context.align&&(e.context.align=!0,e.context.col=r.column()));return t},indent:function(r,e,t){var i=e&&e.charAt(0),n=r.context;if(/[\]\}]/.test(i))for(;n&&n.type=="pattern";)n=n.prev;var s=n&&i==n.type;return n?n.type=="pattern"?n.col:n.align?n.col+(s?0:1):n.indent+(s?0:t.unit):0},languageData:{commentTokens:{line:"#"}}};var Ce,rt=(Ce=class{constructor(){this.errorMessageRequest=new F,this.performQueryRequest=new F,this.resetQueryRequest=new F,this.updateQueryStringRequest=new F,this.cmSparqlMode=Ti,this.faDiagramProject=pt,this.faTable=ft,this.selectedViewType=U.GRAPH,this.viewHandles=[new dt("Graph view",U.GRAPH,pt),new dt("Table view",U.TABLE,ft)]}ngOnInit(){this.setViewType()}ngOnChanges(e){e.query&&!e.query.isFirstChange()&&this.setViewType()}setViewType(){let e={construct:U.GRAPH,select:U.TABLE};this.selectedViewType=e[this.query?.queryType]||U.GRAPH}onViewChange(e){this.switchQueryType(e),this.onEditorInputChange(this.query.queryString),this.performQuery()}switchQueryType(e){switch(e){case U.TABLE:{this.query.queryType==="construct"&&this.query.queryString.includes("CONSTRUCT")&&(this.query.queryString=this.query.queryString.replace("CONSTRUCT","SELECT *"),this.query.queryType="select");break}case U.GRAPH:{this.query.queryType==="select"&&this.query.queryString.includes("SELECT")&&(this.query.queryString=this.query.queryString.replace(/SELECT.*\n/,`CONSTRUCT
`),this.query.queryType="construct");break}case U.GRID:break;default:{let t=e;throw new Error(`The view must be ${U.GRAPH} or ${U.TABLE}, but was: ${t}.`)}}}isExampleQueriesEnabled(){return!!(this.query?.queryType&&this.query?.queryLabel&&this.query?.queryString&&this.queryList)}onEditorInputChange(e){this.updateQueryStringRequest.emit(e)}onQueryListChange(e){e&&this.queryList&&(e=this.queryList.find(t=>e.queryLabel===t.queryLabel&&e.queryType===t.queryType)||this.queryList[0],this.resetQuery(e))}performQuery(){this.query.queryString?this.performQueryRequest.emit():this.errorMessageRequest.emit(new ae("Empty query","Please enter a SPARQL query."))}resetQuery(e){e&&this.resetQueryRequest.emit(e)}isAccordionItemCollapsed(){return!this.isFullscreen}isAccordionItemDisabled(){return this.isFullscreen}},Ce.propDecorators={queryList:[{type:v}],query:[{type:v}],isFullscreen:[{type:v}],errorMessageRequest:[{type:N}],performQueryRequest:[{type:N}],resetQueryRequest:[{type:N}],updateQueryStringRequest:[{type:N}]},Ce);rt=E([S({selector:"awg-sparql-editor",template:Ei,changeDetection:T.OnPush,styles:[vi]})],rt);var Fi=`<div class="text-center">
    <p>Entschuldigung, Ihre SPARQL-Anfrage f\xFChrte leider zu keinem Ergebnis.</p>
    <p>M\xF6glicherweise k\xF6nnen Sie Ihre Anfrage anpassen.</p>
    <p>
        Ausf\xFChrliche Informationen zu SPARQL finden Sie unter:
        <a href="{{ logos?.['sparql'].href }}">{{ logos?.['sparql'].href }}</a
        >.
    </p>
    <p>
        <a href="{{ logos?.['sparql'].href }}">
            <img width="33%" src="{{ logos?.['sparql'].src }}" alt="{{ logos?.['sparql'].alt }}" />
        </a>
    </p>
</div>
`;var Ni="";var Ie,it=(Ie=class{constructor(e){this.coreService=e}ngOnInit(){this.provideMetaData()}provideMetaData(){this.logos=this.coreService.getLogos()}},Ie.ctorParameters=()=>[{type:ir}],Ie);it=E([S({selector:"awg-sparql-no-results",template:Fi,changeDetection:T.OnPush,styles:[Ni]})],it);var Ai=`@if (queryResult) {
    <awg-table
        [tableTitle]="'SELECT Anfrage'"
        [headerInputData]="queryResult.head.vars"
        [rowInputData]="queryResult.body.bindings"
        (clickedTableValueRequest)="onTableNodeClick($event)"
        (clickedTableRowRequest)="(undefined)"></awg-table>
}
`;var ki=`ngb-highlight ::ng-deep .ngb-highlight{font-weight:700;background:#ff0}
`;var Te,nt=(Te=class{constructor(){this.clickedTableRequest=new F}onTableNodeClick(e){e&&this.clickedTableRequest.emit(e)}},Te.propDecorators={queryResult:[{type:v}],queryTime:[{type:v}],clickedTableRequest:[{type:N}]},Te);nt=E([S({selector:"awg-sparql-table",template:Ai,changeDetection:T.OnPush,styles:[ki]})],nt);var qi=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-triples"
        [collapsed]="isAccordionItemCollapsed()"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader>
            <button ngbAccordionButton class="p-3">RDF Triples</button>
        </div>
        <div ngbAccordionCollapse [style.height]="isFullscreen ? '50vh' : 'auto'">
            <div ngbAccordionBody>
                <ng-template>
                    <!-- CodeMirror editor instance -->
                    <awg-codemirror
                        ngDefaultControl
                        [mode]="cmTurtleMode"
                        [(content)]="triples"
                        (contentChange)="onEditorInputChange($event)"></awg-codemirror>

                    <!-- Handle buttons -->
                    <div fxLayout="row" class="awg-graph-visualizer-triples-handle-buttons mt-2">
                        <button class="btn btn-outline-info" (click)="performQuery()">Query</button>
                        <button class="btn btn-warning" (click)="resetTriples()">Reset</button>
                        <button class="btn btn-danger" (click)="onEditorInputChange('')">Clear</button>
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>
`;var Di="";var oe;function Li(r){return new RegExp("^(?:"+r.join("|")+")$","i")}var fs=Li([]),Bi=Li(["@prefix","@base","a"]),Pi=/[*+\-<>=&|]/;function Oi(r,e){var t=r.next();if(oe=null,t=="<"&&!r.match(/^[\s\u00a0=]/,!1))return r.match(/^[^\s\u00a0>]*>?/),"atom";if(t=='"'||t=="'")return e.tokenize=ps(t),e.tokenize(r,e);if(/[{}\(\),\.;\[\]]/.test(t))return oe=t,null;if(t=="#")return r.skipToEnd(),"comment";if(Pi.test(t))return r.eatWhile(Pi),null;if(t==":")return"operator";if(r.eatWhile(/[_\w\d]/),r.peek()==":")return"variableName.special";var i=r.current();return Bi.test(i)?"meta":t>="A"&&t<="Z"?"comment":"keyword";var i=r.current();return fs.test(i)?null:Bi.test(i)?"meta":"variable"}function ps(r){return function(e,t){for(var i=!1,n;(n=e.next())!=null;){if(n==r&&!i){t.tokenize=Oi;break}i=!i&&n=="\\"}return"string"}}function st(r,e,t){r.context={prev:r.context,indent:r.indent,col:t,type:e}}function Ot(r){r.indent=r.context.indent,r.context=r.context.prev}var ji={name:"turtle",startState:function(){return{tokenize:Oi,context:null,indent:0,col:0}},token:function(r,e){if(r.sol()&&(e.context&&e.context.align==null&&(e.context.align=!1),e.indent=r.indentation()),r.eatSpace())return null;var t=e.tokenize(r,e);if(t!="comment"&&e.context&&e.context.align==null&&e.context.type!="pattern"&&(e.context.align=!0),oe=="(")st(e,")",r.column());else if(oe=="[")st(e,"]",r.column());else if(oe=="{")st(e,"}",r.column());else if(/[\]\}\)]/.test(oe)){for(;e.context&&e.context.type=="pattern";)Ot(e);e.context&&oe==e.context.type&&Ot(e)}else oe=="."&&e.context&&e.context.type=="pattern"?Ot(e):/atom|string|variable/.test(t)&&e.context&&(/[\}\]]/.test(e.context.type)?st(e,"pattern",r.column()):e.context.type=="pattern"&&!e.context.align&&(e.context.align=!0,e.context.col=r.column()));return t},indent:function(r,e,t){var i=e&&e.charAt(0),n=r.context;if(/[\]\}]/.test(i))for(;n&&n.type=="pattern";)n=n.prev;var s=n&&i==n.type;return n?n.type=="pattern"?n.col:n.align?n.col+(s?0:1):n.indent+(s?0:t.unit):0},languageData:{commentTokens:{line:"#"}}};var Fe,ot=(Fe=class{constructor(){this.errorMessageRequest=new F,this.performQueryRequest=new F,this.resetTriplesRequest=new F,this.updateTriplesRequest=new F,this.cmTurtleMode=ji}onEditorInputChange(e){this.updateTriplesRequest.emit(e)}performQuery(){this.triples?this.performQueryRequest.emit():this.errorMessageRequest.emit(new ae("Empty triples","Please enter triple content."))}resetTriples(){this.resetTriplesRequest.emit()}isAccordionItemCollapsed(){return!this.isFullscreen}isAccordionItemDisabled(){return this.isFullscreen}},Fe.propDecorators={triples:[{type:v}],isFullscreen:[{type:v}],errorMessageRequest:[{type:N}],performQueryRequest:[{type:N}],resetTriplesRequest:[{type:N}],updateTriplesRequest:[{type:N}]},Fe);ot=E([S({selector:"awg-triples-editor",template:qi,changeDetection:T.OnPush,styles:[Di]})],ot);var Ui=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-unsupported-query-type-result"
        [collapsed]="false"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader>
            <button ngbAccordionButton>Resultat</button>
        </div>
        <div ngbAccordionCollapse>
            <div ngbAccordionBody>
                <p class="text-center">
                    Sorry, but the requested SPARQL query type <code>{{ queryType | uppercase }}</code> is not supported
                    yet.
                </p>
                <p class="text-center">Please try a <code>CONSTRUCT</code> or <code>SELECT</code> query instead.</p>
            </div>
        </div>
    </div>
</div>
`;var Mi="";var Ne,at=(Ne=class{isAccordionItemDisabled(){return this.isFullscreen}},Ne.propDecorators={queryType:[{type:v}],isFullscreen:[{type:v}]},Ne);at=E([S({selector:"awg-unsupported-type-results",template:Ui,changeDetection:T.OnPush,styles:[Mi]})],at);var ut=class{};ut=E([me({imports:[ze],declarations:[Xe,Je,pe,X,Ye,rt,it,nt,ot,at],exports:[pe],providers:[se,X]})],ut);var zi=`<!-- content: edition graph -->
<div>
    <!-- modal -->
    <awg-modal #modal></awg-modal>

    <!-- graph -->
    @if (editionGraphData$ | async; as editionGraphData) {
        <div class="awg-graph-view p-5 border rounded-3">
            @for (graph of editionGraphData.graph; track graph.id) {
                <div>
                    <!-- graph description -->
                    <div class="awg-graph-description">
                        <p>
                            So weit vorhanden, pr\xE4sentiert die vorliegende Ansicht Graph-Visualisierungen des
                            ausgew\xE4hlten Editionsbereichs: Der <em>statische Graph</em> vermittelt dabei einen von den
                            jeweiligen Editoren fixierten \xDCberblick editionsrelevanter Zusammenh\xE4nge und Abh\xE4ngigkeiten,
                            der <em>dynamische Graph</em> bietet zus\xE4tzlich einen interaktiven Zugang zu dem
                            zugrundeliegenden Datenbestand.
                            <span class="text-danger"
                                >Diese Funktionalit\xE4t ist noch nicht f\xFCr alle Skizzenbestandteile verf\xFCgbar, wird aber
                                sukzessive erg\xE4nzt.</span
                            >
                        </p>
                        @if (utils.isNotEmptyArray(graph.description) || graph.rdfData?.triples) {
                            @for (description of graph.description; track $index) {
                                <p [compile-html]="description" [compile-html-ref]="ref"></p>
                            }
                        } @else {
                            <p class="awg-graph-description-empty">
                                <small class="text-muted"
                                    >[Die Graph-Visualisierungen zum Editionskomplex
                                    <span [innerHTML]="editionComplex.complexId.full"></span> erscheinen im Zusammenhang
                                    der vollsta\u0308ndigen Edition von
                                    <span [innerHTML]="editionComplex.complexId.short"></span> in
                                    {{ editionRouteConstants.EDITION.short }} {{ editionComplex.series.short }}/{{
                                        editionComplex.section.short
                                    }}.]
                                </small>
                            </p>
                        }
                    </div>
                    <!-- dynamic graph -->
                    @if (graph.rdfData && graph.rdfData.triples && graph.rdfData.queryList) {
                        <div class="awg-graph-dynamic">
                            <h4>
                                Dynamischer Graph
                                <button
                                    type="button"
                                    class="btn btn-sm btn-outline-info ms-2"
                                    (click)="modal.open('HINT_EDITION_GRAPH')">
                                    Hinweise zur Nutzung
                                </button>
                                @if (!isFullscreen) {
                                    <button
                                        type="button"
                                        title="Open fullscreen"
                                        class="btn btn-sm btn-outline-info ms-2"
                                        (click)="openFullscreen()">
                                        <fa-icon [icon]="faExpand"></fa-icon>
                                    </button>
                                }
                                @if (isFullscreen) {
                                    <button
                                        type="button"
                                        title="Close fullscreen"
                                        class="btn btn-sm btn-info ms-2"
                                        (click)="closeFullscreen()">
                                        <fa-icon [icon]="faCompress"></fa-icon>
                                    </button>
                                }
                            </h4>
                            <p>
                                Diese interaktive Visualisierung basiert auf Mads Holten's
                                <a href="https://github.com/MadsHolten/sparql-visualizer">SPARQL Visualizer</a>. Sie
                                modelliert den aktuellen Skizzenkomplex in Form eines
                                <a href="https://www.w3.org/RDF/">RDF</a>-Graphen. Die zugrundeliegenden RDF-Daten sind
                                unter dem Punkt <em>RDF Triples</em> einsehbar und lokal editierbar. Eine Filterung und
                                Eingrenzung dieser RDF-Daten kann mithilfe der Abfragesprache
                                <a href="https://www.w3.org/TR/sparql11-query/">SPARQL</a>
                                unter dem Punkt <em>SPARQL Abfrage</em> vorgenommen werden; in der Voreinstellung werden
                                hierbei alle vorhandenen Triples abgefragt.
                            </p>
                            <awg-graph-visualizer
                                [graphRDFInputData]="graph.rdfData"
                                [isFullscreen]="isFullscreen"></awg-graph-visualizer>
                        </div>
                    }
                    <!-- static image -->
                    @if (graph.staticImage && graph.staticImage !== '') {
                        <div class="awg-graph-static mt-3">
                            <h4>Statischer Graph</h4>
                            <div [compile-html]="graph.staticImage" [compile-html-ref]="ref"></div>
                        </div>
                    }
                </div>
            }
        </div>
    } @else {
        @if (errorObject) {
            <div class="errorMessage">
                <div class="col-12 text-center">
                    <div class="alert alert-danger">{{ errorObject | json }}</div>
                </div>
            </div>
        }
    }

    <!-- error message -->
    <ng-template #error>
        @if (errorObject) {
            <div class="errorMessage">
                <div class="col-12 text-center">
                    <div class="alert alert-danger">{{ errorObject | json }}</div>
                </div>
            </div>
        }
    </ng-template>
</div>
`;var Gi="";var _e,Oe=(_e=class{constructor(e,t,i,n){this.editionDataService=e,this.editionService=t,this.document=i,this.utils=n,this.isFullscreen=!1,this.faExpand=er,this.faCompress=Jt,this.GRAPH_IMAGES={OP12:"",OP25:sr.GRAPH_IMAGE_OP25.route},this.errorObject=null,this.ref=this}get editionRouteConstants(){return nr}onKeydownHandler(e){!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(this.isFullscreen=!1)}ngOnInit(){this.getEditionGraphData()}getEditionGraphData(){this.editionGraphData$=this.editionService.getEditionComplex().pipe(Qt(e=>(this.editionComplex=e,this.editionDataService.getEditionGraphData(this.editionComplex))),Gt(e=>(this.errorObject=e,Ue)))}openFullscreen(){let e=this.child.fs.nativeElement;this.isFullscreen=!0,!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}closeFullscreen(){this.document.exitFullscreen?this.document.exitFullscreen():this.document.mozCancelFullScreen?this.document.mozCancelFullScreen():this.document.webkitExitFullscreen?this.document.webkitExitFullscreen():this.document.msExitFullscreen&&this.document.msExitFullscreen(),this.isFullscreen=!1}},_e.ctorParameters=()=>[{type:or},{type:lr},{type:void 0,decorators:[{type:Vt,args:[Kt]}]},{type:Ge}],_e.propDecorators={child:[{type:ee,args:[pe]}],isFullscreen:[{type:Xt,args:["class.is-fullscreen"]}],onKeydownHandler:[{type:Me,args:["document:fullscreenchange",["$event"]]}]},_e);Oe=E([S({selector:"awg-edition-graph",template:zi,changeDetection:T.OnPush,styles:[Gi]})],Oe);var ys=[{path:"",component:Oe,data:{title:"AWG Online Edition \u2013 Graph"}}],$i=[Oe],lt=class{};lt=E([me({imports:[ht.forChild(ys)],exports:[ht]})],lt);var Qi=class{};Qi=E([me({imports:[ze,ut,lt],declarations:[$i]})],Qi);export{Qi as EditionGraphModule};
