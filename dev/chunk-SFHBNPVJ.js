import{a as U,b as _t}from"./chunk-MSTPLEVO.js";import{a as fr,b as pr,c as dr,d as gr,e as mr}from"./chunk-N6VY3MBS.js";import{f as Qe,s as sr}from"./chunk-Z7SDOEPW.js";import"./chunk-U7YSZX7D.js";import{b as or,l as ar,m as ur,p as lr,w as cr,y as hr}from"./chunk-YFDU6MHV.js";import{A as Vt,B as Zt,Ca as E,F as Wt,I as F,L as Xt,N as T,Ra as dt,S as re,T as S,U as Jt,V as v,W as N,Wa as gt,X as Kt,Xa as er,Y as Ge,Ya as tr,Z as _e,a as Mt,d as Me,e as zt,f as Gt,h as pt,hb as mt,k as ze,kb as rr,l as $t,ma as Yt,ob as oe,pb as ir,qb as nr,rb as $e,t as Qt,u as Ht}from"./chunk-QGPQRYE7.js";var wr=Me(He=>{"use strict";He.byteLength=tn;He.toByteArray=nn;He.fromByteArray=an;var $=[],M=[],en=typeof Uint8Array<"u"?Uint8Array:Array,xt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(ae=0,yr=xt.length;ae<yr;++ae)$[ae]=xt[ae],M[xt.charCodeAt(ae)]=ae;var ae,yr;M[45]=62;M[95]=63;function br(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function tn(r){var e=br(r),t=e[0],i=e[1];return(t+i)*3/4-i}function rn(r,e,t){return(e+t)*3/4-t}function nn(r){var e,t=br(r),i=t[0],n=t[1],s=new en(rn(r,i,n)),o=0,a=n>0?i-4:i,u;for(u=0;u<a;u+=4)e=M[r.charCodeAt(u)]<<18|M[r.charCodeAt(u+1)]<<12|M[r.charCodeAt(u+2)]<<6|M[r.charCodeAt(u+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=M[r.charCodeAt(u)]<<2|M[r.charCodeAt(u+1)]>>4,s[o++]=e&255),n===1&&(e=M[r.charCodeAt(u)]<<10|M[r.charCodeAt(u+1)]<<4|M[r.charCodeAt(u+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function sn(r){return $[r>>18&63]+$[r>>12&63]+$[r>>6&63]+$[r&63]}function on(r,e,t){for(var i,n=[],s=e;s<t;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(sn(i));return n.join("")}function an(r){for(var e,t=r.length,i=t%3,n=[],s=16383,o=0,a=t-i;o<a;o+=s)n.push(on(r,o,o+s>a?a:o+s));return i===1?(e=r[t-1],n.push($[e>>2]+$[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push($[e>>10]+$[e>>4&63]+$[e<<2&63]+"=")),n.join("")}});var Er=Me(yt=>{yt.read=function(r,e,t,i,n){var s,o,a=n*8-i-1,u=(1<<a)-1,l=u>>1,f=-7,h=t?n-1:0,_=t?-1:1,g=r[e+h];for(h+=_,s=g&(1<<-f)-1,g>>=-f,f+=a;f>0;s=s*256+r[e+h],h+=_,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=i;f>0;o=o*256+r[e+h],h+=_,f-=8);if(s===0)s=1-l;else{if(s===u)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-l}return(g?-1:1)*o*Math.pow(2,s-i)};yt.write=function(r,e,t,i,n,s){var o,a,u,l=s*8-n-1,f=(1<<l)-1,h=f>>1,_=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:s-1,m=i?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+h>=1?e+=_/u:e+=_*Math.pow(2,1-h),e*u>=2&&(o++,u/=2),o+h>=f?(a=0,o=f):o+h>=1?(a=(e*u-1)*Math.pow(2,n),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;r[t+g]=a&255,g+=m,a/=256,n-=8);for(o=o<<n|a,l+=n;l>0;r[t+g]=o&255,g+=m,o/=256,l-=8);r[t+g-m]|=p*128}});var jr=Me(we=>{"use strict";var bt=wr(),ye=Er(),vr=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;we.Buffer=c;we.SlowBuffer=pn;we.INSPECT_MAX_BYTES=50;var Ve=2147483647;we.kMaxLength=Ve;c.TYPED_ARRAY_SUPPORT=un();!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function un(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}});Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function Z(r){if(r>Ve)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,c.prototype),e}function c(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Rt(r)}return Ir(r,e,t)}c.poolSize=8192;function Ir(r,e,t){if(typeof r=="string")return cn(r,e);if(ArrayBuffer.isView(r))return hn(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(Q(r,ArrayBuffer)||r&&Q(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Q(r,SharedArrayBuffer)||r&&Q(r.buffer,SharedArrayBuffer)))return Et(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return c.from(i,e,t);let n=fn(r);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return c.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}c.from=function(r,e,t){return Ir(r,e,t)};Object.setPrototypeOf(c.prototype,Uint8Array.prototype);Object.setPrototypeOf(c,Uint8Array);function Fr(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function ln(r,e,t){return Fr(r),r<=0?Z(r):e!==void 0?typeof t=="string"?Z(r).fill(e,t):Z(r).fill(e):Z(r)}c.alloc=function(r,e,t){return ln(r,e,t)};function Rt(r){return Fr(r),Z(r<0?0:St(r)|0)}c.allocUnsafe=function(r){return Rt(r)};c.allocUnsafeSlow=function(r){return Rt(r)};function cn(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=Tr(r,e)|0,i=Z(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function wt(r){let e=r.length<0?0:St(r.length)|0,t=Z(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function hn(r){if(Q(r,Uint8Array)){let e=new Uint8Array(r);return Et(e.buffer,e.byteOffset,e.byteLength)}return wt(r)}function Et(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,c.prototype),i}function fn(r){if(c.isBuffer(r)){let e=St(r.length)|0,t=Z(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||It(r.length)?Z(0):wt(r);if(r.type==="Buffer"&&Array.isArray(r.data))return wt(r.data)}function St(r){if(r>=Ve)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ve.toString(16)+" bytes");return r|0}function pn(r){return+r!=r&&(r=0),c.alloc(+r)}c.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==c.prototype};c.compare=function(e,t){if(Q(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),Q(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return c.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=c.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){let o=e[i];if(Q(o,Uint8Array))s+o.length>n.length?(c.isBuffer(o)||(o=c.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(c.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function Tr(r,e){if(c.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||Q(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return vt(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Or(r).length;default:if(n)return i?-1:vt(r).length;e=(""+e).toLowerCase(),n=!0}}c.byteLength=Tr;function dn(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return Rn(this,e,t);case"utf8":case"utf-8":return Ar(this,e,t);case"ascii":return En(this,e,t);case"latin1":case"binary":return vn(this,e,t);case"base64":return bn(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Sn(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}c.prototype._isBuffer=!0;function ue(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}c.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)ue(this,t,t+1);return this};c.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)ue(this,t,t+3),ue(this,t+1,t+2);return this};c.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)ue(this,t,t+7),ue(this,t+1,t+6),ue(this,t+2,t+5),ue(this,t+3,t+4);return this};c.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Ar(this,0,e):dn.apply(this,arguments)};c.prototype.toLocaleString=c.prototype.toString;c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:c.compare(this,e)===0};c.prototype.inspect=function(){let e="",t=we.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};vr&&(c.prototype[vr]=c.prototype.inspect);c.prototype.compare=function(e,t,i,n,s){if(Q(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-t,u=Math.min(o,a),l=this.slice(n,s),f=e.slice(t,i);for(let h=0;h<u;++h)if(l[h]!==f[h]){o=l[h],a=f[h];break}return o<a?-1:a<o?1:0};function Nr(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,It(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=c.from(e,i)),c.isBuffer(e))return e.length===0?-1:Rr(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Rr(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function Rr(r,e,t,i,n){let s=1,o=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function u(f,h){return s===1?f[h]:f.readUInt16BE(h*s)}let l;if(n){let f=-1;for(l=t;l<o;l++)if(u(r,l)===u(e,f===-1?0:l-f)){if(f===-1&&(f=l),l-f+1===a)return f*s}else f!==-1&&(l-=l-f),f=-1}else for(t+a>o&&(t=o-a),l=t;l>=0;l--){let f=!0;for(let h=0;h<a;h++)if(u(r,l+h)!==u(e,h)){f=!1;break}if(f)return l}return-1}c.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};c.prototype.indexOf=function(e,t,i){return Nr(this,e,t,i,!0)};c.prototype.lastIndexOf=function(e,t,i){return Nr(this,e,t,i,!1)};function gn(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(It(a))return o;r[t+o]=a}return o}function mn(r,e,t,i){return Ze(vt(e,r.length-t),r,t,i)}function _n(r,e,t,i){return Ze(Tn(e),r,t,i)}function xn(r,e,t,i){return Ze(Or(e),r,t,i)}function yn(r,e,t,i){return Ze(Nn(e,r.length-t),r,t,i)}c.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return gn(this,e,t,i);case"utf8":case"utf-8":return mn(this,e,t,i);case"ascii":case"latin1":case"binary":return _n(this,e,t,i);case"base64":return xn(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yn(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function bn(r,e,t){return e===0&&t===r.length?bt.fromByteArray(r):bt.fromByteArray(r.slice(e,t))}function Ar(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let s=r[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){let u,l,f,h;switch(a){case 1:s<128&&(o=s);break;case 2:u=r[n+1],(u&192)===128&&(h=(s&31)<<6|u&63,h>127&&(o=h));break;case 3:u=r[n+1],l=r[n+2],(u&192)===128&&(l&192)===128&&(h=(s&15)<<12|(u&63)<<6|l&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:u=r[n+1],l=r[n+2],f=r[n+3],(u&192)===128&&(l&192)===128&&(f&192)===128&&(h=(s&15)<<18|(u&63)<<12|(l&63)<<6|f&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return wn(i)}var Sr=4096;function wn(r){let e=r.length;if(e<=Sr)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=Sr));return t}function En(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function vn(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function Rn(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let s=e;s<t;++s)n+=An[r[s]];return n}function Sn(r,e,t){let i=r.slice(e,t),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}c.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n};function A(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||A(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return n};c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||A(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n};c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e=e>>>0,t||A(e,1,this.length),this[e]};c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||A(e,2,this.length),this[e]|this[e+1]<<8};c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||A(e,2,this.length),this[e]<<8|this[e+1]};c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||A(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};c.prototype.readBigUInt64LE=ie(function(e){e=e>>>0,be(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Ae(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});c.prototype.readBigUInt64BE=ie(function(e){e=e>>>0,be(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Ae(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});c.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||A(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};c.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||A(e,t,this.length);let n=t,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};c.prototype.readInt8=function(e,t){return e=e>>>0,t||A(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};c.prototype.readInt16LE=function(e,t){e=e>>>0,t||A(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};c.prototype.readInt16BE=function(e,t){e=e>>>0,t||A(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};c.prototype.readInt32LE=function(e,t){return e=e>>>0,t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};c.prototype.readInt32BE=function(e,t){return e=e>>>0,t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};c.prototype.readBigInt64LE=ie(function(e){e=e>>>0,be(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Ae(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});c.prototype.readBigInt64BE=ie(function(e){e=e>>>0,be(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Ae(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});c.prototype.readFloatLE=function(e,t){return e=e>>>0,t||A(e,4,this.length),ye.read(this,e,!0,23,4)};c.prototype.readFloatBE=function(e,t){return e=e>>>0,t||A(e,4,this.length),ye.read(this,e,!1,23,4)};c.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||A(e,8,this.length),ye.read(this,e,!0,52,8)};c.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||A(e,8,this.length),ye.read(this,e,!1,52,8)};function L(r,e,t,i,n,s){if(!c.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;L(this,e,t,i,a,0)}let s=1,o=0;for(this[t]=e&255;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i};c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;L(this,e,t,i,a,0)}let s=i-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i};c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,1,255,0),this[t]=e&255,t+1};c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function kr(r,e,t,i,n){Lr(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,t}function Dr(r,e,t,i,n){Lr(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=o,o=o>>8,r[t+2]=o,o=o>>8,r[t+1]=o,o=o>>8,r[t]=o,t+8}c.prototype.writeBigUInt64LE=ie(function(e,t=0){return kr(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});c.prototype.writeBigUInt64BE=ie(function(e,t=0){return Dr(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});c.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let u=Math.pow(2,8*i-1);L(this,e,t,i,u-1,-u)}let s=0,o=1,a=0;for(this[t]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[t+s-1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};c.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let u=Math.pow(2,8*i-1);L(this,e,t,i,u-1,-u)}let s=i-1,o=1,a=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[t+s+1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};c.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};c.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};c.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};c.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};c.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};c.prototype.writeBigInt64LE=ie(function(e,t=0){return kr(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});c.prototype.writeBigInt64BE=ie(function(e,t=0){return Dr(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Br(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function qr(r,e,t,i,n){return e=+e,t=t>>>0,n||Br(r,e,t,4,34028234663852886e22,-34028234663852886e22),ye.write(r,e,t,i,23,4),t+4}c.prototype.writeFloatLE=function(e,t,i){return qr(this,e,t,!0,i)};c.prototype.writeFloatBE=function(e,t,i){return qr(this,e,t,!1,i)};function Pr(r,e,t,i,n){return e=+e,t=t>>>0,n||Br(r,e,t,8,17976931348623157e292,-17976931348623157e292),ye.write(r,e,t,i,52,8),t+8}c.prototype.writeDoubleLE=function(e,t,i){return Pr(this,e,t,!0,i)};c.prototype.writeDoubleBE=function(e,t,i){return Pr(this,e,t,!1,i)};c.prototype.copy=function(e,t,i,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};c.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{let o=c.isBuffer(e)?e:c.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var xe={};function Ct(r,e,t){xe[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}Ct("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Ct("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);Ct("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=Cr(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=Cr(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function Cr(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function Cn(r,e,t){be(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&Ae(e,r.length-(t+1))}function Lr(r,e,t,i,n,s){if(r>t||r<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${t}${o}`,new xe.ERR_OUT_OF_RANGE("value",a,r)}Cn(i,n,s)}function be(r,e){if(typeof r!="number")throw new xe.ERR_INVALID_ARG_TYPE(e,"number",r)}function Ae(r,e,t){throw Math.floor(r)!==r?(be(r,t),new xe.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new xe.ERR_BUFFER_OUT_OF_BOUNDS:new xe.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var In=/[^+/0-9A-Za-z-_]/g;function Fn(r){if(r=r.split("=")[0],r=r.trim().replace(In,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function vt(r,e){e=e||1/0;let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function Tn(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Nn(r,e){let t,i,n,s=[];for(let o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function Or(r){return bt.toByteArray(Fn(r))}function Ze(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function Q(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function It(r){return r!==r}var An=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function ie(r){return typeof BigInt>"u"?kn:r}function kn(){throw new Error("BigInt not supported")}});var zr=Me((Is,Mr)=>{var Ur;Mr.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:global):r=>(Ur||(Ur=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var _r=`<!-- Data: Triples, SPARQL query, result -->
@if (graphRDFInputData) {
    <div #fs class="row awg-graph-visualizer" [class.is-fullscreen]="isFullscreen">
        <div [ngClass]="isFullscreen ? 'col-4 col-lg-3 px-0 awg-fullscreen' : 'col-12'">
            <div [ngClass]="{ row: !isFullscreen }">
                <div [ngClass]="{ 'col-12 col-lg-6 py-0 pe-lg-0': !isFullscreen }">
                    <!-- awg-graph-triples-editor -->
                    <awg-triples-editor
                        [triples]="triples"
                        [isFullscreen]="isFullscreen"
                        (errorMessageRequest)="showErrorMessage($event)"
                        (performQueryRequest)="performQuery()"
                        (resetTriplesRequest)="resetTriples()"
                        (updateTriplesRequest)="triples = $event"></awg-triples-editor>
                </div>
                <div [ngClass]="{ 'col-12 col-lg-6 py-0 ps-lg-0': !isFullscreen }">
                    <!-- awg-graph-sparql-editor -->
                    <awg-sparql-editor
                        [queryList]="queryList"
                        [query]="query"
                        [isFullscreen]="isFullscreen"
                        (errorMessageRequest)="showErrorMessage($event)"
                        (performQueryRequest)="performQuery()"
                        (resetQueryRequest)="resetQuery($event)"
                        (updateQueryStringRequest)="query.queryString = $event"></awg-sparql-editor>
                </div>
            </div>
        </div>
        <!-- Results -->
        <div [ngClass]="isFullscreen ? 'col-8 col-lg-9 px-0 awg-fullscreen' : 'col-12'">
            <!-- CONSTRUCT -->
            <!-- awg-graph-construct-result -->
            @if (query.queryType === 'construct') {
                <awg-construct-results
                    #queryConstructResultAcc
                    [queryResult$]="queryResult$"
                    [defaultForceGraphHeight]="isFullscreen ? 1000 : defaultForceGraphHeight"
                    [isFullscreen]="isFullscreen"
                    (clickedNodeRequest)="onGraphNodeClick($event)"></awg-construct-results>
            } @else {
                @if (query.queryType === 'select') {
                    <awg-select-results
                        [queryResult$]="queryResult$"
                        [queryTime]="queryTime"
                        [isFullscreen]="isFullscreen"
                        (clickedTableRequest)="onTableNodeClick($event)"></awg-select-results>
                } @else {
                    <awg-unsupported-type-results
                        [queryType]="query.queryType"
                        [isFullscreen]="isFullscreen"></awg-unsupported-type-results>
                }
            }
        </div>
    </div>
}

<awg-toast aria-live="polite" aria-atomic="true"></awg-toast>
`;var xr=`:host::ng-deep .awg-fullscreen .collapse.show{height:100vh}:host::ng-deep .awg-fullscreen #awg-graph-visualizer-triples.collapse.show{height:45vh}:host::ng-deep .awg-fullscreen #awg-graph-visualizer-query.collapse.show{height:50vh}
`;var $r=zt(jr()),Qr=zt(zr());var ke="http://www.w3.org/1999/02/22-rdf-syntax-ns#",De="http://www.w3.org/2001/XMLSchema#",Ft="http://www.w3.org/2000/10/swap/",j={xsd:{decimal:`${De}decimal`,boolean:`${De}boolean`,double:`${De}double`,integer:`${De}integer`,string:`${De}string`},rdf:{type:`${ke}type`,nil:`${ke}nil`,first:`${ke}first`,rest:`${ke}rest`,langString:`${ke}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${Ft}reify#forSome`,forAll:`${Ft}reify#forAll`},log:{implies:`${Ft}log#implies`}};var{xsd:We}=j,Dn=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,Gr={"\\":"\\","'":"'",'"':'"',n:`
`,r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},Bn=/[\x00-\x20<>\\"\{\}\|\^\`]/,qn={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},Pn=/$0^/,Be=class{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(let t in this)!(t in qn)&&this[t]instanceof RegExp&&(this[t]=Pn)}else this._n3Mode=e.n3!==!1;this.comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let i=this._input,n=i.length;for(;;){let a,u;for(;a=this._newline.exec(i);)this.comments&&(u=this._comment.exec(a[0]))&&s("comment",u[1],"",this._line,a[0].length),i=i.substr(a[0].length,i.length),n=i.length,this._line++;if(!a&&(a=this._whitespace.exec(i))&&(i=i.substr(a[0].length,i.length)),this._endOfFile.test(i))return t&&(this.comments&&(u=this._comment.exec(i))&&s("comment",u[1],"",this._line,i.length),i=null,s("eof","","",this._line,0)),this._input=i;let l=this._line,f=i[0],h="",_="",g="",m=null,p=0,d=!1;switch(f){case"^":if(i.length<3)break;if(i[1]==="^"){if(this._previousMarker="^^",i=i.substr(2),i[0]!=="<"){d=!0;break}}else{this._n3Mode&&(p=1,h="^");break}case"<":if(m=this._unescapedIri.exec(i))h="IRI",_=m[1];else if(m=this._iri.exec(i)){if(_=this._unescape(m[1]),_===null||Bn.test(_))return o(this);h="IRI"}else i.length>1&&i[1]==="<"?(h="<<",p=2):this._n3Mode&&i.length>1&&i[1]==="="&&(h="inverse",p=2,_=">");break;case">":i.length>1&&i[1]===">"&&(h=">>",p=2);break;case"_":((m=this._blank.exec(i))||t&&(m=this._blank.exec(`${i} `)))&&(h="blank",g="_",_=m[1]);break;case'"':if(m=this._simpleQuotedString.exec(i))_=m[1];else if({value:_,matchLength:p}=this._parseLiteral(i),_===null)return o(this);(m!==null||p!==0)&&(h="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(m=this._simpleApostropheString.exec(i))_=m[1];else if({value:_,matchLength:p}=this._parseLiteral(i),_===null)return o(this);(m!==null||p!==0)&&(h="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(m=this._variable.exec(i))&&(h="var",_=m[0]);break;case"@":this._previousMarker==="literal"&&(m=this._langcode.exec(i))?(h="langcode",_=m[1]):(m=this._keyword.exec(i))&&(h=m[0]);break;case".":if(i.length===1?t:i[1]<"0"||i[1]>"9"){h=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(m=this._number.exec(i)||t&&(m=this._number.exec(`${i} `)))&&(h="literal",_=m[0],g=typeof m[1]=="string"?We.double:typeof m[2]=="string"?We.decimal:We.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(m=this._sparqlKeyword.exec(i))?h=m[0].toUpperCase():d=!0;break;case"f":case"t":(m=this._boolean.exec(i))?(h="literal",_=m[0],g=We.boolean):d=!0;break;case"a":(m=this._shortPredicates.exec(i))?(h="abbreviation",_="a"):d=!0;break;case"=":this._n3Mode&&i.length>1&&(h="abbreviation",i[1]!==">"?(p=1,_="="):(p=2,_=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(p=1,h=f);break;case"{":!this._lineMode&&i.length>=2&&(i[1]==="|"?(h="{|",p=2):(h=f,p=1));break;case"|":i.length>=2&&i[1]==="}"&&(h="|}",p=2);break;default:d=!0}if(d&&((this._previousMarker==="@prefix"||this._previousMarker==="PREFIX")&&(m=this._prefix.exec(i))?(h="prefix",_=m[1]||""):((m=this._prefixed.exec(i))||t&&(m=this._prefixed.exec(`${i} `)))&&(h="prefixed",g=m[1]||"",_=this._unescape(m[2]))),this._previousMarker==="^^")switch(h){case"prefixed":h="type";break;case"IRI":h="typeIRI";break;default:h=""}if(!h)return t||!/^'''|^"""/.test(i)&&/\n|\r/.test(i)?o(this):this._input=i;let x=p||m[0].length,y=s(h,_,g,l,x);this.previousToken=y,this._previousMarker=h,i=i.substr(x,i.length)}function s(a,u,l,f,h){let _=i?n-i.length:n,g=_+h,m={type:a,value:u,prefix:l,line:f,start:_,end:g};return e(null,m),m}function o(a){e(a._syntaxError(/^\S*/.exec(i)[0]))}}_unescape(e){let t=!1,i=e.replace(Dn,(n,s,o,a)=>{if(typeof s=="string")return String.fromCharCode(Number.parseInt(s,16));if(typeof o=="string"){let u=Number.parseInt(o,16);return u<=65535?String.fromCharCode(Number.parseInt(o,16)):String.fromCharCode(55296+((u-=65536)>>10),56320+(u&1023))}return a in Gr?Gr[a]:(t=!0,"")});return t?null:i}_parseLiteral(e){if(e.length>=3){let t=e.match(/^(?:"""|"|'''|'|)/)[0],i=t.length,n=Math.max(this._literalClosingPos,i);for(;(n=e.indexOf(t,n))>0;){let s=0;for(;e[n-s-1]==="\\";)s++;if(s%2===0){let o=e.substring(i,n),a=o.split(/\r\n|\r|\n/).length-1,u=n+i;if(i===1&&a!==0||i===3&&this._lineMode)break;return this._line+=a,{value:this._unescape(o),matchLength:u}}n++}this._literalClosingPos=e.length-i+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;let t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\uFEFF")?e.substr(1):e}tokenize(e,t){if(this._line=1,typeof e=="string")if(this._input=this._readStartingBom(e),typeof t=="function")(0,Qr.default)(()=>this._tokenizeToEnd(t,!0));else{let i=[],n;if(this._tokenizeToEnd((s,o)=>s?n=s:i.push(o),!0),n)throw n;return i}else this._pendingBuffer=null,typeof e.setEncoding=="function"&&e.setEncoding("utf8"),e.on("data",i=>{this._input!==null&&i.length!==0&&(this._pendingBuffer&&(i=$r.Buffer.concat([this._pendingBuffer,i]),this._pendingBuffer=null),i[i.length-1]&128?this._pendingBuffer=i:(typeof this._input>"u"?this._input=this._readStartingBom(typeof i=="string"?i:i.toString()):this._input+=i,this._tokenizeToEnd(t,!1)))}),e.on("end",()=>{typeof this._input=="string"&&this._tokenizeToEnd(t,!0)}),e.on("error",t)}};var{rdf:Ln,xsd:Ee}=j,Le,On=0;var jn={namedNode:Vr,blankNode:Zr,variable:Xr,literal:Wr,defaultGraph:Un,quad:kt,triple:kt,fromTerm:qe,fromQuad:Jr},Hr=jn,W=class r{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof r?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}},Xe=class extends W{get termType(){return"NamedNode"}},Pe=class r extends W{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){let e=this.id,t=e.lastIndexOf('"')+1;return t<e.length&&e[t++]==="@"?e.substr(t).toLowerCase():""}get datatype(){return new Xe(this.datatypeString)}get datatypeString(){let e=this.id,t=e.lastIndexOf('"')+1,i=t<e.length?e[t]:"";return i==="^"?e.substr(t+2):i!=="@"?Ee.string:Ln.langString}equals(e){return e instanceof r?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}},Tt=class extends W{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}},Nt=class extends W{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}},At=class extends W{constructor(){return super(""),Le||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}};Le=new At;var Je=class extends W{constructor(e,t,i,n){super(""),this._subject=e,this._predicate=t,this._object=i,this._graph=n||Le}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}};function Vr(r){return new Xe(r)}function Zr(r){return new Tt(r||`n3-${On++}`)}function Wr(r,e){if(typeof e=="string")return new Pe(`"${r}"@${e.toLowerCase()}`);let t=e?e.value:"";return t===""&&(typeof r=="boolean"?t=Ee.boolean:typeof r=="number"&&(Number.isFinite(r)?t=Number.isInteger(r)?Ee.integer:Ee.double:(t=Ee.double,Number.isNaN(r)||(r=r>0?"INF":"-INF")))),t===""||t===Ee.string?new Pe(`"${r}"`):new Pe(`"${r}"^^${t}`)}function Xr(r){return new Nt(r)}function Un(){return Le}function kt(r,e,t,i){return new Je(r,e,t,i)}function qe(r){if(r instanceof W)return r;switch(r.termType){case"NamedNode":return Vr(r.value);case"BlankNode":return Zr(r.value);case"Variable":return Xr(r.value);case"DefaultGraph":return Le;case"Literal":return Wr(r.value,r.language||r.datatype);case"Quad":return Jr(r);default:throw new Error(`Unexpected termType: ${r.termType}`)}}function Jr(r){if(r instanceof Je)return r;if(r.termType!=="Quad")throw new Error(`Unexpected termType: ${r.termType}`);return kt(qe(r.subject),qe(r.predicate),qe(r.object),qe(r.graph))}var Kr=0,le=class{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&Yr(this,e.factory);let t=typeof e.format=="string"?e.format.match(/\w*$/)[0].toLowerCase():"",i=/turtle/.test(t),n=/trig/.test(t),s=/triple/.test(t),o=/quad/.test(t),a=this._n3Mode=/n3/.test(t),u=s||o;(this._supportsNamedGraphs=!(i||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(i||n||s||a),this._supportsRDFStar=t===""||/star|\*$/.test(t),u&&(this._resolveRelativeIRI=l=>null),this._blankNodePrefix=typeof e.blankNodePrefix!="string"?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new Be({lineMode:u,n3:a}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){Kr=0}_setBase(e){if(!e)this._base="",this._basePath="";else{let t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}}_saveContext(e,t,i,n,s){let o=this._n3Mode;this._contextStack.push({type:e,subject:i,predicate:n,object:s,graph:t,inverse:o?this._inversePredicate:!1,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){let i=this._contextStack.pop();if(!i||i.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=i.subject,this._predicate=i.predicate,this._object=i.object,this._graph=i.graph,this._n3Mode&&(this._inversePredicate=i.inverse,this._prefixes._=i.blankPrefix,this._quantified=i.quantified)}_readInTopContext(e){switch(e.type){case"eof":return this._graph!==null?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let i;switch(e.type){case"IRI":case"typeIRI":let n=this._resolveIRI(e.value);if(n===null)return this._error("Invalid IRI",e);i=this._namedNode(n);break;case"type":case"prefixed":let s=this._prefixes[e.prefix];if(s===void 0)return this._error(`Undefined prefix "${e.prefix}:"`,e);i=this._namedNode(s+e.value);break;case"blank":i=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":i=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&i.id in this._quantified&&(i=this._quantified[i.id]),i}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(e.prefix.length===0)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",e);default:if((this._subject=this._readEntity(e))===void 0)return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){let t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return this._predicate===null?this._error(`Unexpected ${t}`,e):(this._subject=null,t==="]"?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._predicate!==null?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if((this._predicate=this._readEntity(e))===void 0)return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(e.prefix.length===0)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",e);default:if((this._object=this._readEntity(e))===void 0)return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return e.type==="{"?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return e.type!=="{"?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return e.type==="]"?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if(e.type!=="]")return this._readBlankNodePunctuation(e);this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph);let t=this._predicate===null;return this._restoreContext("blank",e),this._object!==null?this._getContextEndReader():this._predicate!==null?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,i=null,n=this._readListItem,s=this._subject,o=this._contextStack,a=o[o.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,i=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),n=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,i=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),o.length!==0&&o[o.length-1].type==="list"&&this._emit(this._subject,this._predicate,this._object,this._graph),this._predicate===null){if(n=this._readPredicate,this._subject===this.RDF_NIL)return n}else if(n=this._getContextEndReader(),this._object===this.RDF_NIL)return n;i=this.RDF_NIL;break;case"literal":e.prefix.length===0?(this._literalValue=e.value,n=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),n=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if((t=this._readEntity(e))===void 0)return}if(i===null&&(this._subject=i=this._blankNode()),s===null?a.predicate===null?a.subject=i:a.object=i:this._emit(s,this.RDF_REST,i,this._graph),t!==null){if(this._n3Mode&&(e.type==="IRI"||e.type==="prefixed"))return this._saveContext("item",this._graph,i,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(i,this.RDF_FIRST,t,this._graph)}return n}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":let i=this._readEntity(e);if(i===void 0)return;t=this._literal(this._literalValue,i),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null;break}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){let i=this._completeLiteral(e);if(i)return this._object=i.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),i.token===null?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(i.token))}_readFormulaTail(e){return e.type!=="}"?this._readPunctuation(e):(this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),this._object===null?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,i=this._graph,n=this._subject,s=this._inversePredicate;switch(e.type){case"}":if(this._graph===null)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,s&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF-star syntax",e);let o=this._predicate,a=this._object;this._subject=this._quad(n,o,a,this.DEFAULTGRAPH),t=this._readPredicate;break;case"|}":if(this._subject.termType!=="Quad")return this._error("Unexpected asserted triple closing",e);this._subject=null,t=this._readPunctuation;break;default:if(this._supportsQuads&&this._graph===null&&(i=this._readEntity(e))!==void 0){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(n!==null){let o=this._predicate,a=this._object;s?this._emit(a,o,n,i):this._emit(n,o,a,i)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return e.type!=="."?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return e.type!=="prefix"?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if(e.type!=="IRI")return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);let t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){let t=e.type==="IRI"&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return e.type!=="]"?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):e.type!=="."?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if((t=this._readEntity(e,!0))!==void 0)break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(this._subject===null?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return e.type===","?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:let t=this._contextStack,i=t.length&&t[t.length-1];if(i&&i.type==="item"){let n=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,n,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,i,n=this._blankNode();if((i=this._readEntity(e))!==void 0)return this._predicate===null?(t=this._subject,this._subject=n):(t=this._object,this._object=n),this._emit(t,i,n,this._graph),this._readPath}_readBackwardPath(e){let t=this._blankNode(),i,n;if((i=this._readEntity(e))!==void 0)return this._predicate===null?(n=this._subject,this._subject=t):(n=this._object,this._object=t),this._emit(t,i,n,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return e.type!==">>"?this._supportsQuads&&this._graph===null&&(this._graph=this._readEntity(e))!==void 0?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(e.type!==">>")return this._error(`Expected >> but got ${e.type}`,e);let t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),this._subject===null?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){let e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,i,n){this._callback(null,this._quad(e,t,i,n||this.DEFAULTGRAPH))}_error(e,t){let i=new Error(`${e} on line ${t.line}.`);i.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(i),this._callback=Ke}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return(e[1]==="/"?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;let t=e.length,i="",n=-1,s=-1,o=0,a="/";for(;n<t;){switch(a){case":":if(s<0&&e[++n]==="/"&&e[++n]==="/")for(;(s=n+1)<t&&e[s]!=="/";)n=s;break;case"?":case"#":n=t;break;case"/":if(e[n+1]===".")switch(a=e[++n+1],a){case"/":i+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return i+e.substring(o,n)+e.substr(n+1);case".":if(a=e[++n+1],a===void 0||a==="/"||a==="?"||a==="#"){if(i+=e.substring(o,n-2),(o=i.lastIndexOf("/"))>=s&&(i=i.substr(0,o)),a!=="/")return`${i}/${e.substr(n+1)}`;o=n+1}}}a=e[++n]}return i+e.substring(o)}parse(e,t,i){let n,s,o;if(t&&(t.onQuad||t.onPrefix||t.onComment)?(n=t.onQuad,s=t.onPrefix,o=t.onComment):(n=t,s=i),this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${Kr++}_`,this._prefixCallback=s||Ke,this._inversePredicate=!1,this._quantified=Object.create(null),!n){let u=[],l;if(this._callback=(f,h)=>{f?l=f:h&&u.push(h)},this._lexer.tokenize(e).every(f=>this._readCallback=this._readCallback(f)),l)throw l;return u}let a=(u,l)=>{u!==null?(this._callback(u),this._callback=Ke):this._readCallback&&(this._readCallback=this._readCallback(l))};o&&(this._lexer.comments=!0,a=(u,l)=>{u!==null?(this._callback(u),this._callback=Ke):this._readCallback&&(l.type==="comment"?o(l.value):this._readCallback=this._readCallback(l))}),this._callback=n,this._lexer.tokenize(e,a)}};function Ke(){}function Yr(r,e){let t=e.namedNode;r._namedNode=t,r._blankNode=e.blankNode,r._literal=e.literal,r._variable=e.variable,r._quad=e.quad,r.DEFAULTGRAPH=e.defaultGraph(),r.RDF_FIRST=t(j.rdf.first),r.RDF_REST=t(j.rdf.rest),r.RDF_NIL=t(j.rdf.nil),r.N3_FORALL=t(j.r.forAll),r.N3_FORSOME=t(j.r.forSome),r.ABBREVIATIONS={a:t(j.rdf.type),"=":t(j.owl.sameAs),">":t(j.log.implies)},r.QUANTIFIERS_GRAPH=t("urn:n3:quantifiers")}Yr(le.prototype,Hr);function Dt(r,e){var t,i=1;r==null&&(r=0),e==null&&(e=0);function n(){var s,o=t.length,a,u=0,l=0;for(s=0;s<o;++s)a=t[s],u+=a.x,l+=a.y;for(u=(u/o-r)*i,l=(l/o-e)*i,s=0;s<o;++s)a=t[s],a.x-=u,a.y-=l}return n.initialize=function(s){t=s},n.x=function(s){return arguments.length?(r=+s,n):r},n.y=function(s){return arguments.length?(e=+s,n):e},n.strength=function(s){return arguments.length?(i=+s,n):i},n}function ei(r){let e=+this._x.call(null,r),t=+this._y.call(null,r);return ti(this.cover(e,t),e,t,r)}function ti(r,e,t,i){if(isNaN(e)||isNaN(t))return r;var n,s=r._root,o={data:i},a=r._x0,u=r._y0,l=r._x1,f=r._y1,h,_,g,m,p,d,x,y;if(!s)return r._root=o,r;for(;s.length;)if((p=e>=(h=(a+l)/2))?a=h:l=h,(d=t>=(_=(u+f)/2))?u=_:f=_,n=s,!(s=s[x=d<<1|p]))return n[x]=o,r;if(g=+r._x.call(null,s.data),m=+r._y.call(null,s.data),e===g&&t===m)return o.next=s,n?n[x]=o:r._root=o,r;do n=n?n[x]=new Array(4):r._root=new Array(4),(p=e>=(h=(a+l)/2))?a=h:l=h,(d=t>=(_=(u+f)/2))?u=_:f=_;while((x=d<<1|p)===(y=(m>=_)<<1|g>=h));return n[y]=s,n[x]=o,r}function ri(r){var e,t,i=r.length,n,s,o=new Array(i),a=new Array(i),u=1/0,l=1/0,f=-1/0,h=-1/0;for(t=0;t<i;++t)isNaN(n=+this._x.call(null,e=r[t]))||isNaN(s=+this._y.call(null,e))||(o[t]=n,a[t]=s,n<u&&(u=n),n>f&&(f=n),s<l&&(l=s),s>h&&(h=s));if(u>f||l>h)return this;for(this.cover(u,l).cover(f,h),t=0;t<i;++t)ti(this,o[t],a[t],r[t]);return this}function ii(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,i=this._y0,n=this._x1,s=this._y1;if(isNaN(t))n=(t=Math.floor(r))+1,s=(i=Math.floor(e))+1;else{for(var o=n-t||1,a=this._root,u,l;t>r||r>=n||i>e||e>=s;)switch(l=(e<i)<<1|r<t,u=new Array(4),u[l]=a,a=u,o*=2,l){case 0:n=t+o,s=i+o;break;case 1:t=n-o,s=i+o;break;case 2:n=t+o,i=s-o;break;case 3:t=n-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=t,this._y0=i,this._x1=n,this._y1=s,this}function ni(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function si(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function k(r,e,t,i,n){this.node=r,this.x0=e,this.y0=t,this.x1=i,this.y1=n}function oi(r,e,t){var i,n=this._x0,s=this._y0,o,a,u,l,f=this._x1,h=this._y1,_=[],g=this._root,m,p;for(g&&_.push(new k(g,n,s,f,h)),t==null?t=1/0:(n=r-t,s=e-t,f=r+t,h=e+t,t*=t);m=_.pop();)if(!(!(g=m.node)||(o=m.x0)>f||(a=m.y0)>h||(u=m.x1)<n||(l=m.y1)<s))if(g.length){var d=(o+u)/2,x=(a+l)/2;_.push(new k(g[3],d,x,u,l),new k(g[2],o,x,d,l),new k(g[1],d,a,u,x),new k(g[0],o,a,d,x)),(p=(e>=x)<<1|r>=d)&&(m=_[_.length-1],_[_.length-1]=_[_.length-1-p],_[_.length-1-p]=m)}else{var y=r-+this._x.call(null,g.data),w=e-+this._y.call(null,g.data),b=y*y+w*w;if(b<t){var R=Math.sqrt(t=b);n=r-R,s=e-R,f=r+R,h=e+R,i=g.data}}return i}function ai(r){if(isNaN(f=+this._x.call(null,r))||isNaN(h=+this._y.call(null,r)))return this;var e,t=this._root,i,n,s,o=this._x0,a=this._y0,u=this._x1,l=this._y1,f,h,_,g,m,p,d,x;if(!t)return this;if(t.length)for(;;){if((m=f>=(_=(o+u)/2))?o=_:u=_,(p=h>=(g=(a+l)/2))?a=g:l=g,e=t,!(t=t[d=p<<1|m]))return this;if(!t.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(i=e,x=d)}for(;t.data!==r;)if(n=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,n?(s?n.next=s:delete n.next,this):e?(s?e[d]=s:delete e[d],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(i?i[x]=t:this._root=t),this):(this._root=s,this)}function ui(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function li(){return this._root}function ci(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function hi(r){var e=[],t,i=this._root,n,s,o,a,u;for(i&&e.push(new k(i,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(i=t.node,s=t.x0,o=t.y0,a=t.x1,u=t.y1)&&i.length){var l=(s+a)/2,f=(o+u)/2;(n=i[3])&&e.push(new k(n,l,f,a,u)),(n=i[2])&&e.push(new k(n,s,f,l,u)),(n=i[1])&&e.push(new k(n,l,o,a,f)),(n=i[0])&&e.push(new k(n,s,o,l,f))}return this}function fi(r){var e=[],t=[],i;for(this._root&&e.push(new k(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var n=i.node;if(n.length){var s,o=i.x0,a=i.y0,u=i.x1,l=i.y1,f=(o+u)/2,h=(a+l)/2;(s=n[0])&&e.push(new k(s,o,a,f,h)),(s=n[1])&&e.push(new k(s,f,a,u,h)),(s=n[2])&&e.push(new k(s,o,h,f,l)),(s=n[3])&&e.push(new k(s,f,h,u,l))}t.push(i)}for(;i=t.pop();)r(i.node,i.x0,i.y0,i.x1,i.y1);return this}function pi(r){return r[0]}function di(r){return arguments.length?(this._x=r,this):this._x}function gi(r){return r[1]}function mi(r){return arguments.length?(this._y=r,this):this._y}function ce(r,e,t){var i=new Bt(e??pi,t??gi,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function Bt(r,e,t,i,n,s){this._x=r,this._y=e,this._x0=t,this._y0=i,this._x1=n,this._y1=s,this._root=void 0}function _i(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var P=ce.prototype=Bt.prototype;P.copy=function(){var r=new Bt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,i;if(!e)return r;if(!e.length)return r._root=_i(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var n=0;n<4;++n)(i=e.source[n])&&(i.length?t.push({source:i,target:e.target[n]=new Array(4)}):e.target[n]=_i(i));return r};P.add=ei;P.addAll=ri;P.cover=ii;P.data=ni;P.extent=si;P.find=oi;P.remove=ai;P.removeAll=ui;P.root=li;P.size=ci;P.visit=hi;P.visitAfter=fi;P.x=di;P.y=mi;function H(r){return function(){return r}}function G(r){return(r()-.5)*1e-6}function zn(r){return r.x+r.vx}function Gn(r){return r.y+r.vy}function qt(r){var e,t,i,n=1,s=1;typeof r!="function"&&(r=H(r==null?1:+r));function o(){for(var l,f=e.length,h,_,g,m,p,d,x=0;x<s;++x)for(h=ce(e,zn,Gn).visitAfter(a),l=0;l<f;++l)_=e[l],p=t[_.index],d=p*p,g=_.x+_.vx,m=_.y+_.vy,h.visit(y);function y(w,b,R,q,O){var C=w.data,z=w.r,I=p+z;if(C){if(C.index>_.index){var ee=g-C.x-C.vx,te=m-C.y-C.vy,V=ee*ee+te*te;V<I*I&&(ee===0&&(ee=G(i),V+=ee*ee),te===0&&(te=G(i),V+=te*te),V=(I-(V=Math.sqrt(V)))/V*n,_.vx+=(ee*=V)*(I=(z*=z)/(d+z)),_.vy+=(te*=V)*I,C.vx-=ee*(I=1-I),C.vy-=te*I)}return}return b>g+I||q<g-I||R>m+I||O<m-I}}function a(l){if(l.data)return l.r=t[l.data.index];for(var f=l.r=0;f<4;++f)l[f]&&l[f].r>l.r&&(l.r=l[f].r)}function u(){if(e){var l,f=e.length,h;for(t=new Array(f),l=0;l<f;++l)h=e[l],t[h.index]=+r(h,l,e)}}return o.initialize=function(l,f){e=l,i=f,u()},o.iterations=function(l){return arguments.length?(s=+l,o):s},o.strength=function(l){return arguments.length?(n=+l,o):n},o.radius=function(l){return arguments.length?(r=typeof l=="function"?l:H(+l),u(),o):r},o}function $n(r){return r.index}function xi(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function Pt(r){var e=$n,t=h,i,n=H(30),s,o,a,u,l,f=1;r==null&&(r=[]);function h(d){return 1/Math.min(a[d.source.index],a[d.target.index])}function _(d){for(var x=0,y=r.length;x<f;++x)for(var w=0,b,R,q,O,C,z,I;w<y;++w)b=r[w],R=b.source,q=b.target,O=q.x+q.vx-R.x-R.vx||G(l),C=q.y+q.vy-R.y-R.vy||G(l),z=Math.sqrt(O*O+C*C),z=(z-s[w])/z*d*i[w],O*=z,C*=z,q.vx-=O*(I=u[w]),q.vy-=C*I,R.vx+=O*(I=1-I),R.vy+=C*I}function g(){if(o){var d,x=o.length,y=r.length,w=new Map(o.map((R,q)=>[e(R,q,o),R])),b;for(d=0,a=new Array(x);d<y;++d)b=r[d],b.index=d,typeof b.source!="object"&&(b.source=xi(w,b.source)),typeof b.target!="object"&&(b.target=xi(w,b.target)),a[b.source.index]=(a[b.source.index]||0)+1,a[b.target.index]=(a[b.target.index]||0)+1;for(d=0,u=new Array(y);d<y;++d)b=r[d],u[d]=a[b.source.index]/(a[b.source.index]+a[b.target.index]);i=new Array(y),m(),s=new Array(y),p()}}function m(){if(o)for(var d=0,x=r.length;d<x;++d)i[d]=+t(r[d],d,r)}function p(){if(o)for(var d=0,x=r.length;d<x;++d)s[d]=+n(r[d],d,r)}return _.initialize=function(d,x){o=d,l=x,g()},_.links=function(d){return arguments.length?(r=d,g(),_):r},_.id=function(d){return arguments.length?(e=d,_):e},_.iterations=function(d){return arguments.length?(f=+d,_):f},_.strength=function(d){return arguments.length?(t=typeof d=="function"?d:H(+d),m(),_):t},_.distance=function(d){return arguments.length?(n=typeof d=="function"?d:H(+d),p(),_):n},_}function yi(){let r=1;return()=>(r=(1664525*r+1013904223)%4294967296)/4294967296}function bi(r){return r.x}function wi(r){return r.y}var Qn=10,Hn=Math.PI*(3-Math.sqrt(5));function Lt(r){var e,t=1,i=.001,n=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,u=gr(h),l=pr("tick","end"),f=yi();r==null&&(r=[]);function h(){_(),l.call("tick",e),t<i&&(u.stop(),l.call("end",e))}function _(p){var d,x=r.length,y;p===void 0&&(p=1);for(var w=0;w<p;++w)for(t+=(s-t)*n,a.forEach(function(b){b(t)}),d=0;d<x;++d)y=r[d],y.fx==null?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return e}function g(){for(var p=0,d=r.length,x;p<d;++p){if(x=r[p],x.index=p,x.fx!=null&&(x.x=x.fx),x.fy!=null&&(x.y=x.fy),isNaN(x.x)||isNaN(x.y)){var y=Qn*Math.sqrt(.5+p),w=p*Hn;x.x=y*Math.cos(w),x.y=y*Math.sin(w)}(isNaN(x.vx)||isNaN(x.vy))&&(x.vx=x.vy=0)}}function m(p){return p.initialize&&p.initialize(r,f),p}return g(),e={tick:_,restart:function(){return u.restart(h),e},stop:function(){return u.stop(),e},nodes:function(p){return arguments.length?(r=p,g(),a.forEach(m),e):r},alpha:function(p){return arguments.length?(t=+p,e):t},alphaMin:function(p){return arguments.length?(i=+p,e):i},alphaDecay:function(p){return arguments.length?(n=+p,e):+n},alphaTarget:function(p){return arguments.length?(s=+p,e):s},velocityDecay:function(p){return arguments.length?(o=1-p,e):1-o},randomSource:function(p){return arguments.length?(f=p,a.forEach(m),e):f},force:function(p,d){return arguments.length>1?(d==null?a.delete(p):a.set(p,m(d)),e):a.get(p)},find:function(p,d,x){var y=0,w=r.length,b,R,q,O,C;for(x==null?x=1/0:x*=x,y=0;y<w;++y)O=r[y],b=p-O.x,R=d-O.y,q=b*b+R*R,q<x&&(C=O,x=q);return C},on:function(p,d){return arguments.length>1?(l.on(p,d),e):l.on(p)}}}function Ot(){var r,e,t,i,n=H(-30),s,o=1,a=1/0,u=.81;function l(g){var m,p=r.length,d=ce(r,bi,wi).visitAfter(h);for(i=g,m=0;m<p;++m)e=r[m],d.visit(_)}function f(){if(r){var g,m=r.length,p;for(s=new Array(m),g=0;g<m;++g)p=r[g],s[p.index]=+n(p,g,r)}}function h(g){var m=0,p,d,x=0,y,w,b;if(g.length){for(y=w=b=0;b<4;++b)(p=g[b])&&(d=Math.abs(p.value))&&(m+=p.value,x+=d,y+=d*p.x,w+=d*p.y);g.x=y/x,g.y=w/x}else{p=g,p.x=p.data.x,p.y=p.data.y;do m+=s[p.data.index];while(p=p.next)}g.value=m}function _(g,m,p,d){if(!g.value)return!0;var x=g.x-e.x,y=g.y-e.y,w=d-m,b=x*x+y*y;if(w*w/u<b)return b<a&&(x===0&&(x=G(t),b+=x*x),y===0&&(y=G(t),b+=y*y),b<o&&(b=Math.sqrt(o*b)),e.vx+=x*g.value*i/b,e.vy+=y*g.value*i/b),!0;if(g.length||b>=a)return;(g.data!==e||g.next)&&(x===0&&(x=G(t),b+=x*x),y===0&&(y=G(t),b+=y*y),b<o&&(b=Math.sqrt(o*b)));do g.data!==e&&(w=s[g.data.index]*i/b,e.vx+=x*w,e.vy+=y*w);while(g=g.next)}return l.initialize=function(g,m){r=g,t=m,f()},l.strength=function(g){return arguments.length?(n=typeof g=="function"?g:H(+g),f(),l):n},l.distanceMin=function(g){return arguments.length?(o=g*g,l):Math.sqrt(o)},l.distanceMax=function(g){return arguments.length?(a=g*g,l):Math.sqrt(a)},l.theta=function(g){return arguments.length?(u=g*g,l):Math.sqrt(u)},l}var Mo={LINK_DISTANCE:1/50,COLLISION_STRENGTH:1,CHARGE_STRENGTH:-1};var Oe=class{constructor(){this.nodes=[],this.links=[],this.nodeTriples=[]}};var ve=class{constructor(e,t){let i="";this.source=e,this.target=t,this.predicate=i,this.weight=1}};var je=class{constructor(e,t,i){this.nodeSubject=e,this.nodePredicate=t,this.nodeObject=i}};var X;(function(r){r.link="link",r.node="node"})(X||(X={}));var he=class{constructor(e,t){this.id=e,this.label=e,this.weight=1,this.type=t,this.owlClass=!1,this.instance=!1}};var J;(function(r){r.TURTLE="TURTLE",r.SPARQL="SPARQL"})(J||(J={}));var B;(function(r){r.SHORT="short",r.LONG="long"})(B||(B={}));var D=class{constructor(e,t){this.prefixName=e,this.prefixIri=t}};var jt=[new D("awg","https://edition.anton-webern.ch/webern-onto#"),new D("dbo","http://dbpedia.org/ontology/"),new D("dbp","http://dbpedia.org/property/"),new D("dbpedia","http://dbpedia.org/resource/"),new D("dc","http://purl.org/dc/elements/1.1/"),new D("dcterms","http://purl.org/dc/terms/"),new D("foaf","http://xmlns.com/foaf/0.1/"),new D("mo","http://purl.org/ontology/mo/"),new D("owl","http://www.w3.org/2002/07/owl#"),new D("prov","http://www.w3.org/ns/prov#"),new D("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),new D("rdfs","http://www.w3.org/2000/01/rdf-schema#"),new D("skos","http://www.w3.org/2004/02/skos/core#"),new D("xsd","http://www.w3.org/2001/XMLSchema#")];var K=class{constructor(){this.defaultPrefixes=jt}transform(e,t){let i;switch(t){case B.SHORT:{this.defaultPrefixes.forEach(n=>{e.indexOf(n.prefixIri)!==-1&&(i=e.replace(n.prefixIri,n.prefixName+":"))});break}case B.LONG:{this.defaultPrefixes.forEach(n=>{e.indexOf(n.prefixName)!==-1&&(i=e.replace(n.prefixName,n.prefixIri))});break}default:{let n=t;throw new Error(`The prefixForm must be ${B.SHORT} or ${B.LONG}, but was: ${n}.`)}}return i||e}};K=E([Jt({name:"prefix",pure:!1})],K);var Re,ne=(Re=class{constructor(e){this.prefixPipe=e}checkNamespacesInQuery(e,t){if(!e||!t)return;let i=this._extractNamespacesFromString(J.TURTLE,t),n=this._extractNamespacesFromString(J.SPARQL,e),s=this._extractQNamePrefixesFromSPARQLWhereClause(e),o=new Set(Object.keys(n)),a="";return[...Object.entries(i),...s.map(u=>[u,this.prefixPipe.transform(u,B.LONG)])].forEach(([u,l])=>{!o.has(u)&&u!==l?a+=`PREFIX ${u}: <${l}>
`:u===l&&console.error(`Prefix '${u}' is unknown. Please provide a declaration.`)}),a+e}doQuery(e,t,i,n){return n||(n="text/turtle"),this._createStore(rdfstore).then(s=>(this._store=s,this._loadTriplesInStore(s,i,n))).then(s=>this._executeQuery(this._store,t)).then(s=>{if(e==="select"){let o=s;return this._prepareSelectResponse(o).data}if(e==="construct"){let o=s,a=this._extractNamespacesFromString(J.TURTLE,i);return this._prepareConstructResponse(o.triples,a,n)}})}getQuerytype(e){let t=["select","construct","ask","count","describe","insert","delete"],i=1/0,n=null;return t.forEach(s=>{let o=e.toLowerCase().indexOf(s);o!==-1&&o<i&&(i=o,n=s)}),n===null?null:n==="insert"||n==="delete"?"update":n}limitTriples(e,t){return e?e.length>t?e.slice(0,t):e:[]}parseTripleString(e){let t=new le,i=[];return new Promise((n,s)=>{t.parse(e,(o,a,u)=>{if(o){s(o);return}a?i.push(a):n({quads:i,namespaces:u})})})}_abbreviate(e,t){if(!e?.startsWith("http")||!t)return e;for(let[i,n]of Object.entries(t))if(e.includes(n))return e.replace(n,i+":");return e}_createStore(e){return new Promise((t,i)=>{e.create((n,s)=>{n&&i(n),t(s)})})}_executeQuery(e,t){return new Promise((i,n)=>{e.execute(t,(s,o)=>{s&&(console.error("_executeQuery# got ERROR",s),n(s)),i(o)})})}_extractNamespacesFromString(e,t){let i;switch(e){case J.TURTLE:i=/@prefix\s+(\w+):\s+<([^>]+)>/g;break;case J.SPARQL:i=/PREFIX\s+(\w+):\s+<([^>]+)>/g;break;default:let s=e;throw new Error(`The type must be TURTLE or SPARQL, but was: ${s}.`)}let n={};for(let s of t.matchAll(i)){let[o,a,u]=s;n[a]=u}return n}_extractQNamePrefixesFromSPARQLWhereClause(e){let t="WHERE {",i=/\b([a-zA-Z_][a-zA-Z0-9._-]{0,15}):/g,n=e.toLowerCase().indexOf(t.toLowerCase()),o=(n!==-1?e.slice(n):e).matchAll(i),a=new Set(Array.from(o,u=>u[1]));return Array.from(a)}_loadTriplesInStore(e,t,i){return i||(i="text/turtle"),new Promise((n,s)=>{e.load(i,t,(o,a)=>{o&&(console.error("_loadTriplesInStore# got ERROR",o),s(o)),n(a)})})}_mapKeys(e,t){return e?t?Object.entries(e).reduce((i,[n,s])=>{let o=t[n]||n;return i[o]=s,i},{}):e:{}}_prepareMappedBindings(e){let t="http://www.w3.org/2001/XMLSchema#integer",i="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",n={token:"type",type:"datatype",lang:"xml:lang"};return e.map(s=>{let o={};return Object.entries(s).forEach(([a,u])=>{o[a]=this._mapKeys(u,n);let{value:l,type:f,datatype:h=""}=o[a];o[a].label=f==="literal"&&(h===t||h===i)?+l:this.prefixPipe.transform(l,B.SHORT)}),o})}_prepareConstructResponse(e,t,i){let n=!i||i==="text/turtle";return e.map(s=>{let{subject:o,predicate:a,object:u}={subject:s.subject.nominalValue,predicate:s.predicate.nominalValue,object:s.object.nominalValue};return n&&(o=this._abbreviate(o,t),a=this._abbreviate(a,t),u=this._abbreviate(u,t)),{subject:o,predicate:a,object:u}})}_prepareSelectResponse(e){if(!e)return{status:404,data:void 0};if(e.length===0)return{status:400,data:"Query returned no results"};let t=Object.keys(e[0]),i=this._prepareMappedBindings(e);return{status:200,data:{head:{vars:t},body:{bindings:i}}}}},Re.ctorParameters=()=>[{type:K}],Re);ne=E([Xt()],ne);var fe,pe=(fe=class{constructor(e,t){this.graphVisualizerService=e,this.toastService=t,this.defaultForceGraphHeight=500}ngOnInit(){this.resetTriples(),this.resetQuery()}resetTriples(){this.graphRDFInputData.triples&&(this.triples=this.graphRDFInputData.triples)}resetQuery(e){if(!this.graphRDFInputData.queryList)return;this.queryList=JSON.parse(JSON.stringify(this.graphRDFInputData.queryList));let t=e?this.queryList.find(i=>e.queryLabel===i.queryLabel&&e.queryType===i.queryType)||e:this.queryList[0];this.query=Mt({},t),this.performQuery()}performQuery(){if(this.query.queryString=this.graphVisualizerService.checkNamespacesInQuery(this.query.queryString,this.triples),this.query.queryType=this.graphVisualizerService.getQuerytype(this.query.queryString),this.query.queryType==="construct"||this.query.queryType==="select"){let e=this._queryLocalStore(this.query.queryType,this.query.queryString,this.triples);this.queryResult$=$t(e)}else this.queryResult$=ze}onGraphNodeClick(e){e&&console.info("GraphVisualizerComponent# graphClick on node",e)}onTableNodeClick(e){e&&console.info("GraphVisualizerComponent# tableClick on URI",e)}showErrorMessage(e){if(!e?.message)return;let t=new ir(e.message,{header:e.name,classname:"bg-danger text-light",delay:e.duration});this.toastService.add(t),console.error(e.name,":",e.message)}_queryLocalStore(e,t,i){return Gt(this,null,function*(){let n=Date.now(),s;try{s=yield this.graphVisualizerService.doQuery(e,t,i),this.queryTime=Date.now()-n}catch(o){console.error("#queryLocalstore got error:",o),o.message&&o.name&&(o.message.indexOf("undefined")!==-1&&this.showErrorMessage(new oe(o.name,"The query did not return any results.",5e3)),this.showErrorMessage(new oe(o.name,o.message,5e3))),this.queryTime=Date.now()-n,s=[]}return s})}},fe.ctorParameters=()=>[{type:ne},{type:nr}],fe.propDecorators={fs:[{type:re,args:["fs"]}],graphRDFInputData:[{type:v}],isFullscreen:[{type:v}]},fe);pe=E([S({selector:"awg-graph-visualizer",template:_r,changeDetection:F.Default,styles:[xr]})],pe);var Ei=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-construct-results"
        [collapsed]="false"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader>
            <button ngbAccordionButton class="p-3">Resultat</button>
        </div>
        <div ngbAccordionCollapse>
            <div ngbAccordionBody>
                <ng-template>
                    @if (queryResult$ | async; as queryResult) {
                        @if (isQueryResultNotEmpty(queryResult)) {
                            <!-- Force graph visualization -->
                            <awg-force-graph
                                class="full-width"
                                [currentQueryResultTriples]="queryResult"
                                [height]="defaultForceGraphHeight"
                                (clickedNodeRequest)="onGraphNodeClick($event)">
                            </awg-force-graph>
                        } @else {
                            <awg-sparql-no-results></awg-sparql-no-results>
                        }
                    } @else {
                        <awg-twelve-tone-spinner></awg-twelve-tone-spinner>
                    }
                </ng-template>
            </div>
        </div>
    </div>
</div>
`;var vi="";var Se,Ye=(Se=class{constructor(){this.clickedNodeRequest=new T}isQueryResultNotEmpty(e){return e.length===0?!1:e.every(t=>{let{subject:i,predicate:n,object:s}=t;return!!i&&!!n&&!!s})}isAccordionItemDisabled(){return this.isFullscreen}onGraphNodeClick(e){e&&this.clickedNodeRequest.emit(e)}},Se.propDecorators={queryResult$:[{type:v}],defaultForceGraphHeight:[{type:v}],isFullscreen:[{type:v}],clickedNodeRequest:[{type:N}]},Se);Ye=E([S({selector:"awg-construct-results",template:Ei,changeDetection:F.OnPush,styles:[vi]})],Ye);var Ri=`<div
    #graphContainer
    id="awg-force-graph-container"
    class="awg-force-graph-panel-container"
    [ngStyle]="{ 'height.px': height }">
    <div class="awg-force-graph-icon-bar">
        <!-- Slider -->
        <div class="input-group input-group-sm awg-force-graph-zoom-slider-container float-start mb-3">
            <span #sliderInputLabel class="input-group-text" id="slider-label">{{ sliderConfig.value }}x</span>
            <input
                type="range"
                #sliderInput
                class="awg-force-graph-zoom-slider"
                id="awg-force-graph-zoom-slider"
                name="zoomSlider"
                aria-label="Zoom slider"
                aria-describedby="slider-label"
                [min]="sliderConfig.min"
                [max]="sliderConfig.max"
                [step]="sliderConfig.stepSize"
                [(ngModel)]="sliderConfig.value"
                (ngModelChange)="onZoomChange($event)" />
            <button class="btn btn-sm btn-outline-info" type="submit" title="Reset" (click)="onReCenter()">
                <fa-icon [icon]="faCompressArrowsAlt"></fa-icon>
            </button>
        </div>

        <!-- Limit -->
        @if (currentQueryResultTriples) {
            <div class="btn-group awg-force-graph-node-limit-container float-end my-auto">
                <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">
                    @if (limit < currentQueryResultTriples.length) {
                        <span>{{ limit }} von </span>
                    }
                    {{ currentQueryResultTriples.length }} Triples
                </button>
                <div
                    class="btn-group"
                    ngbDropdown
                    container="body"
                    role="group"
                    aria-label="Button group with nested dropdown for node limit">
                    <button
                        class="btn btn-sm btn-info dropdown-toggle"
                        ngbDropdownToggle
                        [disabled]="currentQueryResultTriples.length === 0"></button>
                    <div class="dropdown-menu" ngbDropdownMenu>
                        @for (limitValue of limitValues; track limitValue) {
                            @if (currentQueryResultTriples.length > limitValue) {
                                <button class="dropdown-item" (click)="onLimitValueChange(limitValue)">
                                    <span>{{ limitValue }}</span>
                                </button>
                            }
                        }
                        <button class="dropdown-item" (click)="onLimitValueChange(currentQueryResultTriples.length)">
                            <span>Kein Limit</span>
                        </button>
                    </div>
                </div>
            </div>
        }

        <!-- <span *ngIf="message" class="message">{{message}}</span> -->
    </div>
</div>
`;var Si=`#awg-force-graph-container{position:relative;width:100%}#awg-force-graph-container>.awg-force-graph-icon-bar{position:relative;width:100%}.awg-force-graph-panel-container{position:inherit;height:100%}.input-group.awg-force-graph-zoom-slider-container{flex-wrap:nowrap;width:auto}.input-group.awg-force-graph-zoom-slider-container>:not(:first-child){margin-left:0!important}#slider-label.input-group-text{min-width:50px;color:#149b9e}input[type=range].awg-force-graph-zoom-slider{width:100%;background-color:transparent;-webkit-appearance:none}input[type=range].awg-force-graph-zoom-slider:focus{outline:none}input[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-lower{background:#ddddddc7}input[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-upper{background:#e5e5e5}input[type=range].awg-force-graph-zoom-slider:focus::-webkit-slider-runnable-track{background:#e5e5e5}input[type=range].awg-force-graph-zoom-slider::-webkit-slider-runnable-track{background:#ddddddc7;border:.2px solid #dddddd;border-radius:1.3px;width:100%;height:31px;cursor:pointer}input[type=range].awg-force-graph-zoom-slider::-webkit-slider-thumb{width:15px;height:29px;background:#149b9e;border:1.8px solid #149b9e;border-radius:10px;cursor:pointer;-webkit-appearance:none}input[type=range].awg-force-graph-zoom-slider::-moz-range-track{background:#ddddddc7;border:.2px solid #dddddd;border-radius:1.3px;width:100%;height:29px;cursor:pointer;-moz-margin-start:fill;margin-right:fill}input[type=range].awg-force-graph-zoom-slider::-moz-range-thumb{width:15px;height:27px;background:#149b9e;border:1.8px solid #149b9e;border-radius:10px;cursor:pointer}input[type=range].awg-force-graph-zoom-slider::-ms-track{background:transparent;border-color:transparent;border-width:7.4px 0;color:transparent;width:100%;height:31px;cursor:pointer}input[type=range].awg-force-graph-zoom-slider::-ms-fill-lower{background:#ddddddc7;border:.2px solid #dddddd;border-radius:2.6px}input[type=range].awg-force-graph-zoom-slider::-ms-fill-upper{background:#ddddddc7;border:.2px solid #dddddd;border-radius:2.6px}input[type=range].awg-force-graph-zoom-slider::-ms-thumb{width:15px;height:29px;background:#149b9e;border:1.8px solid #149b9e;border-radius:10px;cursor:pointer;margin-top:0}:host ::ng-deep .node{stroke:#fff;fill:#ddd;stroke-width:1.5px}:host ::ng-deep .blank{stroke:#fff;fill:#000!important;stroke-width:1.5px}:host ::ng-deep .blank.instance{stroke:#fff;fill:#000;stroke-width:1.5px}:host ::ng-deep .class{stroke:#fff;fill:#9e0000;stroke-width:1.5px}:host ::ng-deep .instance{stroke:#fff;fill:#20b2aa;stroke-width:1.5px}:host ::ng-deep .instance-space{stroke:#fff;fill:#00bfff;stroke-width:1.5px}:host ::ng-deep .instance-spaceType{stroke:#fff;fill:#00008b;stroke-width:1.5px}:host ::ng-deep .link{fill:none;stroke:#999;stroke-opacity:.6;stroke-width:1px}:host ::ng-deep marker{stroke:#999;fill:#7cf00a00}:host ::ng-deep .node-text{font:15px Roboto,sans-serif;fill:#000}:host ::ng-deep .link-text{font:13px Roboto,sans-serif;fill:gray}
`;var et={LINK_DISTANCE:10,COLLISION_STRENGTH:1,COLLISION_RADIUS:30,CHARGE_STRENGTH:-10},de,tt=(de=class{constructor(e,t){this.graphVisualizerService=e,this.prefixPipe=t,this.clickedNodeRequest=new T,this.faCompressArrowsAlt=tr,this.limitValues=[5,10,25,50,100,250,500,1e3],this.limit=50,this.sliderConfig=new fr(1,.1,3,.01,1),this._resize$=new pt,this._destroyed$=new pt}onResize(){!this._graphContainer||!this.currentQueryResultTriples||(this._divWidth=this._getContainerDimensions(this._graphContainer).width,this._divHeight=this._getContainerDimensions(this._graphContainer).height,this._resize$.next(!0))}ngOnInit(){this._resize$.pipe(Ht(150),Zt(this._destroyed$)).subscribe(e=>{this._redraw()}),this._redraw()}ngOnChanges(e){let{queryResultTriples:t}=e;t?.currentValue&&!t.isFirstChange()&&(this.currentQueryResultTriples=t.currentValue,this._redraw())}onLimitValueChange(e){this.limit=e,this._redraw()}onReCenter(){!this._svg||!(this._divWidth&&this._divHeight)||(this.onZoomChange(this.sliderConfig.initial),this._zoomBehaviour.translateTo(this._svg,this._divWidth/2,this._divHeight/2))}onZoomChange(e){this.sliderConfig.value=e,this._reScaleZoom()}log(e,t){let i=t&&JSON.parse(JSON.stringify(t));console.info(e,i)}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}_redraw(){this.currentQueryResultTriples&&(this._cleanSVG(),this._createSVG(),this._attachData(),this._reScaleZoom())}_cleanSVG(){hr("svg.force-graph > *").remove()}_createSVG(){if(!this._graphContainer)return;let e,t;this._divWidth?e=this._divWidth:this._getContainerDimensions(this._graphContainer).width?e=this._getContainerDimensions(this._graphContainer).width:e=400,this._divHeight?t=this._divHeight:this._getContainerDimensions(this._graphContainer).height?t=this._getContainerDimensions(this._graphContainer).height:t=500,this._divWidth=e,this._divHeight=t-45,this._svg||(this._svg=cr(this._graphContainer.nativeElement).append("svg").attr("class","force-graph")),this._svg.attr("width",this._divWidth).attr("height",this._divHeight),this._zoomGroup=this._svg.append("g").attr("class","zoom-container")}_attachData(){let e=this.graphVisualizerService.limitTriples(this.currentQueryResultTriples,this.limit);this._simulationData=this._triplesToD3GraphData(e),this._setupForceSimulation(),this._updateSVG()}_setupForceSimulation(){this._forceSimulation=Lt();let e=Ot().strength(s=>this._nodeRadius(s)*et.CHARGE_STRENGTH),t=Dt(this._divWidth/2,this._divHeight/2),i=qt().strength(et.COLLISION_STRENGTH).radius(et.COLLISION_RADIUS).iterations(2),n=Pt().links(this._simulationData.links).id(s=>s.predicate).distance(et.LINK_DISTANCE);this._forceSimulation.force("charge_force",e).force("center_force",t).force("collide_force",i),this._forceSimulation.nodes(this._simulationData.nodes),this._forceSimulation.force("links",n),this._forceSimulation.alpha(1).restart()}_updateSVG(){if(!this._svg)return;this._zoomGroup.append("svg:defs").selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",30).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:polyline").attr("points","0,-5 10,0 0,5");let e=this._zoomGroup.append("g").attr("class","links").selectAll(".link").data(this._simulationData.nodeTriples).enter().append("path").attr("marker-end","url(#end)").attr("class","link"),t=this._zoomGroup.append("g").attr("class","link-texts").selectAll(".link-text").data(this._simulationData.nodeTriples).enter().append("text").attr("class","link-text").text(s=>s.nodePredicate.label),i=this._zoomGroup.append("g").attr("class","node-texts").selectAll(".node-text").data(this._filterNodesByType(this._simulationData.nodes,X.node)).enter().append("text").attr("class","node-text").text(s=>s.label),n=this._zoomGroup.append("g").attr("class","nodes").selectAll(".node").data(this._filterNodesByType(this._simulationData.nodes,X.node)).enter().append("circle").attr("class",s=>s.owlClass?"class":s.label.indexOf("_:")!==-1?"blank":s.instance||s.label.indexOf("inst:")!==-1?"instance":"node").attr("id",s=>s.label).attr("r",s=>s.label.indexOf("_:")!==-1?8:s.instance||s.label.indexOf("inst:")!==-1?11:s.owlClass||s.label.indexOf("inst:")!==-1?10:9).on("click",(s,o)=>{this._clickedOnNode(s,o)});this._forceSimulation.on("tick",()=>{this._updateNodePositions(n),this._updateNodeTextPositions(i),this._updateLinkPositions(e),this._updateLinkTextPositions(t)}),this._dragHandler(n,this._forceSimulation),this._zoomHandler(this._zoomGroup,this._svg)}_reScaleZoom(){!this._svg||!this.sliderConfig.value||this._zoomBehaviour.scaleTo(this._svg,this.sliderConfig.value)}_checkForRdfType(e){return e.label==="a"||e.label==="rdf:type"||e.label===this.prefixPipe.transform("rdf:type",B.LONG)}_clickedOnNode(e,t){e.defaultPrevented||this.clickedNodeRequest.emit(t)}_dragHandler(e,t){let i=(a,u)=>{a.sourceEvent.stopPropagation(),a.active||t.alphaTarget(.3).restart(),u.fx=u.x,u.fy=u.y},n=(a,u)=>{u.fx=a.x,u.fy=a.y},s=(a,u)=>{a.active||t.alphaTarget(0),u.fx=null,u.fy=null},o=dr().on("start",i).on("drag",n).on("end",s);e.call(o)}_zoomHandler(e,t){let i=n=>{let s=n.transform,o=this._roundToNearestScaleStep(s.k);e.attr("transform",s),this._sliderInput.nativeElement.value=o,this._sliderInputLabel.nativeElement.innerText=o+"x",this.sliderConfig.value=o};this._zoomBehaviour=mr().scaleExtent([this.sliderConfig.min,this.sliderConfig.max]).on("zoom",i),t.call(this._zoomBehaviour)}_filterNodesById(e,t){return e.filter(i=>i.id===t)[0]}_filterNodesByType(e,t){return e.filter(i=>i.type===t)}_getContainerDimensions(e){return e?.nativeElement?{width:e.nativeElement.clientWidth,height:e.nativeElement.clientHeight}:null}_nodeRadius(e){if(!e)return null;let t=8;return e.label.indexOf("_:")!==-1?t=t-1:e.instance||e.label.indexOf("inst:")!==-1?t=t+2:(e.owlClass||e.label.indexOf("inst:")!==-1)&&(t=t+1),t}_roundToNearestScaleStep(e){let t=this.sliderConfig.stepSize;return((s,o)=>+(Math.round(+(s+"e"+o))+"e-"+o))(e,(s=>Math.floor(s)===s?0:s.toString().split(".")[1].length||0)(t))}_triplesToD3GraphData(e){if(!e)return;let t=new Oe;return e.forEach(i=>{let n=this.prefixPipe.transform(i.subject,B.SHORT),s=this.prefixPipe.transform(i.predicate,B.SHORT),o=this.prefixPipe.transform(i.object,B.SHORT);isNaN(o)||(o=Number(o)%1===0?String(Number(o)):String(Number(o).toFixed(2)));let a=new he(s,X.link);t.nodes.push(a);let u=this._filterNodesById(t.nodes,n);u==null&&(u=new he(n,X.node),t.nodes.push(u));let l=this._filterNodesById(t.nodes,o);l==null&&(l=new he(o,X.node),t.nodes.push(l)),u.instance===!1&&(u.instance=this._checkForRdfType(a)),l.owlClass===!1&&(l.owlClass=this._checkForRdfType(a)),t.links.push(new ve(u,a)),t.links.push(new ve(a,l)),t.nodeTriples.push(new je(u,a,l))}),t}_updateNodePositions(e){e.attr("cx",t=>t.x).attr("cy",t=>t.y)}_updateNodeTextPositions(e){e.attr("x",t=>t.x+12).attr("y",t=>t.y+3)}_updateLinkPositions(e){e.attr("d",t=>{let i=t.nodeSubject.x,n=t.nodeSubject.y,s=t.nodeObject.x,o=t.nodeObject.y,a=0,u=a,l=a,f=0,h=0,_=1;return i===s&&n===o&&(f=-45,h=1,u=30,l=20,s=s+1,o=o+1),"M"+i+","+n+"A"+u+","+l+" "+f+","+h+","+_+" "+s+","+o})}_updateLinkTextPositions(e){e.attr("x",t=>t.nodeSubject.x===t.nodeObject.x&&t.nodeSubject.y===t.nodeObject.y?20+(t.nodeSubject.x+t.nodePredicate.x+t.nodeObject.x)/3:10+(t.nodeSubject.x+t.nodePredicate.x+t.nodeObject.x)/3).attr("y",t=>t.nodeSubject.x===t.nodeObject.x&&t.nodeSubject.y===t.nodeObject.y?-40+(t.nodeSubject.y+t.nodePredicate.y+t.nodeObject.y)/3:4+(t.nodeSubject.y+t.nodePredicate.y+t.nodeObject.y)/3)}},de.ctorParameters=()=>[{type:ne},{type:K}],de.propDecorators={currentQueryResultTriples:[{type:v}],height:[{type:v}],clickedNodeRequest:[{type:N}],_graphContainer:[{type:re,args:["graphContainer",{static:!0}]}],_sliderInput:[{type:re,args:["sliderInput",{static:!0}]}],_sliderInputLabel:[{type:re,args:["sliderInputLabel",{static:!0}]}],onResize:[{type:Ge,args:["window:resize"]}]},de);tt=E([S({selector:"awg-force-graph",template:Ri,styles:[Si]})],tt);var Ci=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-select-results"
        [collapsed]="false"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader>
            <button ngbAccordionButton class="p-3">Resultat</button>
        </div>
        <div ngbAccordionCollapse>
            <div ngbAccordionBody>
                <ng-template>
                    @if (queryResult$ | async; as queryResult) {
                        @if (isQueryResultNotEmpty(queryResult)) {
                            <!-- SPARQL table visualization -->
                            <awg-sparql-table
                                [queryResult]="queryResult"
                                [queryTime]="queryTime"
                                (clickedTableRequest)="onTableNodeClick($event)">
                            </awg-sparql-table>
                        } @else {
                            <awg-sparql-no-results></awg-sparql-no-results>
                        }
                    } @else {
                        <awg-twelve-tone-spinner></awg-twelve-tone-spinner>
                    }
                </ng-template>
            </div>
        </div>
    </div>
</div>
`;var Ii="";var ge,rt=(ge=class{constructor(e){this.utils=e,this.clickedTableRequest=new T}isAccordionItemDisabled(){return this.isFullscreen}isQueryResultNotEmpty(e){let{head:t,body:i}=e;return this.utils.isNotEmptyArray(t?.vars)&&this.utils.isNotEmptyArray(i?.bindings)}onTableNodeClick(e){e&&this.clickedTableRequest.emit(e)}},ge.ctorParameters=()=>[{type:Qe}],ge.propDecorators={queryResult$:[{type:v}],queryTime:[{type:v}],isFullscreen:[{type:v}],clickedTableRequest:[{type:N}]},ge);rt=E([S({selector:"awg-select-results",template:Ci,changeDetection:F.OnPush,styles:[Ii]})],rt);var Fi=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-sparql-query"
        [collapsed]="isAccordionItemCollapsed()"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader class="accordion-button custom-header justify-content-between">
            <button ngbAccordionToggle class="btn btn-link m-0 p-0">SPARQL</button>
            <!-- View Handle -->
            @if (!isFullscreen) {
                <awg-view-handle-button-group
                    [viewHandles]="viewHandles"
                    [selectedViewType]="selectedViewType"
                    (viewChangeRequest)="onViewChange($event)"></awg-view-handle-button-group>
            }

            <!-- Example Query Handle -->
            @if (isExampleQueriesEnabled()) {
                <div class="p-0 btn-group awg-example-query-btn-group" style="padding: -3rem">
                    <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">
                        Beispielabfragen
                    </button>
                    <div
                        class="btn-group"
                        ngbDropdown
                        container="body"
                        placement="bottom-right"
                        role="group"
                        aria-label="Button group with nested dropdown for sample queries">
                        <button class="btn btn-sm btn-info" ngbDropdownToggle></button>
                        <div ngbDropdownMenu>
                            <h6 class="dropdown-header">Graph-Ansicht (CONSTRUCT)</h6>
                            @for (q of queryList; track q) {
                                @if (q.queryType === 'construct') {
                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">
                                        <span>{{ q.queryLabel }}</span>
                                    </a>
                                }
                            }
                            <div class="dropdown-divider"></div>
                            <h6 class="dropdown-header">Tabellen-Ansicht (SELECT)</h6>
                            @for (q of queryList; track q) {
                                @if (q.queryType === 'select') {
                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">
                                        <span>{{ q.queryLabel }}</span>
                                    </a>
                                }
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
        <div ngbAccordionCollapse [style.height]="isFullscreen ? '50vh' : 'auto'">
            <div ngbAccordionBody>
                <ng-template>
                    <!-- CodeMirror editor instance -->
                    <awg-codemirror
                        ngDefaultControl
                        [mode]="cmSparqlMode"
                        [(content)]="query.queryString"
                        (contentChange)="onEditorInputChange($event)"></awg-codemirror>

                    <!-- Handle buttons -->
                    <div fxLayout="row" class="mt-2 awg-graph-visualizer-sparql-query-handle-buttons">
                        <button class="btn btn-outline-info" (click)="performQuery()">Query</button>
                        <button class="btn btn-warning" (click)="resetQuery(query)">Reset</button>
                        <button class="btn btn-danger" (click)="onEditorInputChange('')">Clear</button>
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>
`;var Ti=`.custom-header:after{content:none}.custom-header.accordion-button{padding:.8rem!important}.custom-header.accordion-button>#awg-graph-visualizer-sparql-query-toggle{text-decoration:none}
`;var Y;function ki(r){return new RegExp("^(?:"+r.join("|")+")$","i")}var rs=ki(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","iri","uri","bnode","count","sum","min","max","avg","sample","group_concat","rand","abs","ceil","floor","round","concat","substr","strlen","replace","ucase","lcase","encode_for_uri","contains","strstarts","strends","strbefore","strafter","year","month","day","hours","minutes","seconds","timezone","tz","now","uuid","struuid","md5","sha1","sha256","sha384","sha512","coalesce","if","strlang","strdt","isnumeric","regex","exists","isblank","isliteral","a","bind"]),is=ki(["base","prefix","select","distinct","reduced","construct","describe","ask","from","named","where","order","limit","offset","filter","optional","graph","by","asc","desc","as","having","undef","values","group","minus","in","not","service","silent","using","insert","delete","union","true","false","with","data","copy","to","move","add","create","drop","clear","load","into"]),ns=/[*+\-<>=&|\^\/!\?]/,Ni="[A-Za-z_\\-0-9]",ss=new RegExp("[A-Za-z]"),os=new RegExp("(("+Ni+"|\\.)*("+Ni+"))?:");function Di(r,e){var t=r.next();if(Y=null,t=="$"||t=="?")return t=="?"&&r.match(/\s/,!1)?"operator":(r.match(/^[A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][A-Za-z0-9_\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]*/),"variableName.local");if(t=="<"&&!r.match(/^[\s\u00a0=]/,!1))return r.match(/^[^\s\u00a0>]*>?/),"atom";if(t=='"'||t=="'")return e.tokenize=as(t),e.tokenize(r,e);if(/[{}\(\),\.;\[\]]/.test(t))return Y=t,"bracket";if(t=="#")return r.skipToEnd(),"comment";if(ns.test(t))return"operator";if(t==":")return Ai(r),"atom";if(t=="@")return r.eatWhile(/[a-z\d\-]/i),"meta";if(ss.test(t)&&r.match(os))return Ai(r),"atom";r.eatWhile(/[_\w\d]/);var i=r.current();return rs.test(i)?"builtin":is.test(i)?"keyword":"variable"}function Ai(r){r.match(/(\.(?=[\w_\-\\%])|[:\w_-]|\\[-\\_~.!$&'()*+,;=/?#@%]|%[a-f\d][a-f\d])+/i)}function as(r){return function(e,t){for(var i=!1,n;(n=e.next())!=null;){if(n==r&&!i){t.tokenize=Di;break}i=!i&&n=="\\"}return"string"}}function it(r,e,t){r.context={prev:r.context,indent:r.indent,col:t,type:e}}function nt(r){r.indent=r.context.indent,r.context=r.context.prev}var Bi={name:"sparql",startState:function(){return{tokenize:Di,context:null,indent:0,col:0}},token:function(r,e){if(r.sol()&&(e.context&&e.context.align==null&&(e.context.align=!1),e.indent=r.indentation()),r.eatSpace())return null;var t=e.tokenize(r,e);if(t!="comment"&&e.context&&e.context.align==null&&e.context.type!="pattern"&&(e.context.align=!0),Y=="(")it(e,")",r.column());else if(Y=="[")it(e,"]",r.column());else if(Y=="{")it(e,"}",r.column());else if(/[\]\}\)]/.test(Y)){for(;e.context&&e.context.type=="pattern";)nt(e);e.context&&Y==e.context.type&&(nt(e),Y=="}"&&e.context&&e.context.type=="pattern"&&nt(e))}else Y=="."&&e.context&&e.context.type=="pattern"?nt(e):/atom|string|variable/.test(t)&&e.context&&(/[\}\]]/.test(e.context.type)?it(e,"pattern",r.column()):e.context.type=="pattern"&&!e.context.align&&(e.context.align=!0,e.context.col=r.column()));return t},indent:function(r,e,t){var i=e&&e.charAt(0),n=r.context;if(/[\]\}]/.test(i))for(;n&&n.type=="pattern";)n=n.prev;var s=n&&i==n.type;return n?n.type=="pattern"?n.col:n.align?n.col+(s?0:1):n.indent+(s?0:t.unit):0},languageData:{commentTokens:{line:"#"}}};var Ce,st=(Ce=class{constructor(){this.errorMessageRequest=new T,this.performQueryRequest=new T,this.resetQueryRequest=new T,this.updateQueryStringRequest=new T,this.cmSparqlMode=Bi,this.faDiagramProject=mt,this.faTable=gt,this.selectedViewType=U.GRAPH,this.viewHandles=[new _t("Graph view",U.GRAPH,mt),new _t("Table view",U.TABLE,gt)]}ngOnInit(){this.setViewType()}ngOnChanges(e){e.query&&!e.query.isFirstChange()&&this.setViewType()}setViewType(){let e={construct:U.GRAPH,select:U.TABLE};this.selectedViewType=e[this.query?.queryType]||U.GRAPH}onViewChange(e){this.switchQueryType(e),this.onEditorInputChange(this.query.queryString),this.performQuery()}switchQueryType(e){switch(e){case U.TABLE:{this.query.queryType==="construct"&&this.query.queryString.includes("CONSTRUCT")&&(this.query.queryString=this.query.queryString.replace("CONSTRUCT","SELECT *"),this.query.queryType="select");break}case U.GRAPH:{this.query.queryType==="select"&&this.query.queryString.includes("SELECT")&&(this.query.queryString=this.query.queryString.replace(/SELECT.*\n/,`CONSTRUCT
`),this.query.queryType="construct");break}case U.GRID:break;default:{let t=e;throw new Error(`The view must be ${U.GRAPH} or ${U.TABLE}, but was: ${t}.`)}}}isExampleQueriesEnabled(){return!!(this.query?.queryType&&this.query?.queryLabel&&this.query?.queryString&&this.queryList)}onEditorInputChange(e){this.updateQueryStringRequest.emit(e)}onQueryListChange(e){e&&this.queryList&&(e=this.queryList.find(t=>e.queryLabel===t.queryLabel&&e.queryType===t.queryType)||this.queryList[0],this.resetQuery(e))}performQuery(){this.query.queryString?this.performQueryRequest.emit():this.errorMessageRequest.emit(new oe("Empty query","Please enter a SPARQL query."))}resetQuery(e){e&&this.resetQueryRequest.emit(e)}isAccordionItemCollapsed(){return!this.isFullscreen}isAccordionItemDisabled(){return this.isFullscreen}},Ce.propDecorators={queryList:[{type:v}],query:[{type:v}],isFullscreen:[{type:v}],errorMessageRequest:[{type:N}],performQueryRequest:[{type:N}],resetQueryRequest:[{type:N}],updateQueryStringRequest:[{type:N}]},Ce);st=E([S({selector:"awg-sparql-editor",template:Fi,changeDetection:F.OnPush,styles:[Ti]})],st);var qi=`<div class="text-center">
    <p>Entschuldigung, Ihre SPARQL-Anfrage f\xFChrte leider zu keinem Ergebnis.</p>
    <p>M\xF6glicherweise k\xF6nnen Sie Ihre Anfrage anpassen.</p>
    <p>
        Ausf\xFChrliche Informationen zu SPARQL finden Sie unter:
        <a href="{{ logos?.['sparql'].href }}">{{ logos?.['sparql'].href }}</a
        >.
    </p>
    <p>
        <a href="{{ logos?.['sparql'].href }}">
            <img width="33%" src="{{ logos?.['sparql'].src }}" alt="{{ logos?.['sparql'].alt }}" />
        </a>
    </p>
</div>
`;var Pi="";var Ie,ot=(Ie=class{constructor(e){this.coreService=e}ngOnInit(){this.provideMetaData()}provideMetaData(){this.logos=this.coreService.getLogos()}},Ie.ctorParameters=()=>[{type:sr}],Ie);ot=E([S({selector:"awg-sparql-no-results",template:qi,changeDetection:F.OnPush,styles:[Pi]})],ot);var Li=`@if (queryResult) {
    <awg-table
        [tableTitle]="'SELECT Anfrage'"
        [headerInputData]="queryResult.head.vars"
        [rowInputData]="queryResult.body.bindings"
        (clickedTableValueRequest)="onTableNodeClick($event)"
        (clickedTableRowRequest)="(undefined)"></awg-table>
}
`;var Oi=`ngb-highlight ::ng-deep .ngb-highlight{font-weight:700;background:#ff0}
`;var Fe,at=(Fe=class{constructor(){this.clickedTableRequest=new T}onTableNodeClick(e){e&&this.clickedTableRequest.emit(e)}},Fe.propDecorators={queryResult:[{type:v}],queryTime:[{type:v}],clickedTableRequest:[{type:N}]},Fe);at=E([S({selector:"awg-sparql-table",template:Li,changeDetection:F.OnPush,styles:[Oi]})],at);var ji=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-triples"
        [collapsed]="isAccordionItemCollapsed()"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader>
            <button ngbAccordionButton class="p-3">RDF Triples</button>
        </div>
        <div ngbAccordionCollapse [style.height]="isFullscreen ? '50vh' : 'auto'">
            <div ngbAccordionBody>
                <ng-template>
                    <!-- CodeMirror editor instance -->
                    <awg-codemirror
                        ngDefaultControl
                        [mode]="cmTurtleMode"
                        [(content)]="triples"
                        (contentChange)="onEditorInputChange($event)"></awg-codemirror>

                    <!-- Handle buttons -->
                    <div fxLayout="row" class="awg-graph-visualizer-triples-handle-buttons mt-2">
                        <button class="btn btn-outline-info" (click)="performQuery()">Query</button>
                        <button class="btn btn-warning" (click)="resetTriples()">Reset</button>
                        <button class="btn btn-danger" (click)="onEditorInputChange('')">Clear</button>
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>
`;var Ui="";var se;function Gi(r){return new RegExp("^(?:"+r.join("|")+")$","i")}var ds=Gi([]),Mi=Gi(["@prefix","@base","a"]),zi=/[*+\-<>=&|]/;function $i(r,e){var t=r.next();if(se=null,t=="<"&&!r.match(/^[\s\u00a0=]/,!1))return r.match(/^[^\s\u00a0>]*>?/),"atom";if(t=='"'||t=="'")return e.tokenize=gs(t),e.tokenize(r,e);if(/[{}\(\),\.;\[\]]/.test(t))return se=t,null;if(t=="#")return r.skipToEnd(),"comment";if(zi.test(t))return r.eatWhile(zi),null;if(t==":")return"operator";if(r.eatWhile(/[_\w\d]/),r.peek()==":")return"variableName.special";var i=r.current();return Mi.test(i)?"meta":t>="A"&&t<="Z"?"comment":"keyword";var i=r.current();return ds.test(i)?null:Mi.test(i)?"meta":"variable"}function gs(r){return function(e,t){for(var i=!1,n;(n=e.next())!=null;){if(n==r&&!i){t.tokenize=$i;break}i=!i&&n=="\\"}return"string"}}function ut(r,e,t){r.context={prev:r.context,indent:r.indent,col:t,type:e}}function Ut(r){r.indent=r.context.indent,r.context=r.context.prev}var Qi={name:"turtle",startState:function(){return{tokenize:$i,context:null,indent:0,col:0}},token:function(r,e){if(r.sol()&&(e.context&&e.context.align==null&&(e.context.align=!1),e.indent=r.indentation()),r.eatSpace())return null;var t=e.tokenize(r,e);if(t!="comment"&&e.context&&e.context.align==null&&e.context.type!="pattern"&&(e.context.align=!0),se=="(")ut(e,")",r.column());else if(se=="[")ut(e,"]",r.column());else if(se=="{")ut(e,"}",r.column());else if(/[\]\}\)]/.test(se)){for(;e.context&&e.context.type=="pattern";)Ut(e);e.context&&se==e.context.type&&Ut(e)}else se=="."&&e.context&&e.context.type=="pattern"?Ut(e):/atom|string|variable/.test(t)&&e.context&&(/[\}\]]/.test(e.context.type)?ut(e,"pattern",r.column()):e.context.type=="pattern"&&!e.context.align&&(e.context.align=!0,e.context.col=r.column()));return t},indent:function(r,e,t){var i=e&&e.charAt(0),n=r.context;if(/[\]\}]/.test(i))for(;n&&n.type=="pattern";)n=n.prev;var s=n&&i==n.type;return n?n.type=="pattern"?n.col:n.align?n.col+(s?0:1):n.indent+(s?0:t.unit):0},languageData:{commentTokens:{line:"#"}}};var Te,lt=(Te=class{constructor(){this.errorMessageRequest=new T,this.performQueryRequest=new T,this.resetTriplesRequest=new T,this.updateTriplesRequest=new T,this.cmTurtleMode=Qi}onEditorInputChange(e){this.updateTriplesRequest.emit(e)}performQuery(){this.triples?this.performQueryRequest.emit():this.errorMessageRequest.emit(new oe("Empty triples","Please enter triple content."))}resetTriples(){this.resetTriplesRequest.emit()}isAccordionItemCollapsed(){return!this.isFullscreen}isAccordionItemDisabled(){return this.isFullscreen}},Te.propDecorators={triples:[{type:v}],isFullscreen:[{type:v}],errorMessageRequest:[{type:N}],performQueryRequest:[{type:N}],resetTriplesRequest:[{type:N}],updateTriplesRequest:[{type:N}]},Te);lt=E([S({selector:"awg-triples-editor",template:ji,changeDetection:F.OnPush,styles:[Ui]})],lt);var Hi=`<div ngbAccordion>
    <div
        ngbAccordionItem="awg-graph-visualizer-unsupported-query-type-result"
        [collapsed]="false"
        [disabled]="isAccordionItemDisabled()">
        <div ngbAccordionHeader>
            <button ngbAccordionButton>Resultat</button>
        </div>
        <div ngbAccordionCollapse>
            <div ngbAccordionBody>
                <p class="text-center">
                    Sorry, but the requested SPARQL query type <code>{{ queryType | uppercase }}</code> is not supported
                    yet.
                </p>
                <p class="text-center">Please try a <code>CONSTRUCT</code> or <code>SELECT</code> query instead.</p>
            </div>
        </div>
    </div>
</div>
`;var Vi="";var Ne,ct=(Ne=class{isAccordionItemDisabled(){return this.isFullscreen}},Ne.propDecorators={queryType:[{type:v}],isFullscreen:[{type:v}]},Ne);ct=E([S({selector:"awg-unsupported-type-results",template:Hi,changeDetection:F.OnPush,styles:[Vi]})],ct);var ht=class{};ht=E([_e({imports:[$e],declarations:[Ye,tt,pe,K,rt,st,ot,at,lt,ct],exports:[pe],providers:[ne,K]})],ht);var Zi=`<!-- content: edition graph -->
<div>
    <!-- modal -->
    <awg-modal #modal></awg-modal>

    <!-- graph -->
    @if (editionGraphData$ | async; as editionGraphData) {
        <div class="awg-graph-view p-5 border rounded-3">
            @for (graph of editionGraphData.graph; track graph.id) {
                <div>
                    <!-- graph description -->
                    <div class="awg-graph-description">
                        <p>
                            So weit vorhanden, pr\xE4sentiert die vorliegende Ansicht Graph-Visualisierungen des
                            ausgew\xE4hlten Editionsbereichs: Der <em>statische Graph</em> vermittelt dabei einen von den
                            jeweiligen Editoren fixierten \xDCberblick editionsrelevanter Zusammenh\xE4nge und Abh\xE4ngigkeiten,
                            der <em>dynamische Graph</em> bietet zus\xE4tzlich einen interaktiven Zugang zu dem
                            zugrundeliegenden Datenbestand.
                            <span class="text-danger"
                                >Diese Funktionalit\xE4t ist noch nicht f\xFCr alle Skizzenbestandteile verf\xFCgbar, wird aber
                                sukzessive erg\xE4nzt.</span
                            >
                        </p>
                        @if (utils.isNotEmptyArray(graph.description) || graph.rdfData?.triples) {
                            @for (description of graph.description; track $index) {
                                <p [compile-html]="description" [compile-html-ref]="ref"></p>
                            }
                        } @else {
                            <p class="awg-graph-description-empty">
                                <small class="text-muted"
                                    >[Die Graph-Visualisierungen zum Editionskomplex
                                    <span [innerHTML]="editionComplex.complexId.full"></span> erscheinen im Zusammenhang
                                    der vollsta\u0308ndigen Edition von
                                    <span [innerHTML]="editionComplex.complexId.short"></span> in
                                    {{ editionRouteConstants.EDITION.short }}
                                    {{ editionComplex.pubStatement.series.short }}/{{
                                        editionComplex.pubStatement.section.short
                                    }}.]
                                </small>
                            </p>
                        }
                    </div>
                    <!-- dynamic graph -->
                    @if (graph.rdfData && graph.rdfData.triples && graph.rdfData.queryList) {
                        <div class="awg-graph-dynamic">
                            <h4>
                                Dynamischer Graph
                                <button
                                    type="button"
                                    class="btn btn-sm btn-outline-info ms-2"
                                    (click)="modal.open('HINT_EDITION_GRAPH')">
                                    Hinweise zur Nutzung
                                </button>
                                @if (!isFullscreen) {
                                    <button
                                        type="button"
                                        title="Open fullscreen"
                                        class="btn btn-sm btn-outline-info ms-2"
                                        (click)="openFullscreen()">
                                        <fa-icon [icon]="faExpand"></fa-icon>
                                    </button>
                                }
                                @if (isFullscreen) {
                                    <button
                                        type="button"
                                        title="Close fullscreen"
                                        class="btn btn-sm btn-info ms-2"
                                        (click)="closeFullscreen()">
                                        <fa-icon [icon]="faCompress"></fa-icon>
                                    </button>
                                }
                            </h4>
                            <p>
                                Diese interaktive Visualisierung basiert auf Mads Holten's
                                <a href="https://github.com/MadsHolten/sparql-visualizer">SPARQL Visualizer</a>. Sie
                                modelliert den aktuellen Skizzenkomplex in Form eines
                                <a href="https://www.w3.org/RDF/">RDF</a>-Graphen. Die zugrundeliegenden RDF-Daten sind
                                unter dem Punkt <em>RDF Triples</em> einsehbar und lokal editierbar. Eine Filterung und
                                Eingrenzung dieser RDF-Daten kann mithilfe der Abfragesprache
                                <a href="https://www.w3.org/TR/sparql11-query/">SPARQL</a>
                                unter dem Punkt <em>SPARQL Abfrage</em> vorgenommen werden; in der Voreinstellung werden
                                hierbei alle vorhandenen Triples abgefragt.
                            </p>
                            <awg-graph-visualizer
                                [graphRDFInputData]="graph.rdfData"
                                [isFullscreen]="isFullscreen"></awg-graph-visualizer>
                        </div>
                    }
                    <!-- static image -->
                    @if (graph.staticImage && graph.staticImage !== '') {
                        <div class="awg-graph-static mt-3">
                            <h4>Statischer Graph</h4>
                            <div [compile-html]="graph.staticImage" [compile-html-ref]="ref"></div>
                        </div>
                    }
                </div>
            }
        </div>
    } @else {
        <!-- error message -->
        @if (errorObject) {
            <awg-error-alert [errorObject]="errorObject"></awg-error-alert>
        } @else {
            <!-- loading spinner -->
            <awg-twelve-tone-spinner></awg-twelve-tone-spinner>
        }
    }
</div>
`;var Wi="";var me,Ue=(me=class{constructor(e,t,i,n){this.editionDataService=e,this.editionStateService=t,this.document=i,this.utils=n,this.isFullscreen=!1,this.faExpand=rr,this.faCompress=er,this.GRAPH_IMAGES={OP12:"",OP25:ar.GRAPH_IMAGE_OP25.route},this.errorObject=null,this.ref=this}get editionRouteConstants(){return or}onKeydownHandler(e){!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(this.isFullscreen=!1)}ngOnInit(){this.getEditionGraphData()}getEditionGraphData(){this.editionGraphData$=this.editionStateService.getSelectedEditionComplex().pipe(Vt(e=>(this.editionComplex=e,this.editionDataService.getEditionGraphData(this.editionComplex))),Qt(e=>(this.errorObject=e,ze)))}openFullscreen(){let e=this.child.fs.nativeElement;this.isFullscreen=!0,!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}closeFullscreen(){this.document.exitFullscreen?this.document.exitFullscreen():this.document.mozCancelFullScreen?this.document.mozCancelFullScreen():this.document.webkitExitFullscreen?this.document.webkitExitFullscreen():this.document.msExitFullscreen&&this.document.msExitFullscreen(),this.isFullscreen=!1}},me.ctorParameters=()=>[{type:ur},{type:lr},{type:void 0,decorators:[{type:Wt,args:[Yt]}]},{type:Qe}],me.propDecorators={child:[{type:re,args:[pe]}],isFullscreen:[{type:Kt,args:["class.is-fullscreen"]}],onKeydownHandler:[{type:Ge,args:["document:fullscreenchange",["$event"]]}]},me);Ue=E([S({selector:"awg-edition-graph",template:Zi,changeDetection:F.OnPush,styles:[Wi]})],Ue);var bs=[{path:"",component:Ue,data:{title:"AWG Online Edition \u2013 Graph"}}],Xi=[Ue],ft=class{};ft=E([_e({imports:[dt.forChild(bs)],exports:[dt]})],ft);var Ji=class{};Ji=E([_e({imports:[$e,ht,ft],declarations:[Xi]})],Ji);export{Ji as EditionGraphModule};
