import{a as h,c as w,d as lt,f as R,h as k,i as ct,l as ut,m as ft,n as ht,o as pt,p as dt,q as mt,r as _t,s as M,t as J,u as St,z}from"./chunk-L26XVYES.js";import{J as x,a as nt,f as it,j as y,l as S,n as ot,r as V,ra as at,t as st,v as g,w as v}from"./chunk-I7PFRKPI.js";var E,H=(E=class{constructor(t){this.http=t,this._assetPath=""}getEditionSheetsData(t){this._assetPath=this._setAssetPathForEditionComplex(t);let r=this._getFolioConvoluteData(),n=this._getSvgSheetsData(),i=this._getTextcriticsListData();return V([r,n,i]).pipe(g([new ut,new ct,new J]),v(1))}getEditionGraphData(t){return this._assetPath=this._setAssetPathForEditionComplex(t),this._getGraphData().pipe(g(new ft),v(1))}getEditionIntroData(t){return this._assetPath=this._setAssetPathForEditionComplex(t),this._getIntroData().pipe(g(new ht),v(1))}getEditionPrefaceData(){return this._assetPath=h.BASE_ROUTE,this._getPrefaceData().pipe(g(new pt),v(1))}getEditionReportData(t){this._assetPath=this._setAssetPathForEditionComplex(t);let r=this._getSourceListData(),n=this._getSourceDescriptionListData(),i=this._getSourceEvaluationListData(),o=this._getTextcriticsListData();return V([r,n,i,o]).pipe(g([new _t,new dt,new mt,new J]),v(1))}getEditionRowTablesData(){return this._assetPath=h.BASE_ROUTE,this._getRowTablesData().pipe(g(new lt),v(1))}_setAssetPathForEditionComplex(t){let r="/",n=r+w.SERIES.route+r+t.series.route+w.SECTION.route+t.section.route+t.complexId.route;return h.BASE_ROUTE+n}_getFolioConvoluteData(){let t=h.FILES.folioConvoluteFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getGraphData(){let t=h.FILES.graphFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getIntroData(){let t=h.FILES.introFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getPrefaceData(){let t=h.FILES.prefaceFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getRowTablesData(){let t=h.FILES.rowTablesFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getSourceListData(){let t=h.FILES.sourceListFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getSourceDescriptionListData(){let t=h.FILES.sourceDescriptionListFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getSourceEvaluationListData(){let t=h.FILES.sourceEvaluationListFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getSvgSheetsData(){let t=h.FILES.svgSheetsFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getTextcriticsListData(){let t=h.FILES.textcriticsFile,r=`${this._assetPath}/${t}`;return this._getJsonData(r)}_getJsonData(t){return this.http.get(t).pipe(st(this._handleError("_getJsonData",[])))}_handleError(t,r){return n=>(this._logError(`${t} failed: ${n.message}`),ot(r))}_logError(t){console.error(t)}},E.ctorParameters=()=>[{type:at}],E);H=S([x({providedIn:"root"})],H);var U=class{findTextcritics(t,r){return!t||!r?new M:t.find(i=>i.id===r.id)||new M}getCurrentEditionType(t,r){let i=t?.content?.[0]?.partial,o=i?t.id+i:t.id;return Object.keys(r).find(a=>this._findSvgSheetIndexById(r[a],o)>=0)}getNextSheetId(t,r,n){let i=r?.content?.[0]?.partial,o=r.id+(i||""),s=this._findSvgSheetIndexById(n,r.id);return i?this._findNextSheetIdForPartialSheet(t,n,s,o,i):this._findNextSheetIdForNonPartialSheet(t,n,s,o)}getTextcriticalCommentsForOverlays(t,r){return!t||!r?[]:t.filter(n=>r.some(i=>n.svgGroupId===i.id))}selectConvolute(t,r,n){if(!t||!r||!n)return;let o=this.getCurrentEditionType(n,r)==="sketchEditions"?n.content[0].convolute:"";return this._findConvoluteById(t,o)}selectSvgSheetById(t,r){if(!t||!r)return new k;let n={workEditions:this._findSvgSheetIndexById(t.workEditions,r),textEditions:this._findSvgSheetIndexById(t.textEditions,r),sketchEditions:this._findSvgSheetIndexById(t.sketchEditions,r)};for(let[i,o]of Object.entries(n)){if(o<0)continue;return this._getSheetWithPartialContentById(t[i],o,r)}return new k}_findConvoluteById(t,r){return t.find(i=>i.convoluteId===r)}_findNextSheetIdForPartialSheet(t,r,n,i,o){let s=r[n],l=s.content.findIndex(c=>c.partial===o)+t;return l>=0&&l<s.content?.length?s.id+s.content[l].partial:this._findNextSheetIdForNonPartialSheet(t,r,n,i)}_findNextSheetIdForNonPartialSheet(t,r,n,i){let o=n+t;if(o>=0&&o<r.length){let s=r[o],a=t>0?0:s.content.length-1;return s.id+(s.content[a]?.partial||"")}else return i}_findSvgSheetIndexById(t,r){return t.findIndex(n=>{let i=n.id;if(n.content.length>1){let o=this._findSvgSheetPartialIndexById(n,r);o>=0&&(i+=n.content[o].partial)}return i===r})}_findSvgSheetPartialIndexById(t,r){return t.content.findIndex(n=>t.id+n.partial===r)}_getSheetWithPartialContentById(t,r,n){let i=nt({},t[r]),o=this._findSvgSheetPartialIndexById(i,n);return o>=0&&(i.content=[i.content[o]]),i}};U=S([x({providedIn:"root"})],U);function ce(){}function C(e){return e==null?ce:function(){return this.querySelector(e)}}function xt(e){typeof e!="function"&&(e=C(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],s=o.length,a=n[i]=new Array(s),l,c,u=0;u<s;++u)(l=o[u])&&(c=e.call(l,l.__data__,u,o))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new f(n,this._parents)}function D(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ue(){return[]}function q(e){return e==null?ue:function(){return this.querySelectorAll(e)}}function fe(e){return function(){return D(e.apply(this,arguments))}}function gt(e){typeof e=="function"?e=fe(e):e=q(e);for(var t=this._groups,r=t.length,n=[],i=[],o=0;o<r;++o)for(var s=t[o],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(n.push(e.call(l,l.__data__,c,s)),i.push(l));return new f(n,i)}function G(e){return function(){return this.matches(e)}}function B(e){return function(t){return t.matches(e)}}var he=Array.prototype.find;function pe(e){return function(){return he.call(this.children,e)}}function de(){return this.firstElementChild}function vt(e){return this.select(e==null?de:pe(typeof e=="function"?e:B(e)))}var me=Array.prototype.filter;function _e(){return Array.from(this.children)}function Se(e){return function(){return me.call(this.children,e)}}function yt(e){return this.selectAll(e==null?_e:Se(typeof e=="function"?e:B(e)))}function wt(e){typeof e!="function"&&(e=G(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],s=o.length,a=n[i]=[],l,c=0;c<s;++c)(l=o[c])&&e.call(l,l.__data__,c,o)&&a.push(l);return new f(n,this._parents)}function P(e){return new Array(e.length)}function Et(){return new f(this._enter||this._groups.map(P),this._parents)}function b(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}b.prototype={constructor:b,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function It(e){return function(){return e}}function xe(e,t,r,n,i,o){for(var s=0,a,l=t.length,c=o.length;s<c;++s)(a=t[s])?(a.__data__=o[s],n[s]=a):r[s]=new b(e,o[s]);for(;s<l;++s)(a=t[s])&&(i[s]=a)}function ge(e,t,r,n,i,o,s){var a,l,c=new Map,u=t.length,d=o.length,m=new Array(u),p;for(a=0;a<u;++a)(l=t[a])&&(m[a]=p=s.call(l,l.__data__,a,t)+"",c.has(p)?i[a]=l:c.set(p,l));for(a=0;a<d;++a)p=s.call(e,o[a],a,o)+"",(l=c.get(p))?(n[a]=l,l.__data__=o[a],c.delete(p)):r[a]=new b(e,o[a]);for(a=0;a<u;++a)(l=t[a])&&c.get(m[a])===l&&(i[a]=l)}function ve(e){return e.__data__}function Ct(e,t){if(!arguments.length)return Array.from(this,ve);var r=t?ge:xe,n=this._parents,i=this._groups;typeof e!="function"&&(e=It(e));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=n[c],d=i[c],m=d.length,p=ye(e.call(u,u&&u.__data__,c,n)),_=p.length,j=a[c]=new Array(_),tt=s[c]=new Array(_),le=l[c]=new Array(m);r(u,d,j,tt,le,p,t);for(var I=0,F=0,et,rt;I<_;++I)if(et=j[I]){for(I>=F&&(F=I+1);!(rt=tt[F])&&++F<_;);et._next=rt||null}}return s=new f(s,n),s._enter=a,s._exit=l,s}function ye(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Dt(){return new f(this._exit||this._groups.map(P),this._parents)}function bt(e,t,r){var n=this.enter(),i=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?o.remove():r(o),n&&i?n.merge(i).order():i}function Tt(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,o=n.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var c=r[l],u=n[l],d=c.length,m=a[l]=new Array(d),p,_=0;_<d;++_)(p=c[_]||u[_])&&(m[_]=p);for(;l<i;++l)a[l]=r[l];return new f(a,this._parents)}function At(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,o=n[i],s;--i>=0;)(s=n[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Lt(e){e||(e=we);function t(d,m){return d&&m?e(d.__data__,m.__data__):!d-!m}for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var s=r[o],a=s.length,l=i[o]=new Array(a),c,u=0;u<a;++u)(c=s[u])&&(l[u]=c);l.sort(t)}return new f(i,this._parents).order()}function we(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ft(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Bt(){return Array.from(this)}function Pt(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length;i<o;++i){var s=n[i];if(s)return s}return null}function Nt(){let e=0;for(let t of this)++e;return e}function $t(){return!this.node()}function Ot(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],o=0,s=i.length,a;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this}var N="http://www.w3.org/1999/xhtml",X={svg:"http://www.w3.org/2000/svg",xhtml:N,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function T(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),X.hasOwnProperty(t)?{space:X[t],local:e}:e}function Ee(e){return function(){this.removeAttribute(e)}}function Ie(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ce(e,t){return function(){this.setAttribute(e,t)}}function De(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function be(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Te(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Vt(e,t){var r=T(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?Ie:Ee:typeof t=="function"?r.local?Te:be:r.local?De:Ce)(r,t))}function $(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ae(e){return function(){this.style.removeProperty(e)}}function Le(e,t,r){return function(){this.style.setProperty(e,t,r)}}function Fe(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function Rt(e,t,r){return arguments.length>1?this.each((t==null?Ae:typeof t=="function"?Fe:Le)(e,t,r??"")):kt(this.node(),e)}function kt(e,t){return e.style.getPropertyValue(t)||$(e).getComputedStyle(e,null).getPropertyValue(t)}function Be(e){return function(){delete this[e]}}function Pe(e,t){return function(){this[e]=t}}function Ne(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function Mt(e,t){return arguments.length>1?this.each((t==null?Be:typeof t=="function"?Ne:Pe)(e,t)):this.node()[e]}function Jt(e){return e.trim().split(/^|\s+/)}function W(e){return e.classList||new zt(e)}function zt(e){this._node=e,this._names=Jt(e.getAttribute("class")||"")}zt.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ht(e,t){for(var r=W(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function Ut(e,t){for(var r=W(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function $e(e){return function(){Ht(this,e)}}function Oe(e){return function(){Ut(this,e)}}function Ve(e,t){return function(){(t.apply(this,arguments)?Ht:Ut)(this,e)}}function qt(e,t){var r=Jt(e+"");if(arguments.length<2){for(var n=W(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?Ve:t?$e:Oe)(r,t))}function Re(){this.textContent=""}function ke(e){return function(){this.textContent=e}}function Me(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Gt(e){return arguments.length?this.each(e==null?Re:(typeof e=="function"?Me:ke)(e)):this.node().textContent}function Je(){this.innerHTML=""}function ze(e){return function(){this.innerHTML=e}}function He(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Xt(e){return arguments.length?this.each(e==null?Je:(typeof e=="function"?He:ze)(e)):this.node().innerHTML}function Ue(){this.nextSibling&&this.parentNode.appendChild(this)}function Wt(){return this.each(Ue)}function qe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Yt(){return this.each(qe)}function Ge(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===N&&t.documentElement.namespaceURI===N?t.createElement(e):t.createElementNS(r,e)}}function Xe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function O(e){var t=T(e);return(t.local?Xe:Ge)(t)}function Kt(e){var t=typeof e=="function"?e:O(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function We(){return null}function Qt(e,t){var r=typeof e=="function"?e:O(e),n=t==null?We:typeof t=="function"?t:C(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function Ye(){var e=this.parentNode;e&&e.removeChild(this)}function Zt(){return this.each(Ye)}function Ke(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Qe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function jt(e){return this.select(e?Qe:Ke)}function te(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ze(e){return function(t){e.call(this,t,this.__data__)}}function je(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function tr(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,o;r<i;++r)o=t[r],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function er(e,t,r){return function(){var n=this.__on,i,o=Ze(t);if(n){for(var s=0,a=n.length;s<a;++s)if((i=n[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=r),i.value=t;return}}this.addEventListener(e.type,o,r),i={type:e.type,name:e.name,value:t,listener:o,options:r},n?n.push(i):this.__on=[i]}}function ee(e,t,r){var n=je(e+""),i,o=n.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(i=0,u=a[l];i<o;++i)if((s=n[i]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?er:tr,i=0;i<o;++i)this.each(a(n[i],t,r));return this}function re(e,t,r){var n=$(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function rr(e,t){return function(){return re(this,e,t)}}function nr(e,t){return function(){return re(this,e,t.apply(this,arguments))}}function ne(e,t){return this.each((typeof t=="function"?nr:rr)(e,t))}function*ie(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length,s;i<o;++i)(s=n[i])&&(yield s)}var A=[null];function f(e,t){this._groups=e,this._parents=t}function oe(){return new f([[document.documentElement]],A)}function ir(){return this}f.prototype=oe.prototype={constructor:f,select:xt,selectAll:gt,selectChild:vt,selectChildren:yt,filter:wt,data:Ct,enter:Et,exit:Dt,join:bt,merge:Tt,selection:ir,order:At,sort:Lt,call:Ft,nodes:Bt,node:Pt,size:Nt,empty:$t,each:Ot,attr:Vt,style:Rt,property:Mt,classed:qt,text:Gt,html:Xt,raise:Wt,lower:Yt,append:Kt,insert:Qt,remove:Zt,clone:jt,datum:te,on:ee,dispatch:ne,[Symbol.iterator]:ie};var or=oe;function L(e){return typeof e=="string"?new f([[document.querySelector(e)]],[document.documentElement]):new f([[e]],A)}function sr(e){return typeof e=="string"?new f([document.querySelectorAll(e)],[document.documentElement]):new f([D(e)],A)}function se(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ar(e,t){if(e=se(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}var Y=class{constructor(){this._bufferSize=1,this._editionComplexSubject=new y(this._bufferSize),this._editionComplexStream$=this._editionComplexSubject.asObservable(),this._isPrefaceViewSubject=new y(this._bufferSize),this._isPrefaceViewStream$=this._isPrefaceViewSubject.asObservable(),this._isRowTableViewSubject=new y(this._bufferSize),this._isRowTableViewStream$=this._isRowTableViewSubject.asObservable(),this._selectedEditionSeriesSubject=new y(this._bufferSize),this._selectedEditionSeriesStream$=this._selectedEditionSeriesSubject.asObservable(),this._selectedEditionSectionSubject=new y(this._bufferSize),this._selectedEditionSectionStream$=this._selectedEditionSectionSubject.asObservable()}getEditionComplex(){return this._editionComplexStream$}updateEditionComplex(t){this._editionComplexSubject.next(t)}clearEditionComplex(){this._editionComplexSubject.next(null)}getEditionOutline(){return z}getEditionSeriesRoute(){return w.EDITION.route+w.SERIES.route}getEditionSeriesById(t){return z.find(r=>r.series.route===t)}getEditionSectionById(t,r){return this.getEditionSeriesById(t).sections.find(i=>i.section.route===r)}getSelectedEditionSeries(){return this._selectedEditionSeriesStream$}updateSelectedEditionSeries(t){this._selectedEditionSeriesSubject.next(t)}clearSelectedEditionSeries(){this._selectedEditionSeriesSubject.next(null)}getSelectedEditionSection(){return this._selectedEditionSectionStream$}updateSelectedEditionSection(t){this._selectedEditionSectionSubject.next(t)}clearSelectedEditionSection(){this._selectedEditionSectionSubject.next(null)}getIsPrefaceView(){return this._isPrefaceViewStream$}updateIsPrefaceView(t){this._isPrefaceViewSubject.next(t)}clearIsPrefaceView(){this._isPrefaceViewSubject.next(null)}getIsRowTableView(){return this._isRowTableViewStream$}updateIsRowTableView(t){this._isRowTableViewSubject.next(t)}clearIsRowTableView(){this._isRowTableViewSubject.next(null)}};Y=S([x({providedIn:"root"})],Y);function cr(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function ae(e,t){return fetch(e,t).then(cr)}function K(e){return(t,r)=>ae(t,r).then(n=>new DOMParser().parseFromString(n,e))}var ur=K("application/xml"),fr=K("text/html"),Q=K("image/svg+xml");var Z=class{constructor(){this.overlayFillColor="orange",this.overlayHoverFillColor="tomato",this.overlayTransparentFillColor="transparent",this.overlaySelectionFillColor="green",this.linkBoxFillColor="#dddddd",this.linkBoxHoverFillColor="#eeeeee",this._overlayBoxesOpacity=.3,this._overlayBoxAdditionalSpace=5.5,this._overlayBoxCornerRadius=2,this._suppliedClasses=new Map,this._suppliedClassesLabelLookup=new Map([["foliation","Blattangabe"],["staffN","Systemangabe"],["measureN","Taktzahlen"],["clef","Schl\xFCssel"],["clef_key","Schl\xFCssel mit Tonart"],["key","Tonart"],["accid","Akzidenzien"],["hyphen","Silbentrennung"]])}createSvg(t,r,n){return it(this,null,function*(){if(!t||!r||!n)return;let o=(yield this._fetchSvgFile(t)).getElementsByTagName("svg")[0],s=this._getViewBox(o);for(;o.firstChild;)n.appendChild(o.firstChild);return r.appendChild(n),L(r).attr("width",s.svgWidth).attr("height",s.svgHeight).attr("viewBox",s.viewBox).attr("preserveAspectRatio","xMidYMid meet").attr("version","1.1").attr("xmlns","https://www.w3.org/2000/svg").attr("xlink","https://www.w3.org/1999/xlink")})}createOverlayGroup(t,r,n,i){if(!t||!r)return;let o=this.getD3SelectionById(t,r);return o.append("g").attr("class",`${i}-overlay-group`),o.select(`g.${i}-overlay-group`).append("rect").attr("width",n.width+this._overlayBoxAdditionalSpace*2).attr("height",n.height+this._overlayBoxAdditionalSpace*2).attr("x",n.x-this._overlayBoxAdditionalSpace).attr("y",n.y-this._overlayBoxAdditionalSpace).attr("rx",this._overlayBoxCornerRadius).attr("fill",this.overlayFillColor).attr("opacity",this._overlayBoxesOpacity).attr("class",`${i}-overlay-group-box`)}fillD3SelectionWithColor(t,r){!t||!r||t.attr("fill",r)}getContainerDimensions(t){if(!t)return{width:void 0,height:void 0};let r=t.nativeElement.clientWidth,n=t.nativeElement.clientHeight;return{width:r,height:n}}getD3SelectionById(t,r){if(!(!t||!r))return t.select("#"+r)}getGroupsBySelector(t,r){if(t)return t.selectAll("g."+r)}getOverlayGroupRectSelection(t,r,n){return!t||!r||!n?void 0:this.getD3SelectionById(t,r).select(`rect.${n}-overlay-group-box`)}getSuppliedClasses(t){return t?(this._suppliedClasses=new Map,this.getGroupsBySelector(t,"supplied").each((n,i,o)=>{let a=L(o[i]).attr("class").split(" "),l=a[a.indexOf("supplied")+1];if(l){let c=this._suppliedClassesLabelLookup.get(l)||l;this._suppliedClasses.has(c)||this._suppliedClasses.set(c,!0)}}),this._suppliedClasses):void 0}toggleSuppliedClassOpacity(t,r,n){if(!t)return;let i=Array.from(this._suppliedClassesLabelLookup.entries()).find(([l,c])=>c===r)?.[0]||r,o=i?`supplied.${i}`:"supplied",s=this.getGroupsBySelector(t,o),a=n?0:1;s.style("opacity",a)}updateTkkOverlayColor(t,r,n){let i=this._getTkkOverlayColor(t,n);this.fillD3SelectionWithColor(r,i)}_fetchSvgFile(t){return Q(t)}_getTkkOverlayColor(t,r){return t?r===R.transparent?this.overlayTransparentFillColor:t.isSelected?this.overlaySelectionFillColor:r===R.hover?this.overlayHoverFillColor:this.overlayFillColor:this.overlayFillColor}_getViewBox(t){let n=L(t).attr("viewBox").split(" "),i=+n[2],o=+n[3];return new St(i,o)}};Z=S([x({providedIn:"root"})],Z);export{H as a,U as b,T as c,C as d,q as e,G as f,kt as g,or as h,L as i,ar as j,sr as k,Z as l,Y as m};
