(self.webpackChunkawg_app=self.webpackChunkawg_app||[]).push([[375],{1375:(i,d,r)=>{"use strict";r.r(d),r.d(d,{DataViewModule:()=>ne});var a=r(1635),n=r(4438),o=r(9584);var k=r(2264),E=r.n(k);let x=class{constructor(){this.resourceRequest=new n.bkB}navigateToResource(e){e&&(e=e.toString(),this.resourceRequest.emit(e))}static#e=this.propDecorators={header:[{type:n.pde}],resourceUrl:[{type:n.pde}],resourceRequest:[{type:n.k7i}]}};x=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail-header",template:'\x3c!-- resource detail header --\x3e\n<div class="resource-header">\n    <div class="row">\n        <div class="col-lg-8">\n            <div class="resource-title">\n                <h2 class="title">\n                    <span [compile-html]="header?.title" [compile-html-ref]="this"></span>\n                </h2>\n            </div>\n            <div class="resource-link">\n                <small>\n                    API-Request:\n                    <a href="{{ resourceUrl }}">{{ resourceUrl }}</a>\n                    \x3c!-- TODO: (resource-detail-html-header): change then to stable URL for resource --\x3e\n                </small>\n            </div>\n        </div>\n        <div class="col-lg-4">\n            <table aria-label="Table with resource detail metadata" class="table table-sm resource-header-table">\n                <tbody>\n                    <tr>\n                        <th scope="row">Salsah-ID:</th>\n                        <td id="header?.objID">{{ header?.objID }}</td>\n                    </tr>\n                    <tr>\n                        <th scope="row">Kategorie</th>\n                        <td>\n                            <span class="resource-type">{{ header?.type }}</span\n                            >&nbsp;<span class="resource-icon"><img [src]="header?.icon" alt="icon" /></span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <th scope="row">Zuletzt bearbeitet:</th>\n                        <td>\n                            <span class="resource-lastmod">{{ header?.lastmod }}</span> (UTC)\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n    </div>\n</div>\n',changeDetection:n.Ngq.OnPush,styles:[E()]})],x);var m=r(3135),I=r.n(m);let C=class{constructor(){this.gndRequest=new n.bkB,this.resourceRequest=new n.bkB}exposeGnd(e){e?.type&&this.gndRequest.emit(e)}navigateToResource(e){e&&(e=e.toString(),this.resourceRequest.emit(e))}static#e=this.propDecorators={resourceDetailData:[{type:n.pde}],gndRequest:[{type:n.k7i}],resourceRequest:[{type:n.k7i}]}};C=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail-html",template:'\x3c!-- resourceDetailData content --\x3e\n@if (resourceDetailData?.content) {\n    <awg-resource-detail-html-content\n        [content]="resourceDetailData?.content"\n        (gndRequest)="exposeGnd($event)"\n        (resourceRequest)="navigateToResource($event)">\n    </awg-resource-detail-html-content>\n}\n',changeDetection:n.Ngq.OnPush,styles:[I()]})],C);var J=r(3432),R=r.n(J);let T=class{constructor(){this.gndRequest=new n.bkB,this.resourceRequest=new n.bkB}exposeGnd(e){e?.type&&this.gndRequest.emit(e)}navigateToResource(e){e&&(e=e.toString(),this.resourceRequest.emit(e))}static#e=this.propDecorators={content:[{type:n.pde}],gndRequest:[{type:n.k7i}],resourceRequest:[{type:n.k7i}]}};T=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail-html-content",template:'\x3c!--\n/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/ --\x3e\n\x3c!-- resourceDetailData content --\x3e\n<div class="awg-resource-content">\n    <div class="row">\n        \x3c!-- object properties --\x3e\n        <div class="col-lg-8">\n            <awg-resource-detail-html-content-props\n                [props]="content?.props"\n                (gndRequest)="exposeGnd($event)"\n                (resourceRequest)="navigateToResource($event)">\n            </awg-resource-detail-html-content-props>\n        </div>\n\n        \x3c!-- right side nav objects --\x3e\n        <div class="col-lg-4 mt-3 mt-lg-0 mb-3">\n            <div class="sidenav-right">\n                \x3c!-- image objects --\x3e\n                <awg-resource-detail-html-content-imageobjects [images]="content?.images">\n                </awg-resource-detail-html-content-imageobjects>\n\n                \x3c!-- connected objects --\x3e\n                <awg-resource-detail-html-content-linkedobjects\n                    [incomingGroups]="content?.incoming"\n                    (resourceRequest)="navigateToResource($event)">\n                </awg-resource-detail-html-content-linkedobjects>\n            </div>\n        </div>\n    </div>\n</div>\n',changeDetection:n.Ngq.OnPush,styles:[R()]})],T);var me=r(6307),ve=r.n(me),_e=r(3632);let F=class{constructor(){this.galleryOptions=[new _e.iZ({width:"100%",imageSize:"contain",thumbnailSize:"contain",thumbnailMargin:5,thumbnailsMargin:0,previewCloseOnClick:!0,previewCloseOnEsc:!0,previewZoom:!0,previewRotate:!0,linkTarget:"_blank"})]}static#e=this.propDecorators={images:[{type:n.pde}]}};F=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail-html-content-imageobjects",template:'\x3c!--\n/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/ --\x3e\n\x3c!-- resourceDetailData content: image objects --\x3e\n@if (images?.length > 0) {\n    <div class="awg-image-obj mb-3">\n        \x3c!-- header --\x3e\n        <h5>\n            Abbildungen (<span id="awg-image-number">{{ images?.length }}</span\n            >)\n        </h5>\n        \x3c!-- image slider --\x3e\n        <div class="card awg-image-slider">\n            <ngx-gallery class="ngx-gallery" [options]="galleryOptions" [images]="images"></ngx-gallery>\n        </div>\n        \x3c!-- end DIV image-slider --\x3e\n    </div>\n}\n\x3c!-- end DIV image-obj --\x3e\n',changeDetection:n.Ngq.OnPush,styles:[ve()]})],F);var ye=r(3631),be=r.n(ye);let B=class{constructor(){this.resourceRequest=new n.bkB}get totalNumber(){return this._getNestedArraysTotalItems(this.incomingGroups)||0}navigateToResource(e){e&&(e=e.toString(),this.resourceRequest.emit(e))}_getNestedArraysTotalItems(e){if(!e)return;return e.map(s=>s.links.length).reduce((s,c)=>s+c,0)}static#e=this.propDecorators={incomingGroups:[{type:n.pde}],resourceRequest:[{type:n.k7i}]}};B=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail-html-content-linkedobjects",template:'\x3c!--\n/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/ --\x3e\n\x3c!-- resourceDetailData content: linked objects --\x3e\n<div class="awg-linked-obj">\n    <h5>\n        Verkn\xfcpfte Objekte (\n        @if (incomingGroups) {\n            <span id="awg-incoming-size">{{ totalNumber }}</span>\n        }\n        )\n    </h5>\n\n    <div ngbAccordion [closeOthers]="true">\n        @for (restypeGroup of incomingGroups; track restypeGroup; let i = $index) {\n            <div ngbAccordionItem="awg-linked-obj-incoming-{{ i }}" class="awg-linked-obj-incoming-linkgroup">\n                <div ngbAccordionHeader>\n                    <button ngbAccordionButton>\n                        <span class="awg-linked-obj-title-group single-line">\n                            <span class="badge bg-info me-2">{{ restypeGroup?.links?.length }}</span>\n                            <span class="awg-linked-obj-title">{{ restypeGroup?.restypeLabel }}</span>\n                        </span>\n                    </button>\n                </div>\n                <div ngbAccordionCollapse>\n                    <div ngbAccordionBody>\n                        <ng-template>\n                            <ul class="awg-linked-obj-list nobullets mb-0">\n                                @for (link of restypeGroup.links; track link; let isLast = $last) {\n                                    <li>\n                                        <a class="awg-linked-obj-link" (click)="navigateToResource(link?.id)">\n                                            <img [src]="link?.restype?.icon" alt="icon" />\n                                            &nbsp;[<span class="awg-linked-obj-link-id">{{ link?.id }}</span\n                                            >]&nbsp;\n                                            <span class="awg-linked-obj-link-value">{{ link?.value }}</span>\n                                        </a>\n                                        @if (!isLast) {\n                                            <hr />\n                                        }\n                                    </li>\n                                }\n                            </ul>\n                        </ng-template>\n                    </div>\n                </div>\n            </div>\n        }\n    </div>\n    \x3c!-- end DIV linkedObj --\x3e\n</div>\n',changeDetection:n.Ngq.OnPush,styles:[be()]})],B);var Se=r(2623),we=r.n(Se),G=r(7846);let U=class{constructor(){this.gndRequest=new n.bkB,this.resourceRequest=new n.bkB,this.metaBreakLine="Versionsdatum"}ngOnChanges(e){e.props&&this._checkForGND(e.props)}exposeGnd(e){e?.type&&this.gndRequest.emit(e)}navigateToResource(e){e&&(e=e.toString(),this.resourceRequest.emit(e))}ngOnDestroy(){this._removeGnd()}_checkForGND(e){const t=e.currentValue.filter(s=>"856"===s.pid&&s.values&&s.values.length>0);this._removeGnd(),t.length>0&&t.forEach(s=>{s.values.forEach(c=>{this._setGnd(c)})})}_setGnd(e){const t=new G.wT(G.w5.SET,e);this.exposeGnd(t)}_removeGnd(){const e=new G.wT(G.w5.REMOVE,null);this.exposeGnd(e)}static#e=this.propDecorators={props:[{type:n.pde}],gndRequest:[{type:n.k7i}],resourceRequest:[{type:n.k7i}]}};U=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail-html-content-props",template:'\x3c!-- resource detail data content: props --\x3e\n<section class="awg-props">\n    <h4 class="awg-props-title ms-0">Objektdaten</h4>\n    @for (prop of props; track prop) {\n        <ul>\n            @if (prop.label === metaBreakLine) {\n                <li id="breakLine">\n                    <hr />\n                </li>\n            }\n            @if (prop!.values[0]) {\n                <li class="awg-prop">\n                    \x3c!-- value label --\x3e\n                    @if (prop.label) {\n                        <strong class="awg-prop-label">\n                            {{ prop.label }}\n                        </strong>\n                    }\n                    \x3c!-- value content --\x3e\n                    @for (value of prop.values; track value) {\n                        <ul>\n                            @if (value) {\n                                <li class="awg-prop-value">\n                                    <span [compile-html]="value" [compile-html-ref]="this"></span>\n                                </li>\n                            }\n                        </ul>\n                    }\n                </li>\n            }\n        </ul>\n    }\n</section>\n',changeDetection:n.Ngq.OnPush,styles:[we()]})],U);var Te=r(4463),Ae=r.n(Te);let q=class{static#e=this.propDecorators={resourceJsonConvertedData:[{type:n.pde}]}};q=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail-json-converted",template:'<awg-json-viewer\n    jsonViewerHeader="Converted JSON response from Salsah-API"\n    [jsonViewerData]="resourceJsonConvertedData">\n</awg-json-viewer>\n',changeDetection:n.Ngq.OnPush,styles:[Ae()]})],q);var xe=r(1639),Ie=r.n(xe);let $=class{static#e=this.propDecorators={resourceJsonRawData:[{type:n.pde}]}};$=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail-json-raw",template:'<awg-json-viewer jsonViewerHeader="Raw JSON response from Salsah-API" [jsonViewerData]="resourceJsonRawData">\n</awg-json-viewer>\n',changeDetection:n.Ngq.OnPush,styles:[Ie()]})],$);let z=class{};z=(0,a.Cg)([(0,n.UQu)({imports:[o.G],declarations:[x,C,T,F,B,U,q,$],exports:[x,C,T,F,B,U,q,$]})],z);var Oe=r(2098),Ee=r.n(Oe),S=r(9417),L=r(1413),f=r(6977),y=r(5383),l=r(293);const D=new l.f5("EXISTS","exists","&exist;"),Le=new l.f5("MATCH","match","&isin;"),je=new l.f5("MATCH_BOOLEAN","match boolean","&isin;&oplus;"),j=new l.f5("EQ","equal","="),se=new l.f5("!EQ","not equal","&ne;"),ae=new l.f5("LIKE","like","&sub;"),Me=new l.f5("!LIKE","not like","&nsub;"),oe=new l.f5("GT","greater than","&gt;"),ie=new l.f5("GT_EQ","greater equal than","&ge;"),le=new l.f5("LT","less than","&lt;"),ce=new l.f5("LT_EQ","less equal than","&le;"),Ne={compopList:[{id:0,compopSet:[D]},{id:1,compopSet:[D,j]},{id:2,compopSet:[D,j,ae]},{id:3,compopSet:[D,j,oe,ie,le,ce]},{id:4,compopSet:[D,j,se,oe,ie,le,ce]},{id:5,compopSet:[D,j,se,Le,je,ae,Me]}]},he=(new Map).set("1",5).set("6-14",5).set("14",5).set("2",4).set("3",4).set("4",3).set("5",3).set("13",2).set("6-3",1).set("6-6",1).set("7",1).set("11",1).set("12",1).set("15",1),Ke={typeList:[new l.eV("1","VALTYPE_TEXT","Text","textval","guielement_id=1,2","A value which is utf-8 text"),new l.eV("2","VALTYPE_INTEGER","Integer value","ival","guielement_id=1,3,4,5;min=numeric;max=numeric","A value consisting of an integer value"),new l.eV("3","VALTYPE_FLOAT","Floating point number","fval","guielement_id=1,4;min=numeric;max=numeric","A value consisting of a floating point number"),new l.eV("4","VALTYPE_DATE","Date","dateval","guielement_id=7","A Value consisting of a date"),new l.eV("5","VALTYPE_PERIOD","Period","dateval","guielement_id=1;min=date;max=date;min=date;max=date","A period consists of 2 date values interpreted as start and end of the period"),new l.eV("6","VALTYPE_RESPTR","Resource pointer","ival","guielement_id=3,6","Foreign key of a resource this value is pointing to"),new l.eV("7","VALTYPE_SELECTION","Selection","ival","guielement_id=3,12","A selection out of a set of values"),new l.eV("8","VALTYPE_TIME","Time","timeval","guielement_id=15,16","A time in the form of hh:mm:ss.sss"),new l.eV("9","VALTYPE_INTERVAL","Interval","timeval","guielement_id=0","An interval between ot two times (start-time, end-time)"),new l.eV("10","VALTYPE_GEOMETRY","Geometry","textval","guielement_id=8","Figure geometry as JSON string"),new l.eV("11","VALTYPE_COLOR","Color","textval","guielement_id=9,1","A color value in internet-notation (#rrggbb)"),new l.eV("12","VALTYPE_HLIST","Hierarchical list","ival","guielement_id=10","Hierarchical list"),new l.eV("13","VALTYPE_ICONCLASS","Iconclass","textval","guielement_id=1","Iconclass as defined by http://iconclass.org"),new l.eV("14","VALTYPE_RICHTEXT","Richtext","richtext","guielement_id=14","This denotes a rich text value which in fact is a resource_reference to a rich text resource. The rich text resource should never be visible to the user directly..."),new l.eV("15","VALTYPE_GEONAME","Geoname","geoname","guielement_id=17","Reference to geonames.org")]};var b=r(1626),g=r(6490),h=r(4150);let de=class extends g.Gf{constructor(e){super(e),this.projectId="6",this.resTypeId="126",this.bibShortTitlePropertyId="614",this.resourcesRoute="resources/",this.searchRoute="search/",this.serviceName="BibliographyService"}getBibliographyList(){const e=this.searchRoute,t=(new b.Nl).set("searchtype","extended").set("property_id",this.bibShortTitlePropertyId).set("compop","EXISTS").set("filter_by_project",this.projectId).set("filter_by_restype",this.resTypeId);return this.getApiResponse(h.UP,e,t)}getBibliographyItemDetail(e){const t=this.resourcesRoute+e,s=new b.Nl;return this.getApiResponse(h.NE,t,s)}static#e=this.ctorParameters=()=>[{type:b.Qq}]};de=(0,a.Cg)([(0,n._qm)({providedIn:"root"})],de);var ue=r(7673),Ze=r(7468),Q=r(9901),A=r(6354),v=r(7778);let M=class extends g.Gf{constructor(e,t){super(e),this.conversionService=t,this.projectId="6",this.vocabularyId="4",this.defaultLanguage="de",this.resourceSuffix="_-_local",this.routes={propertylists:"propertylists/",resources:"resources/",resourcetypes:"resourcetypes/",search:"search/"},this.serviceName="DataApiService"}getPropertyListsByResourceType(e){return e?this._getResourceDataResponseFromApi(h.J5,e).pipe((0,Q.U)(new h.J5),(0,A.T)(s=>s)):(0,ue.of)(new h.J5)}getResourceData(e){if(!e)return;const t=this._getResourceDataResponseFromApi(h.NE,e),s=this._getResourceDataResponseFromApi(h.VI,e);return(0,Ze.p)([t,s]).pipe((0,Q.U)([new h.NE,new h.VI]),(0,A.T)(c=>this._prepareResourceData(c,e)))}getResourceTypes(){return this._getResourceDataResponseFromApi(h._i,"").pipe((0,Q.U)(new h._i),(0,A.T)(t=>t))}getSearchData(e){if(!e?.query||"object"==typeof e?.query&&!e?.query?.filterByRestype)return(0,ue.of)(new h.UP);const t=new l.lt(e.query,e.nRows||"-1",e.startAt||"0",e.viewType||v.f.TABLE);return this._getResourceDataResponseFromApi(h.UP,"",t).pipe((0,Q.U)(new h.UP),(0,A.T)(c=>this.conversionService.convertFullTextSearchResults(c)))}_createSearchQueryParamsForApi(e){let t=(new b.Nl).set("filter_by_project",this.projectId).set("lang",this.defaultLanguage).set("show_nrows",e.nRows).set("start_at",e.startAt);return"string"==typeof e.query?t=t.append("searchtype","fulltext"):"object"==typeof e.query&&(t=t.append("searchtype","extended"),t=t.append("filter_by_restype",e.query.filterByRestype),e.query.propertyId&&e.query.propertyId.length>0&&e.query.compop&&e.query.compop.length>0&&(e.query.propertyId.forEach(s=>{t=t.append("property_id",s)}),e.query.compop.forEach(s=>{t=t.append("compop",s)}),e.query.searchval&&e.query.searchval.length>0&&e.query.searchval.forEach(s=>{t=t.append("searchval",s)}))),t}_prepareResourceData(e,t){const s=this.conversionService.convertResourceData(e,t);return new l.PH(e[0],s)}_getResourceDataResponseFromApi(e,t,s){let c,p;switch(e){case h.J5:c=this.routes.propertylists,p=(new b.Nl).set("restype",t);break;case h.VI:c=this.routes.resources+t+this.resourceSuffix,p=(new b.Nl).set("reqtype","context");break;case h.NE:c=this.routes.resources+t+this.resourceSuffix,p=new b.Nl;break;case h._i:c=this.routes.resourcetypes,p=(new b.Nl).set("vocabulary",this.vocabularyId).set("lang",this.defaultLanguage);break;case h.UP:c=this.routes.search,"string"==typeof s.query&&(c+=s.query),p=this._createSearchQueryParamsForApi(s)}return this.getApiResponse(e,c,p)}static#e=this.ctorParameters=()=>[{type:b.Qq},{type:g.Cq}]};M=(0,a.Cg)([(0,n._qm)({providedIn:"root"})],M);let K=class{constructor(e,t){this.dataApiService=e,this.formBuilder=t,this.searchRequest=new n.bkB,this.faPlus=y.QLR,this.faRefresh=y.Vpu,this.faSearch=y.MjD,this.faTrash=y.yLS,this.extendedSearchParams=new l.mZ,this.selectedCompopSets=[[]],this.defaultFormString="---",this.extendedSearchFormStrings={label:"Search Input",placeholder:"Volltextsuche in der Webern-Datenbank \u2026",errorMessage:"Es wird ein Suchbegriff mit mindestens 3 Zeichen ben\xf6tigt!"},this._destroyed$=new L.B}get restypeControl(){return this.extendedSearchForm.get("restypeControl")}get propertiesControls(){return this.extendedSearchForm.get("propertiesControls")}ngOnInit(){this.createExtendedSearchForm(),this.getResourcetypes()}createExtendedSearchForm(){this.extendedSearchForm=this.formBuilder.group({restypeControl:["",S.k0.required],propertiesControls:this.formBuilder.array([])}),this.addPropertiesControl()}addPropertiesControl(){const e=this.formBuilder.group({propertyIdControl:[{value:"",disabled:!0},[S.k0.required]],compopControl:[{value:"",disabled:!0},[S.k0.required]],searchvalControl:[{value:"",disabled:!0},[this._validateSearchval()]]});this._isResourecetypeMissing()||e.controls.propertyIdControl.enable(),this.propertiesControls.push(e)}removePropertiesControl(e){e>-1&&this.propertiesControls.removeAt(e)}getCompopControlAtIndex(e){return this.listenToUserCompopChange(e),this._getFormArrayControlAtIndex("compopControl",e)}getCompopSetByValueType(e,t){if(!Ke.typeList.find(N=>N.id===e))return[];const c="6"===e?`${e}-${t}`:e,p=he.has(c)?he.get(c):0;return Ne.compopList[p].compopSet}getPropertyIdControlAtIndex(e){return this.listenToUserPropertyChange(e),this._getFormArrayControlAtIndex("propertyIdControl",e)}getPropertyListEntryById(e){return this.propertyListsResponse.properties.find(t=>t.id===e)}getPropertyLists(e){this.dataApiService.getPropertyListsByResourceType(e).pipe((0,f.Q)(this._destroyed$)).subscribe({next:t=>{this.propertyListsResponse=t},error:t=>{console.error(t)}})}getResourcetypes(){this.dataApiService.getResourceTypes().pipe((0,f.Q)(this._destroyed$)).subscribe({next:e=>{this.restypesResponse=e,this.listenToUserResourcetypeChange()},error:e=>{console.error(e)}})}getSearchvalControlAtIndex(e){return this._getFormArrayControlAtIndex("searchvalControl",e)}isAddButtonDisabled(e){return this._isPropertyIdOrCompopMissing(e)||this._isNotLastProperty(e)||!this._isCompopExists(e)&&this._isSearchvalMissingOrTooShort(e)}listenToUserResourcetypeChange(){this.restypeControl.valueChanges.pipe((0,f.Q)(this._destroyed$)).subscribe({next:e=>{this.selectedResourcetype=this.restypesResponse.resourcetypes.find(t=>t.id===e),this._clearPropertiesControls(),this.selectedResourcetype&&this.getPropertyLists(this.selectedResourcetype.id)}})}listenToUserPropertyChange(e){this._getFormArrayControlAtIndex("propertyIdControl",e)?.valueChanges.pipe((0,f.Q)(this._destroyed$)).subscribe({next:t=>{const s=this.getPropertyListEntryById(t);if(!s)return;const c=s.guielement_id,p=s.valuetype_id;this._getFormArrayControlAtIndex("compopControl",e).enable(),this._getFormArrayControlAtIndex("compopControl",e).setValue(""),this._getFormArrayControlAtIndex("searchvalControl",e).disable(),this._getFormArrayControlAtIndex("searchvalControl",e).setValue(""),this.selectedCompopSets[e]=this.getCompopSetByValueType(p,c)}})}listenToUserCompopChange(e){this._getFormArrayControlAtIndex("compopControl",e)?.valueChanges.pipe((0,f.Q)(this._destroyed$)).subscribe({next:t=>{t&&"EXISTS"!==t?this.getSearchvalControlAtIndex(e).enable():t&&"EXISTS"===t&&(this.getSearchvalControlAtIndex(e).disable(),this.getSearchvalControlAtIndex(e).setValue(""))}})}onReset(){alert("Gesamte Suchmaske zur\xfccksetzen?"),this._resetForm()}onSearch(){this.extendedSearchForm.valid&&(this.extendedSearchParams={filterByRestype:this.extendedSearchForm.value.restypeControl,propertyId:[],compop:[],searchval:[]},this.extendedSearchForm.value.propertiesControls?.forEach(e=>{this.extendedSearchParams.propertyId.push(e.propertyIdControl),this.extendedSearchParams.compop.push(e.compopControl),this.extendedSearchParams.searchval.push(e.searchvalControl)}),this.searchRequest.emit(this.extendedSearchParams))}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}_clearPropertiesControls(){this.propertiesControls.clear(),this.addPropertiesControl()}_getFormArrayControlAtIndex(e,t){const s=this.propertiesControls.controls.at(t);return s?s.get(e):null}_isCompopExists(e){return"EXISTS"===this._getFormArrayControlAtIndex("compopControl",e).value}_isCompopMissing(e){return this._isFormControlValueMissing("compopControl",e)}_isFormControlValueMissing(e,t){const s=this._getFormArrayControlAtIndex(e,t)?.value;return!s||s===this.defaultFormString}_isNotLastProperty(e){return this.propertiesControls.controls.length-1>e}_isPropertyIdMissing(e){return this._isFormControlValueMissing("propertyIdControl",e)}_isPropertyIdOrCompopMissing(e){return this._isPropertyIdMissing(e)||this._isCompopMissing(e)}_isResourecetypeMissing(){const e=this.restypeControl.value;return!e||e===this.defaultFormString}_isSearchvalMissing(e){return this._isFormControlValueMissing("searchvalControl",e)}_isSearchvalMissingOrTooShort(e){return this._isSearchvalMissing(e)||this._isSearchvalTooShort(e)}_isSearchvalTooShort(e){return this.getSearchvalControlAtIndex(e).value.length<3}_resetForm(){return this.extendedSearchForm.reset()}_validateSearchval(){return e=>{const t=e.value;return"EXISTS"===e.parent.get("compopControl").value?null:!t||t.length<3?{minlength:!0}:null}}static#e=this.ctorParameters=()=>[{type:M},{type:S.ok}];static#t=this.propDecorators={searchRequest:[{type:n.k7i}]}};K=(0,a.Cg)([(0,n.uAl)({selector:"awg-extended-search-form",template:'@if (extendedSearchForm) {\n    <form [formGroup]="extendedSearchForm" (ngSubmit)="onSearch()" class="p-3 border">\n        <div class="form-floating awg-form-floating-group flex-grow-1 mt-3 mb-3">\n            <select\n                class="form-select"\n                id="awg-extended-search-resourcetype-input"\n                aria-label="Extended search restype control"\n                formControlName="restypeControl"\n                required>\n                <option value="" disabled hidden>{{ defaultFormString }}</option>\n                @for (resourcetype of restypesResponse?.resourcetypes; track resourcetype) {\n                    <option [value]="resourcetype.id" [title]="resourcetype.label">\n                        {{ resourcetype.id }} | {{ resourcetype.label }}\n                    </option>\n                }\n            </select>\n            <label for="awg-extended-search-resourcetype-input" class="text-muted">Resource type</label>\n        </div>\n        <ng-container formArrayName="propertiesControls">\n            @for (propCtrl of propertiesControls.controls; track propCtrl; let idx = $index) {\n                <div class="row mb-4 ms-4 g-2">\n                    <ng-container [formGroupName]="idx">\n                        <div class="form-floating col-md-4">\n                            <select\n                                id="awg-extended-search-property-{{ idx }}"\n                                class="form-select"\n                                [formControl]="getPropertyIdControlAtIndex(idx)"\n                                required>\n                                <option value="" disabled hidden>{{ defaultFormString }}</option>\n                                @if (selectedResourcetype) {\n                                    @for (property of selectedResourcetype?.properties; track property) {\n                                        <option [value]="property.id" [title]="property.label">\n                                            {{ property.id }} | {{ property.label }}\n                                        </option>\n                                    }\n                                }\n                            </select>\n                            <label class="text-muted" for="awg-extended-search-property-{{ idx }}">Property</label>\n                        </div>\n                        <div class="form-floating col-md-2">\n                            <select\n                                id="awg-extended-search-compop-{{ idx }}"\n                                class="form-select"\n                                [formControl]="getCompopControlAtIndex(idx)"\n                                required>\n                                <option value="" disabled hidden>{{ defaultFormString }}</option>\n                                @if (selectedCompopSets) {\n                                    @for (compop of selectedCompopSets[idx]; track compop) {\n                                        <option\n                                            [value]="compop.value"\n                                            [title]="compop.title"\n                                            [innerHtml]="compop.label"></option>\n                                    }\n                                }\n                            </select>\n                            <label class="text-muted" for="awg-extended-search-compop-{{ idx }}">Operator</label>\n                        </div>\n                        <div class="form-floating col-md-4">\n                            <input\n                                title="Extended Search - Search Value"\n                                type="search"\n                                id="awg-extended-search-value-{{ idx }}"\n                                class="form-control"\n                                [formControl]="getSearchvalControlAtIndex(idx)"\n                                placeholder="{{ defaultFormString }}" />\n                            <label class="text-muted" for="awg-extended-search-value-{{ idx }}">Search value</label>\n                        </div>\n                        <div class="btn-toolbar col-2" role="toolbar" aria-label="Toolbar for property inputs">\n                            <div class="btn-group" role="group" aria-label="Group of handle buttons">\n                                @if (propertiesControls.controls.length > 1) {\n                                    <button\n                                        id="awg-extended-search-remove-property-{{ idx }}"\n                                        class="btn btn-outline-danger"\n                                        type="button"\n                                        (click)="removePropertiesControl(idx)">\n                                        <fa-icon [icon]="faTrash"></fa-icon>\n                                    </button>\n                                }\n                                <button\n                                    id="awg-extended-search-add-property-{{ idx }}"\n                                    class="btn btn-outline-info"\n                                    type="button"\n                                    (click)="addPropertiesControl()"\n                                    [disabled]="isAddButtonDisabled(idx)">\n                                    <fa-icon [icon]="faPlus"></fa-icon>\n                                </button>\n                            </div>\n                        </div>\n                    </ng-container>\n                    @if (getSearchvalControlAtIndex(idx).invalid && !getSearchvalControlAtIndex(idx).pristine) {\n                        <div class="alert alert-danger">\n                            @if (getSearchvalControlAtIndex(idx).errors) {\n                                <p></p>\n                            }\n                            {{ extendedSearchFormStrings.errorMessage }}\n                        </div>\n                    }\n                </div>\n            }\n        </ng-container>\n        <div class="awg-extended-search-button-panel mb-4">\n            <button\n                id="awg-extended-search-submit"\n                class="btn btn-outline-info"\n                type="submit"\n                [disabled]="!extendedSearchForm.valid">\n                <fa-icon [icon]="faSearch"></fa-icon>\n                Submit\n            </button>\n            <button\n                id="awg-extended-search-reset"\n                class="btn btn-outline-danger"\n                (click)="onReset()"\n                [disabled]="!restypeControl.valid">\n                <fa-icon [icon]="faRefresh"></fa-icon>\n                Reset\n            </button>\n        </div>\n    </form>\n}\n',styles:[Ee()]})],K);var tt=r(6452),rt=r.n(tt),Z=r(5964),nt=r(152),st=r(3294);let ee=class{constructor(e){this.formBuilder=e,this.searchRequest=new n.bkB,this.faSearch=y.MjD,this.fulltextSearchFormStrings={label:"Input f\xfcr Volltextsuche",placeholder:"Volltextsuche in der Webern-Datenbank \u2026",errorMessage:"Es wird ein Suchbegriff mit mindestens 3 Zeichen ben\xf6tigt!"},this._destroyed$=new L.B}get searchvalControl(){return this.fulltextSearchForm.get("searchvalControl")}ngOnInit(){this.createFulltextSearchForm(),this.listenToUserInputChange()}ngOnChanges(e){e.searchValue&&"string"==typeof e.searchValue.currentValue&&!e.searchValue.isFirstChange()&&this.setSearchvalFromInput()}createFulltextSearchForm(){this.fulltextSearchForm=this.formBuilder.group({searchvalControl:["",S.k0.compose([S.k0.required,S.k0.minLength(3)])]})}isFulltextSearchInputInvalid(){return!(!this.searchvalControl.hasError("required")&&!this.searchvalControl.hasError("minlength"))}listenToUserInputChange(){this.searchvalControl.valueChanges.pipe((0,Z.p)(e=>e.length>=3),(0,nt.B)(500),(0,st.F)(),(0,f.Q)(this._destroyed$)).subscribe({next:e=>this.onSearch(e)})}setSearchvalFromInput(){this.searchvalControl.setValue(this.searchValue)}onSearch(e){e&&this.fulltextSearchForm.valid&&this.searchRequest.emit(e)}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}static#e=this.ctorParameters=()=>[{type:S.ok}];static#t=this.propDecorators={searchValue:[{type:n.pde}],searchRequest:[{type:n.k7i}]}};ee=(0,a.Cg)([(0,n.uAl)({selector:"awg-fulltext-search-form",template:'<form [formGroup]="fulltextSearchForm" class="p-3 border">\n    <div class="input-group mt-3 mb-3">\n        <div class="input-group-text" id="search-icon" style="max-height: 3.63rem">\n            <fa-icon [icon]="faSearch"></fa-icon>\n        </div>\n        <div class="form-floating awg-form-floating-group flex-grow-1">\n            <input\n                title="{{ fulltextSearchFormStrings.label }}"\n                type="search"\n                id="awg-fulltext-search-searchValue"\n                class="form-control"\n                [ngClass]="{\n                    \'is-invalid\': isFulltextSearchInputInvalid()\n                }"\n                formControlName="searchvalControl"\n                [attr.aria-label]="fulltextSearchFormStrings.label"\n                aria-describedby="search-icon"\n                placeholder="{{ fulltextSearchFormStrings.placeholder }}"\n                required />\n            <label for="awg-fulltext-search-searchValue" class="text-muted">{{\n                fulltextSearchFormStrings.placeholder\n            }}</label>\n            @if (searchvalControl.invalid && !searchvalControl.pristine) {\n                <div class="invalid-feedback">\n                    @if (isFulltextSearchInputInvalid()) {\n                        <p>\n                            {{ fulltextSearchFormStrings.errorMessage }}\n                        </p>\n                    }\n                </div>\n            }\n        </div>\n    </div>\n</form>\n',changeDetection:n.Ngq.OnPush,styles:[rt()]})],ee);var ot=r(6278),it=r.n(ot),_=r(4308),lt=r(9883);let te=class{constructor(e,t,s,c){this.router=e,this.conversionService=t,this.dataStreamerService=s,this.sideInfoService=c,this.pageChangeRequest=new n.bkB,this.rowNumberChangeRequest=new n.bkB,this.viewChangeRequest=new n.bkB,this.errorMessage=void 0,this.rowNumbers=[5,10,25,50,100,200],this.faGripHorizontal=y.UjL,this.faTable=y.w97,this.selectedViewType=v.f.TABLE,this.viewHandles=[new v.C("Table view",v.f.TABLE,y.w97),new v.C("Grid view",v.f.GRID,y.UjL)],this._destroyed$=new L.B}ngOnInit(){this.getSearchResponseWithQueryData(),this.searchParams.viewType&&(this.searchParams.viewType===v.f.TABLE||this.searchParams.viewType===v.f.GRID)&&this.setViewType(this.searchParams.viewType)}setViewType(e){this.selectedViewType=e}isActiveResource(e){return this._selectedResourceId===e}isGridView(){return this.searchParams.viewType===v.f.GRID}isNoResults(){return 0==+this.searchResponseWithQuery.data.nhits}navigateToResource(e){this._selectedResourceId=e,this.router.navigate(["/data/resource",this._selectedResourceId])}onPageChange(e){const t=+this.searchParams.nRows,s=e*t-t;this.pageChangeRequest.emit(String(s))}onRowNumberChange(e){this.rowNumberChangeRequest.emit(String(e))}onViewChange(e){e&&this.viewChangeRequest.emit(e)}setPagination(){const e=+this.searchParams.nRows,t=+this.searchParams.startAt;this.pageSize=e,this.page=Math.floor(t/e)+1}getSearchResponseWithQueryData(){this.dataStreamerService.getSearchResponseWithQuery().pipe((0,f.Q)(this._destroyed$)).subscribe({next:t=>{this.updateSearchParams(t),this.setPagination()},error:t=>{this.errorMessage=t,console.error("SearchResultList# searchResultData subscription error: ",this.errorMessage)}})}updateSearchParams(e){if(!e)return;this.searchResponseWithQuery={...e},this.searchResultText=this.conversionService.prepareFullTextSearchResultText(e,this.searchUrl);const t=new lt.f(this.searchResponseWithQuery.query,this.searchResultText);this.sideInfoService.updateSearchInfoData(t)}ngOnDestroy(){this.sideInfoService.clearSearchInfoData(),this._destroyed$.next(!0),this._destroyed$.complete()}static#e=this.ctorParameters=()=>[{type:_.Ix},{type:g.Cq},{type:g.JM},{type:g.B2}];static#t=this.propDecorators={searchUrl:[{type:n.pde}],searchParams:[{type:n.pde}],pageChangeRequest:[{type:n.k7i}],rowNumberChangeRequest:[{type:n.k7i}],viewChangeRequest:[{type:n.k7i}]}};te=(0,a.Cg)([(0,n.uAl)({selector:"awg-search-result-list",template:'\x3c!-- content: search results --\x3e\n\n\x3c!-- TODO Use shared generic table component to display search results\n<awg-table\n  tableTitle="{{ searchResponseWithQuery?.query | json }}"\n  [headerInputData]="test.head.vars"\n[rowInputData]="test.body.bindings"></awg-table>\n--\x3e\n\n@if (searchResponseWithQuery?.data) {\n    <div class="awg-search-results p-3 border rounded-bottom">\n        \x3c!-- header --\x3e\n        <div class="row d-flex justify-content-between mb-4 awg-search-results-header">\n            <div class="col-6 me-auto awg-search-results-header-icons">\n                <div class="btn-group" role="group">\n                    \x3c!-- View Handle --\x3e\n                    <awg-view-handle-button-group\n                        [viewHandles]="viewHandles"\n                        [selectedViewType]="selectedViewType"\n                        (viewChangeRequest)="onViewChange($event)"></awg-view-handle-button-group>\n                    <div class="btn-group" role="group">\n                        <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">\n                            <span class="d-none d-lg-inline">Hits per page: </span>{{ searchParams?.nRows }}\n                        </button>\n                        <div\n                            ngbDropdown\n                            class="btn-group"\n                            role="group"\n                            aria-label="Button group with nested dropdown for row number">\n                            <button\n                                class="btn btn-sm btn-info dropdown-toggle-split"\n                                ngbDropdownToggle\n                                [disabled]="isNoResults()"></button>\n                            <div class="dropdown-menu" ngbDropdownMenu>\n                                @for (rowNumber of rowNumbers; track rowNumber) {\n                                    <button class="dropdown-item" (click)="onRowNumberChange(rowNumber)">\n                                        {{ rowNumber }}\n                                    </button>\n                                }\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="col-6 my-auto text-center awg-search-results-header-text">\n                {{ searchResultText }}\n            </div>\n        </div>\n        @if (searchResponseWithQuery?.data?.subjects && !isNoResults()) {\n            \x3c!-- top pagination --\x3e\n            <ngb-pagination\n                class="d-flex justify-content-center"\n                [(page)]="page"\n                [pageSize]="pageSize"\n                [collectionSize]="+searchResponseWithQuery?.data?.nhits"\n                [maxSize]="4"\n                [boundaryLinks]="true"\n                (pageChange)="onPageChange($event)">\n            </ngb-pagination>\n            \x3c!-- table with searchResults --\x3e\n            @if (!isGridView()) {\n                <div class="table-responsive">\n                    <table\n                        aria-label="Table with search results"\n                        class="table table-hover table-sm awg-search-result-table">\n                        <thead>\n                            <tr class="d-flex">\n                                <th scope="col" class="col-6 col-sm-3 col-md-4 col-lg-3 col-xl-2">Typ</th>\n                                <th scope="col" class="col-6 col-sm-9 col-md-8 col-lg-9 col-xl-10">Ressource</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            \x3c!-- show searchResultDetail by clicking on single entry --\x3e\n                            @for (subject of searchResponseWithQuery?.data?.subjects; track subject.obj_id) {\n                                <tr\n                                    class="d-flex"\n                                    (click)="navigateToResource(subject?.obj_id)"\n                                    [class.active]="isActiveResource(subject?.obj_id)">\n                                    <td class="col-6 col-sm-3 col-md-4 col-lg-3 col-xl-2">\n                                        <span class="badge text-bg-light">\n                                            <img [attr.src]="subject?.iconsrc" alt="iconsrc" />\n                                            <small>&nbsp;{{ subject?.iconlabel }}</small>\n                                        </span>\n                                    </td>\n                                    <td class="col-6 col-sm-9 col-md-8 col-lg-9 col-xl-10">\n                                        <span\n                                            ><em>{{ subject?.valuelabel[0] }}:&nbsp;</em></span\n                                        ><span [compile-html]="subject?.value[0]" [compile-html-ref]="this"></span>\n                                    </td>\n                                </tr>\n                            }\n                        </tbody>\n                    </table>\n                </div>\n            }\n            \x3c!-- grid with searchResults --\x3e\n            @if (isGridView()) {\n                <div class="row row-cols-1 row-cols-sm-3 row-cols-xl-5 g-4 mb-4">\n                    @for (subject of searchResponseWithQuery?.data?.subjects; track subject.obj_id) {\n                        <div class="col">\n                            <div class="card h-100">\n                                <div class="card-header">\n                                    <img [attr.src]="subject?.iconsrc" alt="iconsrc" />\n                                    &nbsp;{{ subject?.iconlabel }}\n                                </div>\n                                <div class="card-body">\n                                    <h5 class="card-title">\n                                        <span [compile-html]="subject?.value[0]" [compile-html-ref]="this"></span>\n                                    </h5>\n                                </div>\n                                <div class="card-footer text-end">\n                                    <a (click)="navigateToResource(subject?.obj_id)" class="btn btn-outline-info"\n                                        >Mehr ...\n                                    </a>\n                                </div>\n                            </div>\n                        </div>\n                    }\n                </div>\n            }\n            \x3c!-- bottom pagination --\x3e\n            <ngb-pagination\n                class="d-flex justify-content-center"\n                [(page)]="page"\n                [pageSize]="pageSize"\n                [collectionSize]="+searchResponseWithQuery?.data?.nhits"\n                [maxSize]="4"\n                [boundaryLinks]="true"\n                (pageChange)="onPageChange($event)">\n            </ngb-pagination>\n        }\n    </div>\n}\n',changeDetection:n.Ngq.Default,styles:[it()]})],te);var ht=r(50),dt=r.n(ht),pe=r(5558);let P=class{constructor(e,t,s,c,p,N){this.route=e,this.router=t,this.dataApiService=s,this.dataStreamerService=c,this.gndService=p,this.loadingService=N,this.errorMessage=void 0,this.resourceDetailTabTitles={html:"Detail",raw:"JSON (raw)",converted:"JSON (converted)"},this._destroyed$=new L.B}get httpGetUrl(){return this.dataApiService.httpGetUrl}get isLoading$(){return this.loadingService.getLoadingStatus()}ngOnInit(){this.routeToSidenav(),this.getResourceData()}getResourceData(){this.router.events.pipe((0,Z.p)(e=>e instanceof _.wF),(0,A.T)(()=>this.route),(0,pe.n)(e=>{const s=this.route.snapshot.paramMap.get("id");for(;e.firstChild;)e=e.firstChild;return this.selectedResourceDetailTabId=e.snapshot.url[0].path,this.updateResourceId(s),this.dataApiService.getResourceData(s)}),(0,f.Q)(this._destroyed$)).subscribe({next:e=>{this.resourceData=e},error:e=>this.errorMessage=e})}onResourceDetailTabChange(e){const t=e.nextId;this.router.navigate([t],{relativeTo:this.route})}updateResourceId(e){this.resourceId=e,this.dataStreamerService.updateResourceId(e)}navigateToResource(e){const t=e??this.oldId??this.resourceId;this.oldId=this.resourceId,this.router.navigate(["/data/resource",+t])}exposeGnd(e){e&&this.gndService.exposeGnd(e)}routeToSidenav(){this.router.navigate([{outlets:{side:"resourceInfo"}}],{preserveFragment:!0,queryParamsHandling:"preserve"})}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}static#e=this.ctorParameters=()=>[{type:_.nX},{type:_.Ix},{type:M},{type:g.JM},{type:g.DK},{type:g.Ui}]};P=(0,a.Cg)([(0,n.uAl)({selector:"awg-resource-detail",template:'\x3c!-- resource detail box --\x3e\n\n\x3c!-- loading spinner --\x3e\n@if (isLoading$ | async) {\n    <div>\n        <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n    </div>\n} @else {\n    \x3c!-- error message --\x3e\n    @if (errorMessage) {\n        <div class="errorMessage">\n            <p>Die Anfrage "{{ errorMessage?.route }}" ist fehlgeschlagen.</p>\n            <p>Fehlermeldung: "{{ errorMessage?.statusText || errorMessage }}".</p>\n            <p>M\xf6glicherweise gab es ein Problem mit der Internetverbindung oder dem verwendeten Suchbegriff.</p>\n        </div>\n    }\n    \x3c!-- async data --\x3e\n    @if (resourceData) {\n        <div class="awg-resource-detail-tabs">\n            \x3c!-- resourceDetailData header --\x3e\n            @if (resourceData.detail.header) {\n                <awg-resource-detail-header\n                    [header]="resourceData.detail.header"\n                    [resourceUrl]="httpGetUrl"\n                    (resourceRequest)="navigateToResource($event)"></awg-resource-detail-header>\n            }\n            \x3c!-- resourceDetailData body --\x3e\n            <nav\n                ngbNav\n                #resourceDetailNav="ngbNav"\n                class="nav-tabs"\n                [activeId]="selectedResourceDetailTabId"\n                (navChange)="onResourceDetailTabChange($event)">\n                <ng-container ngbNavItem="html">\n                    <a ngbNavLink class="awg-resource-detail-long-tab">{{ resourceDetailTabTitles?.html }}</a>\n                    <ng-template ngbNavContent>\n                        \x3c!-- html visualisation --\x3e\n                        <awg-resource-detail-html\n                            [resourceDetailData]="resourceData.detail"\n                            (gndRequest)="exposeGnd($event)"\n                            (resourceRequest)="navigateToResource($event)">\n                        </awg-resource-detail-html>\n                    </ng-template>\n                </ng-container>\n                <ng-container ngbNavItem="converted-json">\n                    <a ngbNavLink class="ms-auto">{{ resourceDetailTabTitles?.converted }}</a>\n                    <ng-template ngbNavContent>\n                        \x3c!-- converted json visualisation --\x3e\n                        <awg-resource-detail-json-converted [resourceJsonConvertedData]="resourceData.jsonConverted">\n                        </awg-resource-detail-json-converted>\n                    </ng-template>\n                </ng-container>\n                <ng-container ngbNavItem="raw-json">\n                    <a ngbNavLink>{{ resourceDetailTabTitles?.raw }}</a>\n                    <ng-template ngbNavContent>\n                        \x3c!-- raw json visualisation --\x3e\n                        <awg-resource-detail-json-raw [resourceJsonRawData]="resourceData.jsonRaw">\n                        </awg-resource-detail-json-raw>\n                    </ng-template>\n                </ng-container>\n            </nav>\n            <div [ngbNavOutlet]="resourceDetailNav"></div>\n        </div>\n    }\n    \x3c!--\n  TODO: remove\n  <ul class="nav nav-tabs nav-justified" role="tablist">\n    <li class="active awg-resource-detail-long-tab"><a data-toggle="tab" href="#html">{{ tabTitles?.html }}</a></li>\n    <li class="dropdown awg-resource-detail-short-tab">\n      <a href="#" data-toggle="dropdown" class="dropdown-toggle">\n        {{ \'{\' }} JSON {{ \'}\' }} <b class="caret"></b>\n      </a>\n      <ul class="dropdown-menu dropdown-menu-right">\n        <li><a data-toggle="tab" href="#converted">{{ tabTitles?.converted }}</a></li>\n        <li><a data-toggle="tab" href="#raw">{{ tabTitles?.raw }}</a></li>\n      </ul>\n    </li>\n  </ul>\n  --\x3e\n}\n',changeDetection:n.Ngq.Default,styles:[dt()]})],P);var pt=r(547),gt=r.n(pt),H=r(5352);let W=class{constructor(e,t){this.sideInfoService=e,this.route=t}ngOnInit(){this.setButtons(),this.updateSearchInfoTitleFromPath()}setButtons(){this.searchRouterLinkButtons=[new H.i("/data","search","Suche",!1),new H.i("/data","timeline","Timeline",!0),new H.i("/data","bibliography","Bibliographie",!0)]}updateSearchInfoTitleFromPath(){const e=this.route.snapshot.url[0].path,t=this.searchRouterLinkButtons.filter(s=>s.link===e);1===t.length&&this.sideInfoService.updateSearchInfoTitle(t[0].label)}onButtonSelect(e){const t=e instanceof H.i;!e||!t||!e.label||(this.sideInfoService.clearSearchInfoData(),this.sideInfoService.updateSearchInfoTitle(e.label))}static#e=this.ctorParameters=()=>[{type:g.B2},{type:_.nX}]};W=(0,a.Cg)([(0,n.uAl)({selector:"awg-search-overview",template:'@if (searchRouterLinkButtons) {\n    <awg-router-link-button-group\n        [routerLinkButtons]="searchRouterLinkButtons"\n        [queryParamsHandling]="\'preserve\'"\n        (selectButtonRequest)="onButtonSelect($event)">\n    </awg-router-link-button-group>\n}\n\n<router-outlet></router-outlet>\n',styles:[gt()]})],W);var vt=r(6662),_t=r.n(vt),ft=r(983);let O=class{constructor(e,t,s,c,p,N){this.route=e,this.router=t,this.conversionService=s,this.dataApiService=c,this.dataStreamerService=p,this.loadingService=N,this.errorMessage=void 0,this.searchTabs={fulltext:{id:"fulltext",title:"Volltext-Suche"},extended:{id:"extended",title:"Erweiterte Suche"}},this.viewChanged=!1,this._destroyed$=new L.B}get httpGetUrl(){return this.dataApiService.httpGetUrl}get isLoading$(){return this.loadingService.getLoadingStatus()}ngOnInit(){this.resetSearchParams(),this.getSearchData()}getSearchData(){this.router.events.pipe((0,Z.p)(e=>e instanceof _.wF),(0,A.T)(()=>this.route),(0,A.T)(e=>{let t=e;for(;t.firstChild;)t=t.firstChild;return this._isValidTabIdInRoute(t)&&(this.selectedSearchTabId=t.snapshot.url[0].path),e}),(0,pe.n)(e=>{const t=e.snapshot.queryParamMap;if(t!==this.currentQueryParams)if(this.currentQueryParams=t,t.keys.length<4)this.updateSearchParamsFromRoute(t,!0);else if(this.updateSearchParamsFromRoute(t,!1),!this.viewChanged){if(this.searchParams.query&&"string"==typeof this.searchParams.query)return this.dataApiService.getSearchData(this.searchParams);if("object"==typeof this.searchParams.query&&this.searchParams.query.filterByRestype)return this.dataApiService.getSearchData(this.searchParams)}return ft.w}),(0,f.Q)(this._destroyed$)).subscribe({next:e=>{this.searchResponseWithQuery=new l.wW(e,this.searchParams.query),this.dataStreamerService.updateSearchResponseWithQuery(this.searchResponseWithQuery)},error:e=>{this.errorMessage=e,console.error("SearchPanel# getSearchData subscription error: ",this.errorMessage)}})}onPageChange(e){e!==this.searchParams.startAt&&(this.viewChanged=!1,this.searchParams=new l.lt(this.searchParams.query,this.searchParams.nRows,e,this.searchParams.viewType),this._routeToSelf(this.searchParams))}onRowNumberChange(e){e!==this.searchParams.nRows&&(this.viewChanged=!1,this.searchParams=new l.lt(this.searchParams.query,e,"0",this.searchParams.viewType),this._routeToSelf(this.searchParams))}onSearch(e){e!==this.searchParams.query&&(this.viewChanged=!1,this.searchParams=new l.lt(e,this.searchParams.nRows,this.searchParams.startAt,this.searchParams.viewType),this._routeToSelf(this.searchParams))}onSearchTabChange(e){const t=e.nextId;this.resetSearchParams(t),this.resetSearchResponse(),this.errorMessage=void 0,this._routeToSelf(this.searchParams,t)}onViewChange(e){e!==this.searchParams.viewType&&(this.viewChanged=!0,this.searchParams=new l.lt(this.searchParams.query,this.searchParams.nRows,this.searchParams.startAt,e),this._routeToSelf(this.searchParams))}resetSearchParams(e){let t;e&&e!==this.searchTabs.fulltext.id?e===this.searchTabs.extended.id&&(t=new l.mZ,t.filterByRestype="",t.propertyId=[],t.compop=[],t.searchval=[]):t="",this.searchParams=new l.lt(t,"25","0",v.f.TABLE)}resetSearchResponse(){this.searchResponseWithQuery=new l.wW(new h.UP,""),this.dataStreamerService.updateSearchResponseWithQuery(this.searchResponseWithQuery)}updateSearchParamsFromRoute(e,t){if(!e)return;let s;this.selectedSearchTabId&&this.selectedSearchTabId!==this.searchTabs.fulltext.id&&"string"!=typeof this.searchParams.query?(this.selectedSearchTabId===this.searchTabs.extended.id||"object"==typeof this.searchParams.query)&&(s=new l.mZ,s.filterByRestype=e.get("filterByRestype")||this.searchParams.query.filterByRestype,s.propertyId=e.getAll("propertyId")||this.searchParams.query.propertyId,s.compop=e.getAll("compop")||this.searchParams.query.compop,s.searchval=e.getAll("searchval")||this.searchParams.query.searchval):s=e.get("query")||this.searchParams.query,this.searchParams=new l.lt(s,e.get("nrows")||this.searchParams.nRows,e.get("startAt")||this.searchParams.startAt,v.f[e.get("view")]||this.searchParams.viewType),t&&this._routeToSelf(this.searchParams)}getSearchQueryType(e){return"string"==typeof e||"object"==typeof e?e:void 0}isSearchResultListShown(){return this.dataStreamerService.getSearchResponseWithQuery().pipe((0,f.Q)(this._destroyed$)).subscribe({next:e=>console.log(e)}),!0}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}_routeToSelf(e,t){const s=t?[t]:[],c=this._createRouterQueryParams(e);this.router.navigate(s,{relativeTo:this.route,queryParams:c})}_createRouterQueryParams(e){const t={},s=this.getSearchQueryType(e.query);return"string"==typeof s?t.query=e.query:"object"==typeof s&&(t.filterByRestype=s.filterByRestype||"",s.propertyId&&(t.propertyId=s.propertyId||[],t.compop=s.compop||[],t.searchval=s.searchval||[])),t.nrows=e.nRows,t.startAt=e.startAt,t.view=e.viewType,t}_isValidTabIdInRoute(e){return e.snapshot.url&&e.snapshot.url.length>0&&Object.values(this.searchTabs).filter(t=>t.id===e.snapshot.url[0].path).length>0}static#e=this.ctorParameters=()=>[{type:_.nX},{type:_.Ix},{type:g.Cq},{type:M},{type:g.JM},{type:g.Ui}]};O=(0,a.Cg)([(0,n.uAl)({selector:"awg-search-panel",template:'\x3c!-- content: search panel --\x3e\n<div class="awg-search-tabs">\n    <nav\n        ngbNav\n        #searchNav="ngbNav"\n        class="nav-tabs nav-fill"\n        [activeId]="selectedSearchTabId"\n        (navChange)="onSearchTabChange($event)">\n        <ng-container [ngbNavItem]="searchTabs?.fulltext.id">\n            <a ngbNavLink id="fulltext" class="awg-fulltext-search-tab">{{ searchTabs?.fulltext.title }}</a>\n            <ng-template ngbNavContent>\n                \x3c!-- full text search --\x3e\n                <awg-fulltext-search-form\n                    [searchValue]="getSearchQueryType(searchParams?.query)"\n                    (searchRequest)="onSearch($event)">\n                </awg-fulltext-search-form>\n            </ng-template>\n        </ng-container>\n        <ng-container [ngbNavItem]="searchTabs.extended.id">\n            <a ngbNavLink class="awg-extended-search-tab">{{ searchTabs?.extended.title }}</a>\n            <ng-template ngbNavContent>\n                \x3c!-- extended search --\x3e\n                <awg-extended-search-form (searchRequest)="onSearch($event)"></awg-extended-search-form>\n            </ng-template>\n        </ng-container>\n    </nav>\n    <div [ngbNavOutlet]="searchNav"></div>\n</div>\n\n\x3c!-- loading spinner --\x3e\n@if (isLoading$ | async) {\n    <div>\n        <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n    </div>\n} @else {\n    @if (errorMessage) {\n        <div class="errorMessage">\n            <p>Die Anfrage "{{ errorMessage?.route }}" ist fehlgeschlagen.</p>\n            <p>Fehlermeldung: "{{ errorMessage?.statusText || errorMessage }}".</p>\n            <p>M\xf6glicherweise gab es ein Problem mit der Internetverbindung oder der Suchanfrage.</p>\n        </div>\n    }\n    @if (searchResponseWithQuery?.query) {\n        <awg-search-result-list\n            [searchParams]="searchParams"\n            [searchUrl]="httpGetUrl"\n            (pageChangeRequest)="onPageChange($event)"\n            (rowNumberChangeRequest)="onRowNumberChange($event)"\n            (viewChangeRequest)="onViewChange($event)">\n        </awg-search-result-list>\n    }\n}\n\n\x3c!-- search results --\x3e\n',styles:[_t()]})],O);var bt=r(8929),Rt=r.n(bt);let Y=class{constructor(e){this.router=e,this.searchTitle="Suche",this.searchId="search"}ngOnInit(){this.routeToSidenav()}routeToSidenav(){this.router.navigate([{outlets:{side:"searchInfo"}}],{preserveFragment:!0,queryParamsHandling:"preserve"})}static#e=this.ctorParameters=()=>[{type:_.Ix}]};Y=(0,a.Cg)([(0,n.uAl)({selector:"awg-data",template:'\x3c!-- content: search --\x3e\n\n\x3c!-- heading --\x3e\n<awg-heading [title]="searchTitle" [id]="searchId"></awg-heading>\n\n\x3c!-- help-block --\x3e\n<div class="help-block text-danger para">BETA: Suche momentan noch mit eingeschr\xe4nkter Funktionalit\xe4t</div>\n\n\x3c!-- data (search) routes --\x3e\n<router-outlet></router-outlet>\n',styles:[Rt()]})],Y);const St=[{path:"",component:Y,children:[{path:"",pathMatch:"full",redirectTo:"search"},{path:"search",component:W,children:[{path:"",component:O,children:[{path:"",pathMatch:"full",redirectTo:"fulltext"},{path:"fulltext",data:{title:"AWG Online Edition \u2013 Fulltext Search"},component:O},{path:"extended",data:{title:"AWG Online Edition \u2013 Extended Search"},component:O},{path:"detail/:id",redirectTo:"resource/:id"}]}]}]},{path:"resource/:id",component:P,data:{title:"AWG Online Edition \u2013 Resource Detail"},children:[{path:"",pathMatch:"full",redirectTo:"html"},{path:"html",data:{title:"AWG Online Edition \u2013 Resource Detail HTML"},component:P},{path:"converted-json",data:{title:"AWG Online Edition \u2013 Resource Detail JSON Converted"},component:P},{path:"raw-json",data:{title:"AWG Online Edition \u2013 Resource Detail JSON Raw"},component:P}]}],wt=[Y,W,O,P];let re=class{};re=(0,a.Cg)([(0,n.UQu)({imports:[_.iI.forChild(St)],exports:[_.iI]})],re);let ne=class{};ne=(0,a.Cg)([(0,n.UQu)({imports:[o.G,z,re],declarations:[wt,K,ee,te]})],ne)},152:(i,d,r)=>{"use strict";r.d(d,{B:()=>X});var a=r(8839),n=r(9974),o=r(4360);function X(k,E=a.E){return(0,n.N)((x,w)=>{let m=null,I=null,C=null;const V=()=>{if(m){m.unsubscribe(),m=null;const R=I;I=null,w.next(R)}};function J(){const R=C+k,T=E.now();if(T<R)return m=this.schedule(void 0,R-T),void w.add(m);V()}x.subscribe((0,o._)(w,R=>{I=R,C=E.now(),m||(m=E.schedule(J,k),w.add(m))},()=>{V(),w.complete()},void 0,()=>{I=m=null}))})}},2264:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,'@charset "UTF-8";\n/************************************************\n *\n *               CREDITS\n *\n * This code is inspired, adapted or taken from:\n *\n * ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n * https://arachne.dainst.org/entity/1121229**]\n * 20.11.2017\n *\n *\n *\n************************************************/\n/* resource header */\n.resource-header {\n  margin: 1rem 0 0 0;\n  border-bottom: 1px solid #ddd;\n}\n\n/* resource header title */\n.resource-title .title {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.resource-title .title:hover {\n  white-space: normal;\n  width: inherit;\n  height: auto;\n}\n\n/* resource header link */\n.resource-link {\n  margin: 2rem 0;\n}\n\n/* resource header table */\n/* remove top border from table */\n.resource-header table.resource-header-table tr:first-of-type th,\n.resource-header table.resource-header-table tr:first-of-type td {\n  border-top: none;\n}',""]),i.exports=o.toString()},6307:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"/* slider container */\n.awg-image-slider {\n  height: 300px;\n}\n.awg-image-slider .ngx-gallery {\n  display: inline-block;\n}\n\n:host::ng-deep ngx-gallery {\n  /* image preview */\n  /* arrows */\n  /* thumbnails */\n}\n:host::ng-deep ngx-gallery .ngx-gallery-image-wrapper {\n  background-color: #e7e7e7;\n}\n:host::ng-deep ngx-gallery .ngx-gallery-arrow {\n  color: #676767;\n}\n:host::ng-deep ngx-gallery .ngx-gallery-arrow .ngx-gallery-disabled {\n  opacity: 0.3;\n}\n:host::ng-deep ngx-gallery .ngx-gallery-thumbnail {\n  opacity: 0.5;\n}\n:host::ng-deep ngx-gallery .ngx-gallery-thumbnail:hover {\n  opacity: 1;\n}",""]),i.exports=o.toString()},3631:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,'@charset "UTF-8";\n/************************************************\n *\n *               CREDITS\n *\n * This code is inspired, adapted or taken from:\n *\n * ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n * https://arachne.dainst.org/entity/1121229**]\n * 20.11.2017\n *\n *\n *\n ************************************************/\n/* link objects */\nul.awg-linked-obj-list {\n  padding-left: 0;\n}\nul.awg-linked-obj-list li:hover {\n  background-color: #e7e7e7;\n}\nul.awg-linked-obj-list li a {\n  width: inherit;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: block;\n}\nul.awg-linked-obj-list li hr {\n  margin-top: 0.75rem;\n  margin-bottom: 0.75rem;\n}\n\n.awg-linked-obj-link {\n  cursor: pointer;\n  color: #333 !important;\n}\n.awg-linked-obj-link:hover {\n  border-bottom: none !important;\n}',""]),i.exports=o.toString()},2623:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,'@charset "UTF-8";\n/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/\n/* props */\n.awg-props ul {\n  padding-left: 0;\n  margin-top: 0.5rem;\n  margin-bottom: 0.25rem;\n}\n\n.awg-props li {\n  list-style: none;\n  padding: 0.25rem 0;\n}\n\n.awg-props .awg-prop .awg-prop-label {\n  margin-top: 8px;\n  margin-bottom: -4px;\n  display: block;\n  font-size: 21px;\n  font-weight: 400;\n}\n\n.awg-props .awg-prop .awg-prop-value {\n  padding: 3px 0;\n  margin-left: 1rem;\n}',""]),i.exports=o.toString()},3432:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"",""]),i.exports=o.toString()},3135:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"",""]),i.exports=o.toString()},4463:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"",""]),i.exports=o.toString()},1639:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"",""]),i.exports=o.toString()},50:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"@charset \"UTF-8\";\n/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/\n/* for resource-header see 'resource-detail-html-header.component.scss' */\n/* for resource-html-props see 'props.component.scss' */\n/* tabs */\n/* adjust tab size on larger screens */\n@media screen and (min-width: 768px) {\n  /* set auto width for long tab */\n  .awg-resource-detail-long-tab {\n    width: auto !important;\n  }\n  /* avoid line wrap in link text */\n  .awg-resource-detail-short-tab > a {\n    white-space: nowrap;\n  }\n}\n::ng-deep .tab-content .tab-pane.active {\n  margin: 2rem 0;\n}",""]),i.exports=o.toString()},547:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"",""]),i.exports=o.toString()},2098:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"",""]),i.exports=o.toString()},6452:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,".awg-form-floating-group input {\n  border-bottom-left-radius: 0;\n  border-top-left-radius: 0;\n}",""]),i.exports=o.toString()},6662:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"",""]),i.exports=o.toString()},6278:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,".awg-search-results .awg-search-result-table tbody tr {\n  cursor: pointer;\n}\n\n.awg-search-results .awg-search-result-table tbody tr:hover {\n  background-color: #e7e7e7;\n}\n\n.awg-search-results .awg-search-result-table tbody tr.active td {\n  background-color: #d7d7d7;\n}",""]),i.exports=o.toString()},8929:(i,d,r)=>{var a=r(8564),o=r(8557)(a);o.push([i.id,"",""]),i.exports=o.toString()}}]);